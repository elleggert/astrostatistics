[32m[I 2021-08-19 16:28:38,778][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: qso
Training Set: 62405
Validation Set: 15602
Test Samples: 19505
Number of features: 6
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 44587 | Timestamp: 2021-08-19 16:28:38.779202

epoch 0 -0.28619318390536663 32.5389535979116
epoch 5 -0.20665236327261138 31.51676000365219
epoch 10 -0.0401008131568108 29.260934951364913
epoch 15 -0.048292958336432434 29.37594287527971
epoch 20 0.047738709504310806 27.998099075043626
epoch 25 0.10111932750698738 27.202041693732458
epoch 30 0.1516165493097711 26.426921510107558
epoch 35 0.13716432318646343 26.651062502356183
epoch 40 0.07155776523975443 27.645721256679092
epoch 45 0.08851139359453308 27.392148844976948
epoch 50 0.08426856748024403 27.455827749578777
epoch 55 0.05364766608177485 27.911097220392275
epoch 60 0.047488030393500136 28.00178402832827
epoch 65 0.047023041171336266 28.008618031214834
epoch 70 0.08497032251642056 27.44530558259251
epoch 75 0.07390935369968887 27.610688071753305
epoch 80 0.07838995592874609 27.543814213213693
[32m[I 2021-08-19 17:17:23,537][0m Trial 0 finished with value: 0.03458375422421811 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 252, 'fe_dropout_l0': 0.42033384151450615, 'fe_n_units_l1': 56, 'fe_dropout_l1': 0.03267030617210709, 'n_units_l(Invariant)': 224, 'n_layers_mlp': 2, 'mlp_n_units_l0': 193, 'mlp_dropout_l0': 0.11259034725726186, 'mlp_n_units_l1': 14, 'mlp_dropout_l1': 0.40174922941101937, 'reduction': 'sum', 'lr': 0.0035078889228857602, 'criterion': 'L1Loss', 'batch_size': 32, 'no_epochs': 84}. Best is trial 0 with value: 0.03458375422421811.[0m

Trial Id: 1 | Model params: 111891 | Timestamp: 2021-08-19 17:17:23.537603

[32m[I 2021-08-19 17:18:24,319][0m Trial 1 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 2 | Model params: 80398 | Timestamp: 2021-08-19 17:18:24.319450

epoch 0 -2.2341435233493403 51.59767410862132
epoch 5 -1.1655678780910566 42.22176470619641
epoch 10 -1.2033824447825574 42.58880194142733
epoch 15 -1.183362150289272 42.39487600362104
epoch 20 -1.546479351829404 45.78471975474735
epoch 25 -1.3353140416175213 43.845308083301
epoch 30 -1.5763921132601078 46.052844632414576
epoch 35 -2.109817317261532 50.596202204660145
epoch 40 -2.20719660801105 51.38226831766954
epoch 45 -2.51409012206777 53.784474326106114
epoch 50 -2.74903417903017 55.55334073330347
epoch 55 -2.62511615895697 54.62751491756284
[32m[I 2021-08-19 18:06:26,771][0m Trial 2 finished with value: -2.5885285090002004 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 163, 'fe_dropout_l0': 0.2651849706268482, 'fe_n_units_l1': 13, 'fe_dropout_l1': 0.3048861729583727, 'fe_n_units_l2': 199, 'fe_dropout_l2': 0.13284661413996307, 'fe_n_units_l3': 157, 'fe_dropout_l3': 0.10344561579523048, 'n_units_l(Invariant)': 115, 'n_layers_mlp': 2, 'mlp_n_units_l0': 160, 'mlp_dropout_l0': 0.21236473634506742, 'mlp_n_units_l1': 86, 'mlp_dropout_l1': 0.03574139002370885, 'reduction': 'sum', 'lr': 1.5025459246575172e-05, 'criterion': 'L1Loss', 'batch_size': 32, 'no_epochs': 57}. Best is trial 0 with value: 0.03458375422421811.[0m

Trial Id: 3 | Model params: 64170 | Timestamp: 2021-08-19 18:06:26.771948

[32m[I 2021-08-19 18:07:04,461][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 127078 | Timestamp: 2021-08-19 18:07:04.461613

[32m[I 2021-08-19 18:08:06,955][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 158021 | Timestamp: 2021-08-19 18:08:06.956054

epoch 0 -3.00984038405306 57.45317362253013
epoch 5 -0.4151096185545229 34.13072567347035
epoch 10 -0.0519789046422352 29.42754254210302
epoch 15 0.05234828626315502 27.930252177077595
epoch 20 0.14877490211743627 26.471142793026633
epoch 25 0.13762532858333776 26.643941838753776
epoch 30 0.17782992392084118 26.0154482790378
epoch 35 0.1737059743590954 26.080612531954042
epoch 40 0.09819825191034426 27.246204825166345
epoch 45 0.15875522864179392 26.315502640398204
epoch 50 0.18092238625039048 25.966475693919033
epoch 55 0.18098828676516088 25.96543108074243
epoch 60 0.17640130307580792 26.0380409770634
epoch 65 0.14710660023255417 26.497070271364816
[32m[I 2021-08-19 18:57:20,437][0m Trial 5 finished with value: 0.1771315083501449 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 244, 'fe_dropout_l0': 0.48085181089130813, 'fe_n_units_l1': 226, 'fe_dropout_l1': 0.3149881936768663, 'n_units_l(Invariant)': 57, 'n_layers_mlp': 4, 'mlp_n_units_l0': 115, 'mlp_dropout_l0': 0.06997740380565826, 'mlp_n_units_l1': 145, 'mlp_dropout_l1': 0.46114285710804415, 'mlp_n_units_l2': 179, 'mlp_dropout_l2': 0.3510167070788378, 'mlp_n_units_l3': 206, 'mlp_dropout_l3': 0.1287556495387751, 'reduction': 'sum', 'lr': 0.0021609074565929432, 'criterion': 'L1Loss', 'batch_size': 256, 'no_epochs': 71}. Best is trial 5 with value: 0.1771315083501449.[0m
epoch 70 0.1771315083501449 26.02649571171304

Trial Id: 6 | Model params: 97052 | Timestamp: 2021-08-19 18:57:20.437266

[32m[I 2021-08-19 18:58:12,841][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 227500 | Timestamp: 2021-08-19 18:58:12.841798

epoch 0 -1.9999345036373497 49.69427594661543
epoch 5 -0.5319351415319564 35.5116351511271
epoch 10 -0.4554102394735151 34.61331492363962
epoch 15 -0.603637303641632 36.333192165149114
epoch 20 -2.402601948691762 52.92441349794237
epoch 25 -2.342917826087013 52.45819356573349
epoch 30 -1.9112488578111289 48.95422124714125
epoch 35 -1.2111712447169825 42.66400972656163
epoch 40 -1.1751265721094168 42.314844346815036
epoch 45 -0.6694728561153072 37.071500247383845
epoch 50 -0.7318532311625028 37.75774271636227
epoch 55 -0.1234513251385072 30.41078362177175
epoch 60 -0.27397287796930536 32.384006041969414
epoch 65 -0.1071014954170173 30.188685248490337
epoch 70 -0.03422915076687305 29.178224941252882
epoch 75 -0.0032163369359827776 28.737420222510494
[32m[I 2021-08-19 20:28:37,323][0m Trial 7 finished with value: 0.07733150806270139 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 175, 'fe_dropout_l0': 0.3171265701784343, 'fe_n_units_l1': 244, 'fe_dropout_l1': 0.26000475005250284, 'fe_n_units_l2': 78, 'fe_dropout_l2': 0.06478559059428912, 'fe_n_units_l3': 228, 'fe_dropout_l3': 0.27833444035893107, 'n_units_l(Invariant)': 129, 'n_layers_mlp': 4, 'mlp_n_units_l0': 251, 'mlp_dropout_l0': 0.3065828728375052, 'mlp_n_units_l1': 161, 'mlp_dropout_l1': 0.3540964091502744, 'mlp_n_units_l2': 250, 'mlp_dropout_l2': 0.35630525514025113, 'mlp_n_units_l3': 74, 'mlp_dropout_l3': 0.057799735977748345, 'reduction': 'sum', 'lr': 5.034794833352469e-05, 'criterion': 'L1Loss', 'batch_size': 128, 'no_epochs': 80}. Best is trial 5 with value: 0.1771315083501449.[0m

Trial Id: 8 | Model params: 107855 | Timestamp: 2021-08-19 20:28:37.323380

[32m[I 2021-08-19 20:29:29,228][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 137204 | Timestamp: 2021-08-19 20:29:29.228243

[32m[I 2021-08-19 20:30:28,365][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 139727 | Timestamp: 2021-08-19 20:30:28.365660

epoch 0 -1.8198128141657381 48.179314953880734
epoch 5 -1.0493106661907503 41.07280666980183
epoch 10 -0.3697967419600572 33.57983402171555
epoch 15 0.027161931176434062 28.29897849942386
epoch 20 -0.18369788505658513 31.215544623098566
epoch 25 0.03412410037143998 28.197535078422163
epoch 30 -0.04126948665887076 29.277369357702828
epoch 35 -0.04713564216661159 29.359722866429106
epoch 40 2.4557021780280408e-05 28.69096450401118
epoch 45 0.061333491573554166 27.797525800086518
epoch 50 0.062441997142556493 27.781107394554645
[32m[I 2021-08-19 20:47:04,326][0m Trial 10 finished with value: 0.06633437094882066 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 75, 'fe_dropout_l0': 0.47069405231467215, 'fe_n_units_l1': 101, 'fe_dropout_l1': 0.48130629098699673, 'n_units_l(Invariant)': 28, 'n_layers_mlp': 4, 'mlp_n_units_l0': 101, 'mlp_dropout_l0': 0.013322364275625831, 'mlp_n_units_l1': 254, 'mlp_dropout_l1': 0.49697390235489164, 'mlp_n_units_l2': 225, 'mlp_dropout_l2': 0.15025383518457722, 'mlp_n_units_l3': 170, 'mlp_dropout_l3': 0.09462316084429306, 'reduction': 'sum', 'lr': 0.000335648372224615, 'criterion': 'L1Loss', 'batch_size': 256, 'no_epochs': 53}. Best is trial 5 with value: 0.1771315083501449.[0m

Trial Id: 11 | Model params: 173796 | Timestamp: 2021-08-19 20:47:04.326785

epoch 0 -1.730620024980448 47.41121839077406
[32m[I 2021-08-19 20:49:16,618][0m Trial 11 pruned. [0m

Trial Id: 12 | Model params: 162777 | Timestamp: 2021-08-19 20:49:16.618261

epoch 0 -1.7810002187320184 47.84659010408351
[32m[I 2021-08-19 20:50:39,408][0m Trial 12 pruned. [0m

Trial Id: 13 | Model params: 82608 | Timestamp: 2021-08-19 20:50:39.408918

[32m[I 2021-08-19 20:51:04,714][0m Trial 13 pruned. [0m
epoch 0 -2.2486991899644546 51.71365464529355

Trial Id: 14 | Model params: 170893 | Timestamp: 2021-08-19 20:51:04.714540

epoch 0 -1.1772309631844244 42.335308777379296
epoch 5 -0.027054116352305257 29.07683583605765
epoch 10 0.04056115921654102 28.10341707599095
epoch 15 0.13321027138421504 26.71205860596615
epoch 20 0.146740297585903 26.50275967232752
epoch 25 0.14702707246137048 26.49830559797299
epoch 30 0.14886284362095592 26.46977536845754
epoch 35 0.145446357892958 26.522847332291214
epoch 40 0.16495552118816081 26.218345678310424
epoch 45 0.1705160956514551 26.13090567868334
epoch 50 0.1720567225869961 26.10662751764015
epoch 55 0.16407165016660064 26.232217698094633
epoch 60 0.1680418415474828 26.1698493868352
epoch 65 0.16395549464976145 26.234040169460627
epoch 70 0.17509362267756146 26.05870391097967
[32m[I 2021-08-19 21:37:28,160][0m Trial 14 finished with value: 0.17070123872069387 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 254, 'fe_dropout_l0': 0.431288313650368, 'fe_n_units_l1': 121, 'fe_dropout_l1': 0.29719262879375685, 'fe_n_units_l2': 10, 'fe_dropout_l2': 0.014061382143802627, 'fe_n_units_l3': 37, 'fe_dropout_l3': 0.27120698876993443, 'n_units_l(Invariant)': 88, 'n_layers_mlp': 4, 'mlp_n_units_l0': 212, 'mlp_dropout_l0': 0.30961455913602726, 'mlp_n_units_l1': 201, 'mlp_dropout_l1': 0.4480520896566013, 'mlp_n_units_l2': 255, 'mlp_dropout_l2': 0.3932889812346453, 'mlp_n_units_l3': 96, 'mlp_dropout_l3': 0.1960514262367174, 'reduction': 'sum', 'lr': 0.0006944926591217979, 'criterion': 'L1Loss', 'batch_size': 256, 'no_epochs': 72}. Best is trial 5 with value: 0.1771315083501449.[0m

Trial Id: 15 | Model params: 146841 | Timestamp: 2021-08-19 21:37:28.160917

[32m[I 2021-08-19 21:38:02,364][0m Trial 15 pruned. [0m
epoch 0 -2.61347139003096 54.53970580608328

Trial Id: 16 | Model params: 156757 | Timestamp: 2021-08-19 21:38:02.364561

epoch 0 -1.1378020059321594 41.950217884188085
[32m[I 2021-08-19 21:39:38,100][0m Trial 16 pruned. [0m

Trial Id: 17 | Model params: 77898 | Timestamp: 2021-08-19 21:39:38.100610

epoch 0 -0.9654320066595228 40.22346622079018
epoch 5 -0.03938465661014656 29.250859476809183
epoch 10 -1.4386528474075178e-05 28.691523176300393
[32m[I 2021-08-19 21:44:52,377][0m Trial 17 pruned. [0m

Trial Id: 18 | Model params: 142273 | Timestamp: 2021-08-19 21:44:52.377258

[32m[I 2021-08-19 21:45:45,379][0m Trial 18 pruned. [0m
epoch 0 -2.1064761155482934 50.56901450643922

Trial Id: 19 | Model params: 76128 | Timestamp: 2021-08-19 21:45:45.379869

[32m[I 2021-08-19 21:46:15,810][0m Trial 19 pruned. [0m
epoch 0 -2.086725265050697 50.40800028525869

Trial Id: 20 | Model params: 152594 | Timestamp: 2021-08-19 21:46:15.810735

[32m[I 2021-08-19 21:46:54,780][0m Trial 20 pruned. [0m
epoch 0 -7.152670406627491 81.92197678160659

Trial Id: 21 | Model params: 189563 | Timestamp: 2021-08-19 21:46:54.780382

epoch 0 -1.5239131215375994 45.58140224326762
epoch 5 -0.46502700764681437 34.72748210499564
[32m[I 2021-08-19 21:53:19,363][0m Trial 21 pruned. [0m

Trial Id: 22 | Model params: 186994 | Timestamp: 2021-08-19 21:53:19.363432

epoch 0 -1.02736431149942 40.852287470848495
epoch 5 -0.4889898348714652 35.01034151300889
epoch 10 0.14017896164616384 26.604464047761752
epoch 15 0.115204364975523 26.988078607830698
epoch 20 0.11445189109939458 26.999552165936446
epoch 25 0.1314641645134106 26.738950158539758
epoch 30 0.08205230378104 27.48903212567782
epoch 35 0.14224409116127767 26.572495364124524
epoch 40 0.1634628969032601 26.24176758469571
epoch 45 0.16454404616087592 26.224804535360267
epoch 50 0.16586699708950758 26.20403271917763
epoch 55 0.16056545137056588 26.287174039158216
epoch 60 0.17362002420608802 26.081968934322997
epoch 65 0.1742514596250675 26.072002437877604
epoch 70 0.1705696989452189 26.13006134328635
[32m[I 2021-08-19 23:13:12,837][0m Trial 22 finished with value: 0.17322191799283437 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 215, 'fe_dropout_l0': 0.29164077748954403, 'fe_n_units_l1': 213, 'fe_dropout_l1': 0.18967073017180083, 'fe_n_units_l2': 70, 'fe_dropout_l2': 0.0866004323212311, 'fe_n_units_l3': 210, 'fe_dropout_l3': 0.24730289236526012, 'n_units_l(Invariant)': 99, 'n_layers_mlp': 4, 'mlp_n_units_l0': 254, 'mlp_dropout_l0': 0.30535571349925683, 'mlp_n_units_l1': 117, 'mlp_dropout_l1': 0.29676463267317205, 'mlp_n_units_l2': 254, 'mlp_dropout_l2': 0.36693826865291607, 'mlp_n_units_l3': 46, 'mlp_dropout_l3': 0.08578401480148107, 'reduction': 'sum', 'lr': 0.0003991297934089934, 'criterion': 'L1Loss', 'batch_size': 128, 'no_epochs': 75}. Best is trial 5 with value: 0.1771315083501449.[0m

Trial Id: 23 | Model params: 130776 | Timestamp: 2021-08-19 23:13:12.838092

[32m[I 2021-08-19 23:14:05,018][0m Trial 23 pruned. [0m
epoch 0 -1.8472269897607472 48.41294775286665

Trial Id: 24 | Model params: 103664 | Timestamp: 2021-08-19 23:14:05.019108

[32m[I 2021-08-19 23:14:54,833][0m Trial 24 pruned. [0m
epoch 0 -28.362899703499846 155.47120032005228

Trial Id: 25 | Model params: 120203 | Timestamp: 2021-08-19 23:14:54.833266

[32m[I 2021-08-19 23:15:51,892][0m Trial 25 pruned. [0m
epoch 0 -28.362899703499846 155.47120032005228

Trial Id: 26 | Model params: 104708 | Timestamp: 2021-08-19 23:15:51.893051

[32m[I 2021-08-19 23:16:41,203][0m Trial 26 pruned. [0m
epoch 0 -3.556385606008618 61.2436007060976

Trial Id: 27 | Model params: 170342 | Timestamp: 2021-08-19 23:16:41.203842

[32m[I 2021-08-19 23:17:26,883][0m Trial 27 pruned. [0m
epoch 0 -2.180538925720106 51.16828232167516

Trial Id: 28 | Model params: 87335 | Timestamp: 2021-08-19 23:17:26.883221

epoch 0 -1.512123206406141 45.474815784810176
[32m[I 2021-08-19 23:19:48,722][0m Trial 28 pruned. [0m

Trial Id: 29 | Model params: 134664 | Timestamp: 2021-08-19 23:19:48.722682

epoch 0 -1.294670781638823 43.462096685481164
[32m[I 2021-08-19 23:22:41,560][0m Trial 29 pruned. [0m

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  23
  Number of complete trials:  7

Best trial:
  Value:  0.1771315083501449
  Params: 
    n_layers_fe: 2
    fe_n_units_l0: 244
    fe_dropout_l0: 0.48085181089130813
    fe_n_units_l1: 226
    fe_dropout_l1: 0.3149881936768663
    n_units_l(Invariant): 57
    n_layers_mlp: 4
    mlp_n_units_l0: 115
    mlp_dropout_l0: 0.06997740380565826
    mlp_n_units_l1: 145
    mlp_dropout_l1: 0.46114285710804415
    mlp_n_units_l2: 179
    mlp_dropout_l2: 0.3510167070788378
    mlp_n_units_l3: 206
    mlp_dropout_l3: 0.1287556495387751
    reduction: sum
    lr: 0.0021609074565929432
    criterion: L1Loss
    batch_size: 256
    no_epochs: 71
Target 19505 0 314.0 1.0 153.38815688285055
[166. 146. 114. ... 168. 134. 150.]
Prediction 19505 0 179.61367797851562 130.88006591796875 152.36460188821903
[163.84458923 142.48161316 158.05519104 ... 139.33389282 141.93917847
 134.91462708]

 XXXXXX======== TRIAL north - qso ended

Test Set - R-squared:  0.18778037641826106
Test Set - RMSE:  26.181503942912773
Test Set - MAE:  20.217404805339626



