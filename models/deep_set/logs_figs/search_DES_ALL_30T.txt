[32m[I 2021-08-20 12:18:05,514][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: lrg
Training Set: 55414
Validation Set: 13858
Test Samples: 17317
Number of features: 6
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 92093 | Timestamp: 2021-08-20 12:18:05.515056

epoch 0 -9.727690833546992 33.29735412551978
epoch 5 -1.3417584549797392 15.557064381162325
epoch 10 -1.7394863119932462 16.826398415410914
epoch 15 -2.0752945500048603 17.827890576391418
epoch 20 -2.3768473466241176 18.68152453981552
epoch 25 -2.622363999849227 19.348738051027517
epoch 30 -2.8490419007886936 19.944948532389017
epoch 35 -2.901687602974824 20.0808849246873
epoch 40 -2.9918362524584183 20.311545008604025
epoch 45 -3.0644447441597373 20.49543840111475
epoch 50 -3.101841806341885 20.58951203496109
epoch 55 -3.2172462980124266 20.87714383612218
epoch 60 -3.2027887672297437 20.84132768297831
epoch 65 -3.2513922463969678 20.96149185107301
epoch 70 -3.307083493248326 21.098338015920632
epoch 75 -3.2808852276352587 21.034073769115704
[32m[I 2021-08-20 13:16:27,568][0m Trial 0 finished with value: -3.22067643848189 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 107, 'fe_dropout_l0': 0.19745806694182305, 'fe_n_units_l1': 32, 'fe_dropout_l1': 0.16913130325387893, 'fe_n_units_l2': 155, 'fe_dropout_l2': 0.014343999612873137, 'fe_n_units_l3': 179, 'fe_dropout_l3': 0.1968885761440372, 'n_units_l(Invariant)': 32, 'n_layers_mlp': 4, 'mlp_n_units_l0': 71, 'mlp_dropout_l0': 0.3606762029960488, 'mlp_n_units_l1': 115, 'mlp_dropout_l1': 0.4401602883220953, 'mlp_n_units_l2': 143, 'mlp_dropout_l2': 0.37575459945411804, 'mlp_n_units_l3': 134, 'mlp_dropout_l3': 0.2669889485357627, 'reduction': 'sum', 'lr': 1.0775121532401699e-05, 'criterion': 'MSELoss', 'batch_size': 256, 'no_epochs': 79}. Best is trial 0 with value: -3.22067643848189.[0m

Trial Id: 1 | Model params: 139359 | Timestamp: 2021-08-20 13:16:27.568783

[32m[I 2021-08-20 13:17:37,562][0m Trial 1 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 2 | Model params: 46276 | Timestamp: 2021-08-20 13:17:37.563105

[32m[I 2021-08-20 13:17:53,650][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 43119 | Timestamp: 2021-08-20 13:17:53.650587

[32m[I 2021-08-20 13:18:42,740][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 201254 | Timestamp: 2021-08-20 13:18:42.741123

epoch 0 -1.851071003894989 17.1656643848055
epoch 5 -0.7218093125377734 13.33979411350161
epoch 10 -0.017136300357868173 10.25288715639623
epoch 15 -0.027073746605573268 10.302850894003909
epoch 20 -0.04045847151193738 10.369766464447537
epoch 25 -0.010131530287798007 10.217521593851115
epoch 30 -0.009490308995395713 10.214278089281532
epoch 35 -0.0014454314330420992 10.173496625133323
epoch 40 -0.011509971850324208 10.224490713408482
epoch 45 -0.015850457554306363 10.246404362297595
epoch 50 -0.006468987165775042 10.198981386313129
epoch 55 -0.00928286289517044 10.21322853932277
epoch 60 -0.009088131730769167 10.212243220984572
epoch 65 -0.007254949521069198 10.202962855785595
epoch 70 -0.020320717207981565 10.268924314871079
epoch 75 -0.008493968175148803 10.209236230809116
epoch 80 -0.0033099349972383063 10.182962792422728
epoch 85 -0.007587052749321144 10.204644732677039
epoch 90 -0.010266052380848656 10.218201919428278
epoch 95 -0.009926635665118644 10.216485282568078
[32m[I 2021-08-20 15:43:43,446][0m Trial 4 finished with value: -0.00549899341892357 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 252, 'fe_dropout_l0': 0.42508111011722094, 'fe_n_units_l1': 128, 'fe_dropout_l1': 0.204813175901775, 'fe_n_units_l2': 238, 'fe_dropout_l2': 0.11535834337275841, 'fe_n_units_l3': 230, 'fe_dropout_l3': 0.3485233647720467, 'n_units_l(Invariant)': 130, 'n_layers_mlp': 4, 'mlp_n_units_l0': 76, 'mlp_dropout_l0': 0.17005978865513482, 'mlp_n_units_l1': 221, 'mlp_dropout_l1': 0.2703734391047133, 'mlp_n_units_l2': 69, 'mlp_dropout_l2': 0.36969216454352694, 'mlp_n_units_l3': 195, 'mlp_dropout_l3': 0.408065639709221, 'reduction': 'sum', 'lr': 0.0002237761299602978, 'criterion': 'L1Loss', 'batch_size': 128, 'no_epochs': 98}. Best is trial 4 with value: -0.00549899341892357.[0m

Trial Id: 5 | Model params: 96589 | Timestamp: 2021-08-20 15:43:43.446514

epoch 0 -0.27617049846208896 11.484469821920724
epoch 5 0.001996925271261607 10.155996444856926
epoch 10 -0.015896192777263396 10.246635014511277
epoch 15 -0.001241742590739392 10.17246195411405
epoch 20 0.0016900997130199213 10.157557502077026
epoch 25 0.00042402799782614853 10.163996445262269
epoch 30 0.0008526072193766332 10.161817248865201
epoch 35 0.0033345607028983926 10.149188061132064
epoch 40 -0.004065101118835068 10.186794301415794
epoch 45 0.0006902575191592986 10.162642803225053
epoch 50 0.0029954542269824413 10.150914499394506
epoch 55 -0.001311448945410243 10.172816050866865
epoch 60 -0.007507206391395682 10.20424039051298
[32m[I 2021-08-20 16:49:58,285][0m Trial 5 finished with value: -0.008621181413925427 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 141, 'fe_dropout_l0': 0.10531228819691191, 'fe_n_units_l1': 109, 'fe_dropout_l1': 0.2191318694087237, 'fe_n_units_l2': 43, 'fe_dropout_l2': 0.28009420718034883, 'fe_n_units_l3': 242, 'fe_dropout_l3': 0.16762546208902762, 'n_units_l(Invariant)': 132, 'n_layers_mlp': 2, 'mlp_n_units_l0': 133, 'mlp_dropout_l0': 0.2540955789426262, 'mlp_n_units_l1': 175, 'mlp_dropout_l1': 0.00623887398672035, 'reduction': 'sum', 'lr': 0.0013845697408073551, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 65}. Best is trial 4 with value: -0.00549899341892357.[0m

Trial Id: 6 | Model params: 129992 | Timestamp: 2021-08-20 16:49:58.285654

[32m[I 2021-08-20 16:50:50,773][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 218796 | Timestamp: 2021-08-20 16:50:50.773799

epoch 0 -1.8823302174684788 17.25951024012324
epoch 5 -0.14758666607631588 10.890538314531456
epoch 10 -0.035594325470240884 10.34549872578282
epoch 15 -0.029730736738997843 10.316168774998587
epoch 20 -0.005766478226694183 10.195421352978427
epoch 25 0.0008763167962750895 10.161696679158185
epoch 30 -0.0422457049661511 10.37866890605742
epoch 35 -0.014016089826585976 10.237148981217942
epoch 40 -0.03131873857417444 10.324120263337047
epoch 45 -0.02883756007250904 10.311693740972645
epoch 50 -0.008550306614416359 10.209521390870002
[32m[I 2021-08-20 18:08:51,138][0m Trial 7 finished with value: -0.011035356886786696 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 170, 'fe_dropout_l0': 0.3710066982830488, 'fe_n_units_l1': 173, 'fe_dropout_l1': 0.18307501797998643, 'fe_n_units_l2': 183, 'fe_dropout_l2': 0.21624791822389733, 'fe_n_units_l3': 201, 'fe_dropout_l3': 0.46881789290474374, 'n_units_l(Invariant)': 166, 'n_layers_mlp': 4, 'mlp_n_units_l0': 84, 'mlp_dropout_l0': 0.1400086319914734, 'mlp_n_units_l1': 46, 'mlp_dropout_l1': 0.20823846685207997, 'mlp_n_units_l2': 249, 'mlp_dropout_l2': 0.2005653448793433, 'mlp_n_units_l3': 256, 'mlp_dropout_l3': 0.15588891112335557, 'reduction': 'sum', 'lr': 0.0002893071768420551, 'criterion': 'L1Loss', 'batch_size': 128, 'no_epochs': 56}. Best is trial 4 with value: -0.00549899341892357.[0m
epoch 55 -0.011035356886786696 10.22209169323348

Trial Id: 8 | Model params: 139940 | Timestamp: 2021-08-20 18:08:51.138272

[32m[I 2021-08-20 18:09:48,451][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 49413 | Timestamp: 2021-08-20 18:09:48.451634

epoch 0 -2.103241677826576 17.908713972659832
epoch 5 -0.04383504513872105 10.386579205743814
epoch 10 -0.019059710565375365 10.262576710153168
epoch 15 -0.010560204812432916 10.21968939402852
epoch 20 -0.03437667207990747 10.339414810282397
epoch 25 -0.03717458124183759 10.353389026887747
epoch 30 -0.0005711848662639518 10.169055001966326
epoch 35 -0.01277060102451455 10.230860041547992
epoch 40 -0.006444967421513903 10.198859684408061
epoch 45 -0.009844750530952906 10.216071096429843
epoch 50 -0.009054101710215923 10.212071023053712
epoch 55 -0.027278365617048106 10.30387713685312
epoch 60 -0.007907615021863101 10.206267899605749
epoch 65 -0.005848058066832085 10.195834830657759
epoch 70 -0.008385289693302322 10.20868612628571
epoch 75 -0.010334076414630022 10.21854592366896
epoch 80 -0.012820904128061583 10.231114115679512
epoch 85 -0.014681092389282169 10.240505246762352
[32m[I 2021-08-20 18:56:11,241][0m Trial 9 finished with value: -0.016857401918121795 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 55, 'fe_dropout_l0': 0.47657018648200916, 'fe_n_units_l1': 198, 'fe_dropout_l1': 0.49223445848019987, 'n_units_l(Invariant)': 58, 'n_layers_mlp': 4, 'mlp_n_units_l0': 42, 'mlp_dropout_l0': 0.3127030418657992, 'mlp_n_units_l1': 14, 'mlp_dropout_l1': 0.05753931632980441, 'mlp_n_units_l2': 149, 'mlp_dropout_l2': 0.306591335956981, 'mlp_n_units_l3': 137, 'mlp_dropout_l3': 0.3838136426880585, 'reduction': 'sum', 'lr': 0.0005975576272265215, 'criterion': 'L1Loss', 'batch_size': 128, 'no_epochs': 90}. Best is trial 4 with value: -0.00549899341892357.[0m

Trial Id: 10 | Model params: 143494 | Timestamp: 2021-08-20 18:56:11.242162

epoch 0 -0.4439003021877441 12.215892553489082
[32m[I 2021-08-20 19:01:39,539][0m Trial 10 pruned. [0m
epoch 5 -0.5444044868921438 12.633891064303498

Trial Id: 11 | Model params: 84993 | Timestamp: 2021-08-20 19:01:39.539318

epoch 0 -0.00931054037390977 10.213368576614704
epoch 5 -0.0005282063895830635 10.168836599121411
epoch 10 -0.0001344653745138924 10.166835515087882
epoch 15 -0.002290587633747343 10.177788611580507
epoch 20 -4.54015508359884e-05 10.16638281725725
epoch 25 -0.004764489313650921 10.19034152332544
epoch 30 -0.0007475801450287367 10.1699513371136
epoch 35 -0.0007388032823822943 10.16990674022249
epoch 40 -0.00031125637006690354 10.167734057039493
epoch 45 -0.00023885019688330011 10.167366061562513
epoch 50 -0.004136413283300389 10.187156045615266
epoch 55 -0.00046024610441652847 10.16849123715844
epoch 60 -0.00028055496089751664 10.167578022526794
[32m[I 2021-08-20 19:51:25,433][0m Trial 11 finished with value: -0.0008163767747022543 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 252, 'fe_dropout_l0': 0.05713554718722381, 'fe_n_units_l1': 108, 'fe_dropout_l1': 0.2902040349766173, 'fe_n_units_l2': 36, 'fe_dropout_l2': 0.2031672532844592, 'fe_n_units_l3': 30, 'fe_dropout_l3': 0.274334250991234, 'n_units_l(Invariant)': 98, 'n_layers_mlp': 2, 'mlp_n_units_l0': 149, 'mlp_dropout_l0': 0.28261746382083397, 'mlp_n_units_l1': 250, 'mlp_dropout_l1': 0.3044012078724299, 'reduction': 'sum', 'lr': 0.007908341062816, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 65}. Best is trial 11 with value: -0.0008163767747022543.[0m

Trial Id: 12 | Model params: 78533 | Timestamp: 2021-08-20 19:51:25.433855

epoch 0 -0.19614558697391238 11.118561988296461
epoch 5 -0.00825888553129328 10.208046261310356
epoch 10 -0.007620697048270841 10.20481510269676
epoch 15 -0.003185158477135186 10.18232957125943
epoch 20 -0.0002462130425471276 10.167403482929089
epoch 25 -0.0016494952104064708 10.174533095188286
epoch 30 -0.009190404755419213 10.212760723126975
epoch 35 -0.0007441164062638173 10.169933737228341
epoch 40 -0.0032059459616320396 10.18243506719895
epoch 45 -5.457662315833112e-05 10.166429453681715
epoch 50 -8.975458254401047e-06 10.166197663176549
epoch 55 -0.001196902102762909 10.172234165336537
epoch 60 -0.005409665482824844 10.193612693089827
epoch 65 -0.0001369657759826559 10.166848223956261
[32m[I 2021-08-20 20:35:48,681][0m Trial 12 finished with value: -0.0012958711825825642 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 254, 'fe_dropout_l0': 0.007507580127070319, 'fe_n_units_l1': 89, 'fe_dropout_l1': 0.3040332545388305, 'fe_n_units_l2': 10, 'fe_dropout_l2': 0.15993220296969618, 'fe_n_units_l3': 18, 'fe_dropout_l3': 0.331071735941188, 'n_units_l(Invariant)': 87, 'n_layers_mlp': 2, 'mlp_n_units_l0': 160, 'mlp_dropout_l0': 0.358646250911402, 'mlp_n_units_l1': 250, 'mlp_dropout_l1': 0.31196895530041435, 'reduction': 'sum', 'lr': 0.009382851270923993, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 69}. Best is trial 11 with value: -0.0008163767747022543.[0m

Trial Id: 13 | Model params: 99324 | Timestamp: 2021-08-20 20:35:48.682067

epoch 0 -0.28940522253278944 11.543866960003003
epoch 5 0.00263689173559456 10.152739671615869
epoch 10 -0.006565982125644743 10.199472820212314
epoch 15 -0.002984010227415679 10.181308692694227
epoch 20 -0.00105560518406711 10.171516346466252
epoch 25 -0.005963861835658557 10.19642173943991
epoch 30 -0.004694703019018975 10.18998763018323
epoch 35 -1.067951274347223e-05 10.166206324972496
epoch 40 -1.742925727854505e-05 10.166240634195988
epoch 45 -5.363818284331856e-05 10.166424683647298
epoch 50 -0.00022720030250655832 10.167306851162126
epoch 55 -2.500228412083416e-06 10.166164749185437
epoch 60 -7.250404302938662e-06 10.166188894631743
epoch 65 -0.0027721368488391462 10.180233270662708
[32m[I 2021-08-20 21:16:55,754][0m Trial 13 finished with value: -0.0014660158582122662 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 231, 'fe_dropout_l0': 0.007131691182763638, 'fe_n_units_l1': 79, 'fe_dropout_l1': 0.3008201944291013, 'fe_n_units_l2': 8, 'fe_dropout_l2': 0.17139939725070102, 'fe_n_units_l3': 9, 'fe_dropout_l3': 0.3091993882796453, 'n_units_l(Invariant)': 80, 'n_layers_mlp': 2, 'mlp_n_units_l0': 243, 'mlp_dropout_l0': 0.3786634516240209, 'mlp_n_units_l1': 251, 'mlp_dropout_l1': 0.322784193586969, 'reduction': 'sum', 'lr': 0.009373606626745008, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 67}. Best is trial 11 with value: -0.0008163767747022543.[0m

Trial Id: 14 | Model params: 68879 | Timestamp: 2021-08-20 21:16:55.754518

epoch 0 -0.16728456644082978 10.983606672379794
epoch 5 -0.0023084171909670825 10.177879136553829
epoch 10 -0.0003560139364215953 10.167961525209241
epoch 15 -0.015473168118782299 10.2445014153119
epoch 20 -0.008775869847073459 10.21066301161369
epoch 25 -0.0032165420512904053 10.182488841655955
epoch 30 -0.007947491595949874 10.206469796568596
epoch 35 -0.0037348076354726256 10.185118658810527
epoch 40 -0.0031166624108851515 10.181981947782038
epoch 45 -0.00031009023389838575 10.167728130401251
epoch 50 -2.1611505207186354e-05 10.166261892672658
epoch 55 -0.003154567663619323 10.182174321694053
[32m[I 2021-08-20 21:53:50,035][0m Trial 14 finished with value: -0.00020904908558616597 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 221, 'fe_dropout_l0': 0.00027076128051939374, 'fe_n_units_l1': 81, 'fe_dropout_l1': 0.32982461518291406, 'fe_n_units_l2': 10, 'fe_dropout_l2': 0.28220781978692894, 'fe_n_units_l3': 10, 'fe_dropout_l3': 0.2724364139632482, 'n_units_l(Invariant)': 86, 'n_layers_mlp': 2, 'mlp_n_units_l0': 163, 'mlp_dropout_l0': 0.29633040776079744, 'mlp_n_units_l1': 221, 'mlp_dropout_l1': 0.3566271674432465, 'reduction': 'sum', 'lr': 0.006064135331266147, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 61}. Best is trial 14 with value: -0.00020904908558616597.[0m
epoch 60 -0.00020904908558616597 10.167214597207543

Trial Id: 15 | Model params: 89444 | Timestamp: 2021-08-20 21:53:50.035626

[32m[I 2021-08-20 21:54:44,342][0m Trial 15 pruned. [0m
epoch 0 -0.3617592621048018 11.863334321147597

Trial Id: 16 | Model params: 77599 | Timestamp: 2021-08-20 21:54:44.342964

epoch 0 -0.13854910049057856 10.847570535696414
epoch 5 0.00017032328673993735 10.165286237259615
epoch 10 0.0011022689860571422 10.16054757845954
epoch 15 -0.0019465898389281477 10.176041893941425
epoch 20 -0.0008123933098744818 10.170280658949364
epoch 25 -0.0017001698520218156 10.174790462810265
epoch 30 -0.002235968979265479 10.177511294453181
epoch 35 -1.8707721709532166e-06 10.16616154961501
epoch 40 -1.661853758339049e-05 10.166236513281223
[32m[I 2021-08-20 22:19:45,831][0m Trial 16 finished with value: -0.00023029896183635046 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 183, 'fe_dropout_l0': 0.19559701959305076, 'fe_n_units_l1': 8, 'fe_dropout_l1': 0.48218016705671163, 'fe_n_units_l2': 12, 'fe_dropout_l2': 0.38848266278453214, 'fe_n_units_l3': 55, 'fe_dropout_l3': 0.043263276038555926, 'n_units_l(Invariant)': 167, 'n_layers_mlp': 2, 'mlp_n_units_l0': 224, 'mlp_dropout_l0': 0.4327075421442415, 'mlp_n_units_l1': 219, 'mlp_dropout_l1': 0.17419488629975405, 'reduction': 'sum', 'lr': 0.0037133472499221594, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 42}. Best is trial 14 with value: -0.00020904908558616597.[0m

Trial Id: 17 | Model params: 87989 | Timestamp: 2021-08-20 22:19:45.831451

[32m[I 2021-08-20 22:20:29,766][0m Trial 17 pruned. [0m
epoch 0 -0.3365006303583422 11.752795636537877

Trial Id: 18 | Model params: 72463 | Timestamp: 2021-08-20 22:20:29.766782

epoch 0 -0.1160871049080161 10.740033740339749
epoch 5 -0.042784123224757886 10.38134934086664
epoch 10 0.0020339137879742397 10.155808239662727
epoch 15 -0.0012293135734193772 10.172398815466902
epoch 20 0.00019410666844899005 10.16516533350663
epoch 25 -1.0945631708336734e-05 10.166207677668114
epoch 30 -0.0002287186336034086 10.167314568074994
epoch 35 -1.2070980712763912e-05 10.166213397869736
[32m[I 2021-08-20 22:56:01,242][0m Trial 18 finished with value: -7.04724958191516e-05 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 192, 'fe_dropout_l0': 0.18682517794819586, 'fe_n_units_l1': 10, 'fe_dropout_l1': 0.44007664894879767, 'fe_n_units_l2': 103, 'fe_dropout_l2': 0.3797839882732589, 'fe_n_units_l3': 66, 'fe_dropout_l3': 0.07976699296449358, 'n_units_l(Invariant)': 203, 'n_layers_mlp': 2, 'mlp_n_units_l0': 218, 'mlp_dropout_l0': 0.4121151797134225, 'mlp_n_units_l1': 149, 'mlp_dropout_l1': 0.22147633581937046, 'reduction': 'sum', 'lr': 0.0038205756681296207, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 41}. Best is trial 18 with value: -7.04724958191516e-05.[0m
epoch 40 -7.04724958191516e-05 10.166510251084986

Trial Id: 19 | Model params: 55186 | Timestamp: 2021-08-20 22:56:01.242764

[32m[I 2021-08-20 22:56:36,084][0m Trial 19 pruned. [0m
epoch 0 -0.33546299817803527 11.74823243372049

Trial Id: 20 | Model params: 94315 | Timestamp: 2021-08-20 22:56:36.084415

[32m[I 2021-08-20 22:57:34,172][0m Trial 20 pruned. [0m
epoch 0 -0.31540657664282556 11.659679290974902

Trial Id: 21 | Model params: 85255 | Timestamp: 2021-08-20 22:57:34.172809

epoch 0 -0.17473025814246324 11.018581242181808
epoch 5 0.003166670109854164 10.150042852209715
epoch 10 -3.464295996291611e-06 10.166169649606951
epoch 15 -0.0017165831567427237 10.174873821712096
epoch 20 -0.0012713742423893226 10.17261247950971
epoch 25 -0.002953969191357597 10.181156218004348
epoch 30 -5.781030515628061e-06 10.166181425717413
epoch 35 -0.002767483382847713 10.180209649431855
[32m[I 2021-08-20 23:29:15,166][0m Trial 21 finished with value: -0.0020525330968361732 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 190, 'fe_dropout_l0': 0.1905365373437831, 'fe_n_units_l1': 9, 'fe_dropout_l1': 0.46144675790738005, 'fe_n_units_l2': 73, 'fe_dropout_l2': 0.38676499719975715, 'fe_n_units_l3': 59, 'fe_dropout_l3': 0.000885879625077822, 'n_units_l(Invariant)': 187, 'n_layers_mlp': 2, 'mlp_n_units_l0': 229, 'mlp_dropout_l0': 0.42110217922868753, 'mlp_n_units_l1': 218, 'mlp_dropout_l1': 0.14165963821625419, 'reduction': 'sum', 'lr': 0.0029386993804941725, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 40}. Best is trial 18 with value: -7.04724958191516e-05.[0m

Trial Id: 22 | Model params: 74228 | Timestamp: 2021-08-20 23:29:15.166366

epoch 0 -0.08221868287460588 10.575821547435668
epoch 5 0.003420002153826318 10.148753020492977
epoch 10 0.0007060964368380551 10.162562264682425
epoch 15 -0.0012412172344029582 10.172459285343953
epoch 20 0.0017070369438948463 10.157471335634018
epoch 25 0.0004746946281334319 10.16373884504442
epoch 30 0.0017337152139837997 10.157335611160242
epoch 35 -0.0018510109141116615 10.175556519596471
epoch 40 0.0040812537172000285 10.145385507404717
[32m[I 2021-08-21 00:03:31,083][0m Trial 22 finished with value: 0.0033112985317766963 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 156, 'fe_dropout_l0': 0.1534943152514781, 'fe_n_units_l1': 10, 'fe_dropout_l1': 0.4574354327980903, 'fe_n_units_l2': 146, 'fe_dropout_l2': 0.3802389474503816, 'fe_n_units_l3': 94, 'fe_dropout_l3': 0.05627571089172668, 'n_units_l(Invariant)': 157, 'n_layers_mlp': 2, 'mlp_n_units_l0': 187, 'mlp_dropout_l0': 0.4217877524488634, 'mlp_n_units_l1': 151, 'mlp_dropout_l1': 0.21808807890469853, 'reduction': 'sum', 'lr': 0.00471120213385988, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 45}. Best is trial 22 with value: 0.0033112985317766963.[0m

Trial Id: 23 | Model params: 96254 | Timestamp: 2021-08-21 00:03:31.083356

[32m[I 2021-08-21 00:04:32,319][0m Trial 23 pruned. [0m
epoch 0 -1.9803544346431359 17.55054301227505

Trial Id: 24 | Model params: 80613 | Timestamp: 2021-08-21 00:04:32.319538

epoch 0 -0.15350937833933576 10.918605264706477
[32m[I 2021-08-21 00:06:34,436][0m Trial 24 pruned. [0m

Trial Id: 25 | Model params: 67137 | Timestamp: 2021-08-21 00:06:34.436842

epoch 0 0.003224535516385907 10.149748246851829
epoch 5 -0.03309489329299686 10.333006626909466
epoch 10 -0.0010065253555298082 10.171266998480625
epoch 15 -0.0031955929140123907 10.18238252588999
epoch 20 -0.0036342202094208353 10.184608304616184
epoch 25 -0.00021232790192771134 10.167231261924826
epoch 30 -0.004582614689472075 10.189419193549403
epoch 35 -0.0005885862641077377 10.169143428959373
epoch 40 -5.627646685990584e-06 10.166180646057969
epoch 45 -7.687938968259367e-05 10.166542816613921
epoch 50 -0.0006601723745780497 10.16950719305527
[32m[I 2021-08-21 00:56:53,627][0m Trial 25 finished with value: -0.000200278050068059 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 115, 'fe_dropout_l0': 0.07120927047341924, 'fe_n_units_l1': 95, 'fe_dropout_l1': 0.26733912918490604, 'fe_n_units_l2': 127, 'fe_dropout_l2': 0.4352329736236614, 'fe_n_units_l3': 38, 'fe_dropout_l3': 0.06288790806147027, 'n_units_l(Invariant)': 255, 'n_layers_mlp': 2, 'mlp_n_units_l0': 172, 'mlp_dropout_l0': 0.4042393398623952, 'mlp_n_units_l1': 95, 'mlp_dropout_l1': 0.2708493079195523, 'reduction': 'sum', 'lr': 0.009073686451903118, 'criterion': 'MSELoss', 'batch_size': 32, 'no_epochs': 52}. Best is trial 22 with value: 0.0033112985317766963.[0m

Trial Id: 26 | Model params: 115281 | Timestamp: 2021-08-21 00:56:53.627923

[32m[I 2021-08-21 00:58:03,078][0m Trial 26 pruned. [0m
epoch 0 -0.3284640061431472 11.717406494588186

Trial Id: 27 | Model params: 60680 | Timestamp: 2021-08-21 00:58:03.079181

[32m[I 2021-08-21 00:58:48,609][0m Trial 27 pruned. [0m
epoch 0 -0.4327382955826571 12.16858374136059

Trial Id: 28 | Model params: 109115 | Timestamp: 2021-08-21 00:58:48.609840

[32m[I 2021-08-21 00:59:54,407][0m Trial 28 pruned. [0m
epoch 0 -0.4144758165010791 12.090781250026286

Trial Id: 29 | Model params: 62118 | Timestamp: 2021-08-21 00:59:54.407575

epoch 0 -0.15196223822036958 10.911280538676735
epoch 5 0.00429105854392553 10.144316814315658
epoch 10 -0.016785861310582684 10.251120765039111
epoch 15 0.004570145966112049 10.14289503857104
epoch 20 -0.001093562278180693 10.171709181680171
epoch 25 -0.010840568771586012 10.221106941377688
epoch 30 0.004079559905539987 10.145394134797776
epoch 35 -0.004809534690059403 10.19056994631903
epoch 40 0.0035630395369573575 10.14802467797697
[32m[I 2021-08-21 01:39:01,576][0m Trial 29 finished with value: 0.001591239437872094 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 150, 'fe_dropout_l0': 0.15636780892286445, 'fe_n_units_l1': 36, 'fe_dropout_l1': 0.12972800946443067, 'fe_n_units_l2': 182, 'fe_dropout_l2': 0.4662766510777509, 'fe_n_units_l3': 37, 'fe_dropout_l3': 0.07563690745333396, 'n_units_l(Invariant)': 196, 'n_layers_mlp': 2, 'mlp_n_units_l0': 213, 'mlp_dropout_l0': 0.3499191090977718, 'mlp_n_units_l1': 94, 'mlp_dropout_l1': 0.281576917173555, 'reduction': 'sum', 'lr': 0.000647418451724594, 'criterion': 'MSELoss', 'batch_size': 32, 'no_epochs': 44}. Best is trial 22 with value: 0.0033112985317766963.[0m

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  15
  Number of complete trials:  15

Best trial:
  Value:  0.0033112985317766963
  Params: 
    n_layers_fe: 4
    fe_n_units_l0: 156
    fe_dropout_l0: 0.1534943152514781
    fe_n_units_l1: 10
    fe_dropout_l1: 0.4574354327980903
    fe_n_units_l2: 146
    fe_dropout_l2: 0.3802389474503816
    fe_n_units_l3: 94
    fe_dropout_l3: 0.05627571089172668
    n_units_l(Invariant): 157
    n_layers_mlp: 2
    mlp_n_units_l0: 187
    mlp_dropout_l0: 0.4217877524488634
    mlp_n_units_l1: 151
    mlp_dropout_l1: 0.21808807890469853
    reduction: sum
    lr: 0.00471120213385988
    criterion: MSELoss
    batch_size: 128
    no_epochs: 45
Target 17317 0 105.0 4.0 32.608765952532195
[26. 33. 36. ... 29. 25. 29.]
Prediction 17317 0 37.22126770019531 31.98766326904297 32.287692835997746
[32.21341705 32.01544189 32.1586113  ... 32.84783173 31.98766327
 32.08890533]

 XXXXXX======== TRIAL des - lrg ended

Test Set - R-squared:  0.003216345139268495
Test Set - RMSE:  10.17921241701079
Test Set - MAE:  7.709397448095692



[32m[I 2021-08-21 01:41:26,891][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: elg
Training Set: 55414
Validation Set: 13858
Test Samples: 17317
Number of features: 6
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 125069 | Timestamp: 2021-08-21 01:41:26.892191

[32m[I 2021-08-21 01:42:39,824][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 97149 | Timestamp: 2021-08-21 01:42:39.824909

epoch 0 -7.287435285273425 53.184161556612366
epoch 5 -0.009448601633571307 18.561554605750477
epoch 10 -0.0063326687900668865 18.532884865387388
epoch 15 -0.0032358232148170796 18.504346735098363
epoch 20 -0.011307386232616956 18.578636239992132
epoch 25 -0.006807424997765876 18.537255966976257
epoch 30 -0.0021234642975451745 18.494085347207964
epoch 35 -0.009609096745491374 18.56303012435389
[32m[I 2021-08-21 02:22:35,803][0m Trial 1 finished with value: -0.005892182969178261 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 140, 'fe_dropout_l0': 0.18834924545760356, 'fe_n_units_l1': 153, 'fe_dropout_l1': 0.3183198275901038, 'fe_n_units_l2': 175, 'fe_dropout_l2': 0.0730573021321691, 'fe_n_units_l3': 51, 'fe_dropout_l3': 0.12837999233257197, 'n_units_l(Invariant)': 86, 'n_layers_mlp': 4, 'mlp_n_units_l0': 122, 'mlp_dropout_l0': 0.24036415646761433, 'mlp_n_units_l1': 47, 'mlp_dropout_l1': 0.08497517953331357, 'mlp_n_units_l2': 75, 'mlp_dropout_l2': 0.3269320997954261, 'mlp_n_units_l3': 215, 'mlp_dropout_l3': 0.3146246702882979, 'reduction': 'sum', 'lr': 0.005469900631923101, 'criterion': 'L1Loss', 'batch_size': 256, 'no_epochs': 41}. Best is trial 1 with value: -0.005892182969178261.[0m
epoch 40 -0.005892182969178261 18.52882837056784

Trial Id: 2 | Model params: 44771 | Timestamp: 2021-08-21 02:22:35.803212

[32m[I 2021-08-21 02:23:26,261][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 196601 | Timestamp: 2021-08-21 02:23:26.262088

[33m[W 2021-08-21 02:23:29,317][0m Trial 3 failed because of the following error: RuntimeError('CUDA out of memory. Tried to allocate 680.00 MiB (GPU 0; 7.93 GiB total capacity; 5.32 GiB already allocated; 318.06 MiB free; 5.60 GiB reserved in total by PyTorch)')
Traceback (most recent call last):
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 216, in _run_trial
    value_or_values = func(trial)
  File "hp_optim.py", line 260, in objective
    predictions = model(X1, X2, mask=mask)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/astrostatistics/models/deep_set/models.py", line 95, in forward
    y = self.feature_extractor(X1)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/functional.py", line 1298, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 680.00 MiB (GPU 0; 7.93 GiB total capacity; 5.32 GiB already allocated; 318.06 MiB free; 5.60 GiB reserved in total by PyTorch)[0m
Traceback (most recent call last):
  File "hp_optim.py", line 325, in <module>
    main()
  File "hp_optim.py", line 42, in main
    study.optimize(objective, n_trials=args['trials'], timeout=None)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/study.py", line 401, in optimize
    _optimize(
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 65, in _optimize
    _optimize_sequential(
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 162, in _optimize_sequential
    trial = _run_trial(study, func, catch)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 267, in _run_trial
    raise func_err
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 216, in _run_trial
    value_or_values = func(trial)
  File "hp_optim.py", line 260, in objective
    predictions = model(X1, X2, mask=mask)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/astrostatistics/models/deep_set/models.py", line 95, in forward
    y = self.feature_extractor(X1)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/functional.py", line 1298, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 680.00 MiB (GPU 0; 7.93 GiB total capacity; 5.32 GiB already allocated; 318.06 MiB free; 5.60 GiB reserved in total by PyTorch)
[32m[I 2021-08-21 02:24:28,897][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: qso
Training Set: 55414
Validation Set: 13858
Test Samples: 17317
Number of features: 6
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 179463 | Timestamp: 2021-08-21 02:24:28.898511

epoch 0 -2.3234498482463137 45.086345009298604
epoch 5 -0.0012025676102545013 24.746366610756912
epoch 10 -0.0012387465128924635 24.746813717231355
epoch 15 -0.013520630368645037 24.898131816727943
epoch 20 -0.03174934186981404 25.121037134926063
epoch 25 -0.014183061596695357 24.906267125196436
epoch 30 -0.02683590439991801 25.061149552422187
epoch 35 -0.005630815760408803 24.80103194692839
epoch 40 -0.0021362169518366336 24.757902260868466
epoch 45 -0.008247809727342181 24.83328134657786
[32m[I 2021-08-21 03:14:03,148][0m Trial 0 finished with value: 0.009935854782797349 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 98, 'fe_dropout_l0': 0.01856315271117842, 'fe_n_units_l1': 12, 'fe_dropout_l1': 0.38414312248078136, 'fe_n_units_l2': 252, 'fe_dropout_l2': 0.11102661522603663, 'fe_n_units_l3': 233, 'fe_dropout_l3': 0.17507638636949624, 'n_units_l(Invariant)': 55, 'n_layers_mlp': 4, 'mlp_n_units_l0': 230, 'mlp_dropout_l0': 0.4932403295701788, 'mlp_n_units_l1': 256, 'mlp_dropout_l1': 0.14657311195781575, 'mlp_n_units_l2': 93, 'mlp_dropout_l2': 0.20930877776178441, 'mlp_n_units_l3': 42, 'mlp_dropout_l3': 0.171971684946657, 'reduction': 'sum', 'lr': 0.0001886738494646323, 'criterion': 'L1Loss', 'batch_size': 32, 'no_epochs': 48}. Best is trial 0 with value: 0.009935854782797349.[0m

Trial Id: 1 | Model params: 127205 | Timestamp: 2021-08-21 03:14:03.148908

[32m[I 2021-08-21 03:14:53,510][0m Trial 1 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 2 | Model params: 104492 | Timestamp: 2021-08-21 03:14:53.511151

[32m[I 2021-08-21 03:15:38,270][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 50298 | Timestamp: 2021-08-21 03:15:38.270874

[32m[I 2021-08-21 03:16:14,682][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 162502 | Timestamp: 2021-08-21 03:16:14.683154

epoch 0 -2.1941216538971213 44.20039920112898
epoch 5 -0.4470173811223963 29.750025281358116
epoch 10 -0.011067288945306064 24.86797918535653
epoch 15 -0.005507766668049863 24.799514572072
epoch 20 -1.7351458003744824e-07 24.73150257376539
epoch 25 -0.0020589963951023194 24.756948370671456
epoch 30 -0.0029392652288227072 24.767819979143834
epoch 35 -0.003447767763296028 24.774097978062837
epoch 40 -1.078233820672736e-05 24.731633759469116
epoch 45 -4.786087641983627e-06 24.731559611621
epoch 50 -0.01749586852878826 24.946911851148926
epoch 55 -0.00011247289213023315 24.732891200712512
epoch 60 -0.00010905747244915887 24.732848968824708
[32m[I 2021-08-21 04:26:46,192][0m Trial 4 finished with value: -0.006492092193268073 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 180, 'fe_dropout_l0': 0.13652975108521326, 'fe_n_units_l1': 239, 'fe_dropout_l1': 0.018932293970351177, 'fe_n_units_l2': 26, 'fe_dropout_l2': 0.13871212939589156, 'fe_n_units_l3': 146, 'fe_dropout_l3': 0.43916103960378955, 'n_units_l(Invariant)': 242, 'n_layers_mlp': 4, 'mlp_n_units_l0': 254, 'mlp_dropout_l0': 0.2813764057472502, 'mlp_n_units_l1': 121, 'mlp_dropout_l1': 0.14555007895357092, 'mlp_n_units_l2': 80, 'mlp_dropout_l2': 0.3603055853176366, 'mlp_n_units_l3': 175, 'mlp_dropout_l3': 0.4256889732295499, 'reduction': 'sum', 'lr': 0.005889565771105937, 'criterion': 'MSELoss', 'batch_size': 128, 'no_epochs': 62}. Best is trial 0 with value: 0.009935854782797349.[0m

Trial Id: 5 | Model params: 73344 | Timestamp: 2021-08-21 04:26:46.193075

epoch 0 -1.5493544737103964 39.48804002411144
epoch 5 -1.1140361158651686 35.958922230070264
epoch 10 -3.7035409159086567 53.636808481665234
epoch 15 -5.641637653700683 63.73647699167715
epoch 20 -5.154351734019181 61.35382199279875
epoch 25 -2.4322790081556076 45.818593909161514
epoch 30 -3.858351555295207 54.5123536898502
epoch 35 -1.6708176234554784 40.41779174911828
epoch 40 -1.5547257975493158 39.529617499631605
epoch 45 -0.9944599353522867 34.92714792683443
epoch 50 -0.5184993768552721 30.475986622149314
epoch 55 -0.40374948153880474 29.301865441591204
epoch 60 -0.4954554276693035 30.243858807894867
epoch 65 -0.15065047938615095 26.529079220344713
epoch 70 -0.26046690145936124 27.76618342241562
epoch 75 -0.31499565105332694 28.36041773555411
epoch 80 -0.21680454761048162 27.28103717145218
epoch 85 -0.12444655383873071 26.22526432388821
[32m[I 2021-08-21 05:28:08,001][0m Trial 5 finished with value: -0.25169326580442464 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 199, 'fe_dropout_l0': 0.3791829682919363, 'fe_n_units_l1': 143, 'fe_dropout_l1': 0.41388791447329437, 'n_units_l(Invariant)': 79, 'n_layers_mlp': 2, 'mlp_n_units_l0': 202, 'mlp_dropout_l0': 0.4095562438360884, 'mlp_n_units_l1': 90, 'mlp_dropout_l1': 0.14060784988578262, 'reduction': 'sum', 'lr': 3.4537686310735177e-05, 'criterion': 'MSELoss', 'batch_size': 32, 'no_epochs': 88}. Best is trial 0 with value: 0.009935854782797349.[0m

Trial Id: 6 | Model params: 98259 | Timestamp: 2021-08-21 05:28:08.001497

epoch 0 -0.9553404974827737 34.58292022156632
epoch 5 -0.011319318164492387 24.871078418672155
epoch 10 -0.06735683981127072 25.550845975555585
epoch 15 -0.14448735215511976 26.45793614964677
epoch 20 -0.023466516361279277 25.019998809372947
epoch 25 0.011084002712243968 24.59405650075475
epoch 30 -0.008352403612360781 24.834569394014977
epoch 35 -0.03206871557863877 25.124924890264673
epoch 40 0.009958008486805281 24.608054093732022
[32m[I 2021-08-21 06:04:31,440][0m Trial 6 finished with value: -0.03643001518291489 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 188, 'fe_dropout_l0': 0.3291181137059717, 'fe_n_units_l1': 49, 'fe_dropout_l1': 0.29211898032848704, 'fe_n_units_l2': 97, 'fe_dropout_l2': 0.0630162301060081, 'fe_n_units_l3': 54, 'fe_dropout_l3': 0.30899626309758643, 'n_units_l(Invariant)': 67, 'n_layers_mlp': 2, 'mlp_n_units_l0': 229, 'mlp_dropout_l0': 0.3718422732373016, 'mlp_n_units_l1': 253, 'mlp_dropout_l1': 0.08610565176316048, 'reduction': 'sum', 'lr': 0.00015318043664587502, 'criterion': 'L1Loss', 'batch_size': 32, 'no_epochs': 43}. Best is trial 0 with value: 0.009935854782797349.[0m

Trial Id: 7 | Model params: 155996 | Timestamp: 2021-08-21 06:04:31.440754

[32m[I 2021-08-21 06:05:30,902][0m Trial 7 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 8 | Model params: 90754 | Timestamp: 2021-08-21 06:05:30.902560

[32m[I 2021-08-21 06:06:13,184][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 19092 | Timestamp: 2021-08-21 06:06:13.185035

[32m[I 2021-08-21 06:06:47,585][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 58212 | Timestamp: 2021-08-21 06:06:47.585791

epoch 0 -6.814571153806578 69.13580757387281
epoch 5 -20.127109936622023 113.67645230116305
epoch 10 -21.20353380035524 116.53637782621523
epoch 15 -23.208472035773987 121.68418977478804
epoch 20 -17.938225190716942 107.62671959751685
epoch 25 -14.882626075921804 98.5624796409343
epoch 30 -13.726160789078437 94.90634192978847
epoch 35 -13.873675428675627 95.38050451738916
epoch 40 -13.545272546194258 94.32165163355141
epoch 45 -13.133861289465868 92.97814506254657
epoch 50 -13.15158985541737 93.0364395570971
[32m[I 2021-08-21 06:32:21,918][0m Trial 10 finished with value: -12.82750839349922 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 52, 'fe_dropout_l0': 0.4698031380213378, 'fe_n_units_l1': 223, 'fe_dropout_l1': 0.4846212811120172, 'n_units_l(Invariant)': 18, 'n_layers_mlp': 4, 'mlp_n_units_l0': 150, 'mlp_dropout_l0': 0.31527931063799386, 'mlp_n_units_l1': 187, 'mlp_dropout_l1': 0.495309108407065, 'mlp_n_units_l2': 17, 'mlp_dropout_l2': 0.4906524255341772, 'mlp_n_units_l3': 26, 'mlp_dropout_l3': 0.01658831477416217, 'reduction': 'sum', 'lr': 0.0003321003972986103, 'criterion': 'L1Loss', 'batch_size': 256, 'no_epochs': 55}. Best is trial 0 with value: 0.009935854782797349.[0m

Trial Id: 11 | Model params: 256958 | Timestamp: 2021-08-21 06:32:21.918777

[32m[I 2021-08-21 06:33:56,296][0m Trial 11 pruned. [0m
epoch 0 -2.679182615643279 47.43797452070513

Trial Id: 12 | Model params: 209594 | Timestamp: 2021-08-21 06:33:56.296375

epoch 0 -1.9748912630672981 42.656578083722856
[32m[I 2021-08-21 06:38:20,188][0m Trial 12 pruned. [0m

Trial Id: 13 | Model params: 133892 | Timestamp: 2021-08-21 06:38:20.188570

[32m[I 2021-08-21 06:39:12,253][0m Trial 13 pruned. [0m
epoch 0 -2.417970811428696 45.72299181578453

Trial Id: 14 | Model params: 203723 | Timestamp: 2021-08-21 06:39:12.253199

epoch 0 -1.09026023930365 35.75614131418832
epoch 5 -0.008854802645669402 24.840755381120296
[32m[I 2021-08-21 06:51:44,284][0m Trial 14 pruned. [0m

Trial Id: 15 | Model params: 192226 | Timestamp: 2021-08-21 06:51:44.284428

[33m[W 2021-08-21 06:51:47,201][0m Trial 15 failed because of the following error: RuntimeError('CUDA out of memory. Tried to allocate 600.00 MiB (GPU 0; 7.93 GiB total capacity; 5.16 GiB already allocated; 382.06 MiB free; 5.54 GiB reserved in total by PyTorch)')
Traceback (most recent call last):
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 216, in _run_trial
    value_or_values = func(trial)
  File "hp_optim.py", line 260, in objective
    predictions = model(X1, X2, mask=mask)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/astrostatistics/models/deep_set/models.py", line 95, in forward
    y = self.feature_extractor(X1)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/functional.py", line 1298, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 600.00 MiB (GPU 0; 7.93 GiB total capacity; 5.16 GiB already allocated; 382.06 MiB free; 5.54 GiB reserved in total by PyTorch)[0m
Traceback (most recent call last):
  File "hp_optim.py", line 325, in <module>
    main()
  File "hp_optim.py", line 42, in main
    study.optimize(objective, n_trials=args['trials'], timeout=None)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/study.py", line 401, in optimize
    _optimize(
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 65, in _optimize
    _optimize_sequential(
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 162, in _optimize_sequential
    trial = _run_trial(study, func, catch)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 267, in _run_trial
    raise func_err
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/optuna/_optimize.py", line 216, in _run_trial
    value_or_values = func(trial)
  File "hp_optim.py", line 260, in objective
    predictions = model(X1, X2, mask=mask)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/astrostatistics/models/deep_set/models.py", line 95, in forward
    y = self.feature_extractor(X1)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1051, in _call_impl
    return forward_call(*input, **kwargs)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 102, in forward
    return F.relu(input, inplace=self.inplace)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/nn/functional.py", line 1298, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 600.00 MiB (GPU 0; 7.93 GiB total capacity; 5.16 GiB already allocated; 382.06 MiB free; 5.54 GiB reserved in total by PyTorch)
