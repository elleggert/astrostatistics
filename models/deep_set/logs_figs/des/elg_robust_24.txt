[32m[I 2022-02-24 20:00:12,586][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: elg
Training Set: 216623
Validation Set: 54158
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 135490 | Timestamp: 2022-02-24 20:00:12.586754

[32m[I 2022-02-24 20:01:24,424][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 157863 | Timestamp: 2022-02-24 20:01:24.424470

epoch 0 0.010961857638953965 7.1625732495483625
epoch 5 -0.036790716722331585 7.333446130142238
epoch 10 -0.011494199532145366 7.243429782582709
epoch 15 0.016918208368572496 7.140972856461114
epoch 20 0.013267100457341918 7.1542211434619265
epoch 25 0.006955254297221547 7.177066414095527
epoch 30 0.016229761513758434 7.143472811171298
epoch 35 -0.06134552506102198 7.419778706188193
epoch 40 0.013225939205402604 7.154370359946
epoch 45 0.007029556085706656 7.176797907138306
epoch 50 0.02021174424571437 7.129000921857613
epoch 55 0.003713998841801791 7.188769690592464
epoch 60 0.020312586462662652 7.12863404526353
epoch 65 -0.09162898882332304 7.524888794909419
epoch 70 0.017751271770225396 7.137946585404854
epoch 75 -0.013334989129323738 7.250017842770177
epoch 80 -0.003914150066942623 7.216237927363788
epoch 85 -0.034017770929570146 7.323632739949792
epoch 90 0.01169039434318031 7.159934747257395
epoch 95 0.02162480082406859 7.123858322784172
[32m[I 2022-02-24 21:46:52,272][0m Trial 1 finished with value: 7.14172443036133 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 192, 'fe_dropout_l0': 0.035564550533749184, 'fe_n_units_l1': 113, 'fe_dropout_l1': 0.10914545166468026, 'fe_n_units_l2': 11, 'fe_dropout_l2': 0.3681304924167602, 'fe_n_units_l3': 214, 'fe_dropout_l3': 0.3202942247496044, 'n_units_l(Invariant)': 364, 'n_layers_mlp': 2, 'mlp_n_units_l0': 208, 'mlp_dropout_l0': 0.09495002388707885, 'mlp_n_units_l1': 227, 'mlp_dropout_l1': 0.12762445098252334, 'reduction': 'sum', 'lr': 0.0017969780549899643, 'weight_decay': 0.17977080100210022, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 1 with value: 7.14172443036133.[0m

Trial Id: 2 | Model params: 145701 | Timestamp: 2022-02-24 21:46:52.272412

[32m[I 2022-02-24 21:47:33,241][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 83457 | Timestamp: 2022-02-24 21:47:33.241686

epoch 0 -0.28347964754531785 8.159377927213411
epoch 5 0.008877199862359464 7.170117778745275
epoch 10 0.012329396270337467 7.157619707591371
epoch 15 0.016798694161776262 7.141406910767134
epoch 20 0.004695657819758781 7.185227204055263
epoch 25 0.014664750109562807 7.149152579318923
epoch 30 0.016387581807100093 7.142899796178091
epoch 35 0.019194679853789864 7.132700074350424
epoch 40 0.014994682832011996 7.147955556854266
epoch 45 0.019346541749508006 7.132147861151574
epoch 50 0.018267661870853824 7.136070049744646
epoch 55 0.0168273883966078 7.141302700825166
epoch 60 0.016567217856157113 7.142247516446963
epoch 65 0.02120346951444474 7.1253920807350575
epoch 70 0.021777974109654763 7.123300649460957
epoch 75 0.022499095377863987 7.120674604204717
epoch 80 0.02109955911184891 7.12577029146998
epoch 85 0.022673760684574717 7.1200383948814405
epoch 90 0.0017106407650483435 7.195993744355958
epoch 95 0.021325738495086566 7.124947023152369
[32m[I 2022-02-24 23:37:24,982][0m Trial 3 finished with value: 7.226499952360812 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 98, 'fe_dropout_l0': 0.14882868414912942, 'fe_n_units_l1': 84, 'fe_dropout_l1': 0.0396462129546466, 'fe_n_units_l2': 93, 'fe_dropout_l2': 0.1264789072176879, 'fe_n_units_l3': 153, 'fe_dropout_l3': 0.30567230378214877, 'n_units_l(Invariant)': 242, 'n_layers_mlp': 2, 'mlp_n_units_l0': 183, 'mlp_dropout_l0': 0.025275090124624533, 'mlp_n_units_l1': 57, 'mlp_dropout_l1': 0.28837286481342783, 'reduction': 'sum', 'lr': 0.00012541107427785922, 'weight_decay': 0.1837099284740666, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 1 with value: 7.14172443036133.[0m

Trial Id: 4 | Model params: 49082 | Timestamp: 2022-02-24 23:37:24.982325

[32m[I 2022-02-24 23:37:54,333][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 115384 | Timestamp: 2022-02-24 23:37:54.333887

[32m[I 2022-02-24 23:38:32,117][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 69906 | Timestamp: 2022-02-24 23:38:32.117281

[32m[I 2022-02-24 23:39:28,774][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 266590 | Timestamp: 2022-02-24 23:39:28.774974

[32m[I 2022-02-24 23:40:51,018][0m Trial 7 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 8 | Model params: 129953 | Timestamp: 2022-02-24 23:40:51.018215

epoch 0 -14.806072762455152 28.633507091109724
epoch 5 -14.781391745668646 28.611142896880548
epoch 10 -14.769327739595557 28.600204983502238
epoch 15 -14.74399725701648 28.577225305287648
epoch 20 -14.76564187598707 28.596862335764914
epoch 25 -14.761981910169654 28.593542787644814
epoch 30 -14.735979639579973 28.569947914624528
epoch 35 -14.747578462237636 28.58047527693469
epoch 40 -14.76417931072478 28.595535851634136
epoch 45 -14.781495345814934 28.611236808551098
epoch 50 -14.737054222509398 28.570923394223474
epoch 55 -14.784278940204613 28.61375997143715
epoch 60 -14.74945034000493 28.582173873536142
epoch 65 -14.792309175277424 28.621037655857048
epoch 70 -14.771182676162532 28.601887046520673
epoch 75 -14.774796192911946 28.605163512229893
epoch 80 -14.764681494909922 28.5959913181454
epoch 85 -14.773902188083634 28.604352930707353
epoch 90 -14.76026516169452 28.59198558316508
epoch 95 -14.738452153921827 28.57219235167231
[32m[I 2022-02-25 01:54:41,436][0m Trial 8 finished with value: 28.592022269350636 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 161, 'fe_dropout_l0': 0.35310471338934435, 'fe_n_units_l1': 183, 'fe_dropout_l1': 0.22704922087326285, 'fe_n_units_l2': 155, 'fe_dropout_l2': 0.14308094738175792, 'fe_n_units_l3': 73, 'fe_dropout_l3': 0.1411339165367526, 'n_units_l(Invariant)': 354, 'n_layers_mlp': 4, 'mlp_n_units_l0': 11, 'mlp_dropout_l0': 0.3380521211472026, 'mlp_n_units_l1': 38, 'mlp_dropout_l1': 0.17800035525243613, 'mlp_n_units_l2': 127, 'mlp_dropout_l2': 0.058061858546419765, 'mlp_n_units_l3': 211, 'mlp_dropout_l3': 0.21580708939127452, 'reduction': 'sum', 'lr': 9.327830806860914e-05, 'weight_decay': 0.24677199520270443, 'criterion': 'PoissonNLLLoss', 'batch_size': 32}. Best is trial 1 with value: 7.14172443036133.[0m

Trial Id: 9 | Model params: 58453 | Timestamp: 2022-02-25 01:54:41.436255

[32m[I 2022-02-25 01:55:20,559][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 67138 | Timestamp: 2022-02-25 01:55:20.559952

epoch 0 -0.0037399414599472713 7.215611785527355
epoch 5 -0.002093828236745754 7.209692628939654
epoch 10 -0.03449664329730284 7.3253283971688825
epoch 15 0.007401485935813024 7.1754537002764875
epoch 20 -9.68203667062184e-06 7.202191398030822
epoch 25 -18.641872343238894 31.91934701111094
epoch 30 -0.0005203431848852524 7.204030085186512
epoch 35 -18.641872343238894 31.91934701111094
epoch 40 -18.641872343238894 31.91934701111094
epoch 45 -18.641872343238894 31.91934701111094
epoch 50 -18.641872343238894 31.91934701111094
epoch 55 -18.641872343238894 31.91934701111094
epoch 60 -18.641872343238894 31.91934701111094
epoch 65 -0.03707831563584918 7.3344631844347
epoch 70 -0.005016331009894293 7.220198135559129
epoch 75 -0.251705171098352 8.057746113252437
epoch 80 -18.641872343238894 31.91934701111094
epoch 85 -18.641872343238894 31.91934701111094
epoch 90 0.0011033575366945492 7.198182158906892
epoch 95 -0.023541413691292812 7.286437865529637
[32m[I 2022-02-25 02:50:42,390][0m Trial 10 finished with value: 7.238882443549546 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 93, 'fe_dropout_l0': 0.4855540741036019, 'fe_n_units_l1': 12, 'fe_dropout_l1': 0.09677512454864601, 'n_units_l(Invariant)': 495, 'n_layers_mlp': 2, 'mlp_n_units_l0': 256, 'mlp_dropout_l0': 0.22200314293641446, 'mlp_n_units_l1': 204, 'mlp_dropout_l1': 0.036700698622509964, 'reduction': 'sum', 'lr': 0.007961965636281052, 'weight_decay': 0.10922082725244994, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 1 with value: 7.14172443036133.[0m

Trial Id: 11 | Model params: 74212 | Timestamp: 2022-02-25 02:50:42.391053

epoch 0 -0.6393186018472974 9.22134434078185
epoch 5 -0.4690370844872205 8.729290284208172
epoch 10 -0.3953242603250804 8.507464171873243
epoch 15 -0.2577375629770613 8.077139281885355
epoch 20 -0.2178830067617421 7.948136948582071
epoch 25 -0.16896597867703989 7.786880178698224
epoch 30 -0.06694406891543458 7.439322445344213
epoch 35 -0.09698840165798561 7.543338106805595
epoch 40 -0.007956337646745304 7.230751162473936
epoch 45 0.008248829447652373 7.17239034072714
epoch 50 0.00931024796764468 7.168551199327714
epoch 55 0.007648062086760721 7.1745624005097115
epoch 60 0.011509732584579546 7.160589130907597
epoch 65 0.00569270117347509 7.181627411635361
epoch 70 0.009071909773405773 7.169413445453577
epoch 75 0.012297238178140879 7.157736231015287
epoch 80 0.01290077497483022 7.155549025768068
epoch 85 0.008512744442040754 7.171435954506316
epoch 90 0.013045005741020188 7.155026237382264
epoch 95 0.012041788525937958 7.158661774151466
[32m[I 2022-02-25 04:40:10,271][0m Trial 11 finished with value: 7.1551615389270244 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 87, 'fe_dropout_l0': 0.13245100719965086, 'fe_n_units_l1': 160, 'fe_dropout_l1': 0.03471333071889685, 'fe_n_units_l2': 31, 'fe_dropout_l2': 0.4963214125706983, 'fe_n_units_l3': 167, 'fe_dropout_l3': 0.4536343815422507, 'n_units_l(Invariant)': 194, 'n_layers_mlp': 2, 'mlp_n_units_l0': 165, 'mlp_dropout_l0': 0.0033055421913644467, 'mlp_n_units_l1': 76, 'mlp_dropout_l1': 0.1470186709712616, 'reduction': 'sum', 'lr': 1.0116891295524906e-05, 'weight_decay': 0.1270830184522152, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 1 with value: 7.14172443036133.[0m

Trial Id: 12 | Model params: 76740 | Timestamp: 2022-02-25 04:40:10.271786

epoch 0 -0.48472206688705377 8.775768086555061
epoch 5 -0.29109019096301925 8.183533167500487
epoch 10 -0.27553051819568863 8.134071453082935
epoch 15 -0.235893754764823 8.006692046070537
epoch 20 -0.5071017709018373 8.841660729184548
epoch 25 -0.7916139776130888 9.64017187760931
epoch 30 -0.8603167820319222 9.823268347746511
epoch 35 -1.03842953144853 10.282776760922246
epoch 40 -1.1258842843780443 10.50104130737498
epoch 45 -0.9704717966969851 10.109918806075212
epoch 50 -0.8104535591671704 9.69072457924758
epoch 55 -0.7170365714757094 9.437399261299818
epoch 60 -0.6053251355557367 9.125235030687524
epoch 65 -0.5612117194198565 8.99898354075184
epoch 70 -0.31543083213930534 8.260314154511919
epoch 75 -0.27437798642238964 8.130395769000023
epoch 80 -0.3298020565734201 8.305313995128548
epoch 85 -0.24723635828723411 8.043349449944143
epoch 90 -0.3032286110568687 8.221912660992736
epoch 95 -0.1591522822737821 7.75412510184387
[32m[I 2022-02-25 06:29:31,896][0m Trial 12 finished with value: 7.8110521534528194 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 80, 'fe_dropout_l0': 0.0050268031991159146, 'fe_n_units_l1': 173, 'fe_dropout_l1': 0.111840871295569, 'fe_n_units_l2': 12, 'fe_dropout_l2': 0.4898404352225906, 'fe_n_units_l3': 255, 'fe_dropout_l3': 0.4857118884468411, 'n_units_l(Invariant)': 157, 'n_layers_mlp': 2, 'mlp_n_units_l0': 147, 'mlp_dropout_l0': 0.09293094079528583, 'mlp_n_units_l1': 88, 'mlp_dropout_l1': 0.12565744076845894, 'reduction': 'sum', 'lr': 1.1803802743563672e-05, 'weight_decay': 0.1010558387981276, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 1 with value: 7.14172443036133.[0m

Trial Id: 13 | Model params: 120488 | Timestamp: 2022-02-25 06:29:31.896500

[32m[I 2022-02-25 06:30:34,200][0m Trial 13 pruned. [0m
epoch 0 0.004379435500395101 7.18636853775194

Trial Id: 14 | Model params: 93078 | Timestamp: 2022-02-25 06:30:34.200200

epoch 0 -0.3913285470001373 8.495274260152815
epoch 5 -0.2936606601866685 8.191675534566118
epoch 10 -0.2544109388421114 8.066450487243083
epoch 15 -0.15597333185424866 7.743485040417986
epoch 20 -0.11791061874706843 7.61493318057946
[32m[I 2022-02-25 06:57:02,250][0m Trial 14 pruned. [0m

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  9
  Number of complete trials:  6

Best trial:
  Value:  7.14172443036133
  Params: 
    n_layers_fe: 4
    fe_n_units_l0: 192
    fe_dropout_l0: 0.035564550533749184
    fe_n_units_l1: 113
    fe_dropout_l1: 0.10914545166468026
    fe_n_units_l2: 11
    fe_dropout_l2: 0.3681304924167602
    fe_n_units_l3: 214
    fe_dropout_l3: 0.3202942247496044
    n_units_l(Invariant): 364
    n_layers_mlp: 2
    mlp_n_units_l0: 208
    mlp_dropout_l0: 0.09495002388707885
    mlp_n_units_l1: 227
    mlp_dropout_l1: 0.12762445098252334
    reduction: sum
    lr: 0.0017969780549899643
    weight_decay: 0.17977080100210022
    criterion: MSELoss
    batch_size: 128
Target: 67698, NaN: 0, Max: 114.0, Min: 8.0, Mean: 31.138955360571952
Prediction: 67698, NaN: 0, Max: 33.657066345214844, Min: 27.21451759338379, Mean: 30.62805486561477

 XXXXXX======== TRIAL des - elg ended

Test Set - R-squared:  0.015241335484258434
Test Set - RMSE:  7.157147370439337
Test Set - MAE:  5.661836191950642



./hp_optim.sh: line 11: e: command not found
