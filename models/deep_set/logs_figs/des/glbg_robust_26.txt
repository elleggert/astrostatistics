[32m[I 2022-02-26 18:27:09,085][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: glbg
Training Set: 216623
Validation Set: 54158
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 25

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 110034 | Timestamp: 2022-02-26 18:27:09.086277

[32m[I 2022-02-26 18:28:12,312][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 87376 | Timestamp: 2022-02-26 18:28:12.312922

[32m[I 2022-02-26 18:29:36,264][0m Trial 1 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 2 | Model params: 57949 | Timestamp: 2022-02-26 18:29:36.265050

[32m[I 2022-02-26 18:30:26,773][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 143484 | Timestamp: 2022-02-26 18:30:26.773257

epoch 0 -0.4661886809542619 11.546891974190666
epoch 5 -0.22711925720265436 10.563639148925374
epoch 10 -0.29751800204654 10.862426920726554
epoch 15 -0.43174040084989707 11.410437898347404
epoch 20 -0.5711972811312502 11.95323701729995
epoch 25 -0.6594361528281882 12.28430088782491
epoch 30 -0.8629885488970481 13.015931800296451
epoch 35 -1.1784554547259711 14.074873931264671
epoch 40 -1.1781287622036882 14.07381852100617
epoch 45 -0.9828318338457245 13.428055049741769
epoch 50 -0.9861769956923405 13.439377262579846
epoch 55 -0.9180584348187972 13.20690605792225
epoch 60 -0.7670564285283599 12.676383830372394
epoch 65 -0.9065784532354813 13.167323691983384
epoch 70 -0.6849342940983345 12.378318596759739
epoch 75 -0.550098829213387 11.872710158367024
epoch 80 -0.446720059867451 11.469973731764153
epoch 85 -0.3246483509268092 10.975402933665142
epoch 90 -0.3989613401330723 11.279063148426896
epoch 95 -0.27614656501011114 10.772597898799416
[32m[I 2022-02-26 20:02:09,193][0m Trial 3 finished with value: 10.935077228433947 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 244, 'fe_dropout_l0': 0.35423346447803966, 'fe_n_units_l1': 256, 'fe_dropout_l1': 0.2863508917831649, 'n_units_l(Invariant)': 251, 'n_layers_mlp': 2, 'mlp_n_units_l0': 64, 'mlp_dropout_l0': 0.09207368479284189, 'mlp_n_units_l1': 198, 'mlp_dropout_l1': 0.35577519130896934, 'reduction': 'sum', 'lr': 1.1169418277384579e-05, 'weight_decay': 0.26344991320195554, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 3 with value: 10.935077228433947.[0m

Trial Id: 4 | Model params: 104889 | Timestamp: 2022-02-26 20:02:09.193203

[32m[I 2022-02-26 20:03:22,330][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 44550 | Timestamp: 2022-02-26 20:03:22.330793

[32m[I 2022-02-26 20:03:46,968][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 141034 | Timestamp: 2022-02-26 20:03:46.968984

[32m[I 2022-02-26 20:05:04,469][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 43081 | Timestamp: 2022-02-26 20:05:04.469545

epoch 0 -7.63164712829659 28.01670197746195
epoch 5 -7.595900290508569 27.958628034978048
epoch 10 -7.527251907201906 27.846762964185007
epoch 15 -7.490273394508762 27.786318481207417
epoch 20 -7.554134317182916 27.89062229005506
epoch 25 -7.506994004929503 27.813665991923088
epoch 30 -7.573856239630198 27.92275529086943
epoch 35 -7.550350321484148 27.884452778047038
epoch 40 -7.541389505265974 27.86983741450928
epoch 45 -7.5432815061300715 27.87292396364294
epoch 50 -7.527429360378719 27.84705270998457
epoch 55 -7.527899798680545 27.84782082772326
epoch 60 -7.5039471416889505 27.80868467738247
epoch 65 -7.549763945684994 27.88349661555036
epoch 70 -7.527597325691557 27.84732696120907
epoch 75 -7.5191770781838 27.83357518052087
epoch 80 -7.541469204903429 27.86996744082145
epoch 85 -7.522903874613721 27.839662548215724
epoch 90 -7.534068653890904 27.857891192230927
epoch 95 -7.548089774304424 27.88076647950273
[32m[I 2022-02-26 20:50:40,536][0m Trial 7 finished with value: 27.843333970156927 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 83, 'fe_dropout_l0': 0.398340921013219, 'fe_n_units_l1': 93, 'fe_dropout_l1': 0.14649101589477131, 'n_units_l(Invariant)': 161, 'n_layers_mlp': 2, 'mlp_n_units_l0': 242, 'mlp_dropout_l0': 0.33516330826942337, 'mlp_n_units_l1': 57, 'mlp_dropout_l1': 0.008529189846333163, 'reduction': 'sum', 'lr': 0.0009163971379402402, 'weight_decay': 0.1315336408742168, 'criterion': 'PoissonNLLLoss', 'batch_size': 256}. Best is trial 3 with value: 10.935077228433947.[0m

Trial Id: 8 | Model params: 77204 | Timestamp: 2022-02-26 20:50:40.536809

epoch 0 -0.3207876586274192 10.959397337748225
epoch 5 -0.024208838265311394 9.650824792637671
epoch 10 0.094541679897725 9.074117602196306
epoch 15 0.09308137384797088 9.081431936884366
epoch 20 0.08792168768270658 9.107228563239014
epoch 25 0.06367125694270792 9.227506277640638
epoch 30 0.06406559736450812 9.225562963420765
epoch 35 0.03905107932435492 9.348034860597908
epoch 40 0.04869419962284516 9.301012842093254
epoch 45 0.050358117995235374 9.292875133194412
epoch 50 0.008452357533195731 9.495699549139454
epoch 55 0.0335080877031092 9.374956984412387
epoch 60 -0.011127910280429365 9.588997841049814
epoch 65 -0.004130683777839206 9.555761257939682
epoch 70 -0.019650027439256812 9.629322658677976
epoch 75 0.0035342255067899453 9.519220021186257
epoch 80 -0.001635458864327477 9.54388102905872
epoch 85 -0.05249819466775185 9.78319818492793
epoch 90 -0.04150774888954256 9.731984854135206
epoch 95 -0.06493031309977604 9.840808175743282
[32m[I 2022-02-26 22:24:08,593][0m Trial 8 finished with value: 9.717631021411892 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 24, 'fe_dropout_l0': 0.25286001735380137, 'fe_n_units_l1': 184, 'fe_dropout_l1': 0.4885451766468665, 'n_units_l(Invariant)': 289, 'n_layers_mlp': 2, 'mlp_n_units_l0': 73, 'mlp_dropout_l0': 0.20392252500910107, 'mlp_n_units_l1': 227, 'mlp_dropout_l1': 0.2335854374255723, 'reduction': 'sum', 'lr': 6.965639852252371e-05, 'weight_decay': 0.04442037724123039, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 8 with value: 9.717631021411892.[0m

Trial Id: 9 | Model params: 102294 | Timestamp: 2022-02-26 22:24:08.593992

epoch 0 -1.016979359702789 13.543187733288569
epoch 5 -0.6248329754247266 12.155547753367925
epoch 10 -0.3937992660128171 11.258234420816844
epoch 15 -0.10442186536498421 10.02161396825226
epoch 20 -0.03691790593017141 9.710517129410006
epoch 25 -0.043719341013457313 9.742312077974333
epoch 30 -0.018309426556967878 9.622990425068604
epoch 35 0.014150081151152905 9.468377705202192
epoch 40 0.0035174770343723294 9.519300019781351
epoch 45 -0.002935752287939186 9.550073811431172
epoch 50 -0.00871174595967572 9.577534181731757
epoch 55 -0.0014912817306718118 9.543194123000037
epoch 60 0.017691892371233586 9.451354129898656
epoch 65 0.015896428783846228 9.459987783074023
epoch 70 0.03364222981836995 9.374306373588315
epoch 75 0.01921522331591541 9.444022862731575
epoch 80 0.029106903568856257 9.396278448598519
epoch 85 0.005296051813040048 9.510800950291298
epoch 90 0.005365577956393919 9.51046855949974
epoch 95 0.013106775953029892 9.473386477501423
[32m[I 2022-02-27 00:22:06,123][0m Trial 9 finished with value: 9.425124579623345 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 38, 'fe_dropout_l0': 0.3231704013357846, 'fe_n_units_l1': 219, 'fe_dropout_l1': 0.43954829403236734, 'fe_n_units_l2': 216, 'fe_dropout_l2': 0.0004965583982693977, 'fe_n_units_l3': 19, 'fe_dropout_l3': 0.1269698749636654, 'n_units_l(Invariant)': 51, 'n_layers_mlp': 4, 'mlp_n_units_l0': 49, 'mlp_dropout_l0': 0.23845134417454866, 'mlp_n_units_l1': 98, 'mlp_dropout_l1': 0.2747673731520218, 'mlp_n_units_l2': 218, 'mlp_dropout_l2': 0.4351135811178252, 'mlp_n_units_l3': 60, 'mlp_dropout_l3': 0.4186365545000669, 'reduction': 'sum', 'lr': 1.6154855695164182e-05, 'weight_decay': 0.07303831513406984, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 9 with value: 9.425124579623345.[0m

Trial Id: 10 | Model params: 43043 | Timestamp: 2022-02-27 00:22:06.123723

epoch 0 -1.6362668422917435 15.483347297541085
epoch 5 -3.222845357826377 19.596240484865877
epoch 10 -3.7388055537715283 20.758913345358664
epoch 15 -3.9687299177478907 21.25655432353773
epoch 20 -3.8327434659040094 20.96365687797568
epoch 25 -3.3166597899479715 19.81271911332619
epoch 30 -2.211438928522729 17.08913203989383
epoch 35 -0.5226501721249341 11.767121550384111
epoch 40 -0.08298828774064049 9.923892509230201
epoch 45 -0.05747994403183343 9.806324070512654
epoch 50 -0.04955980461006204 9.769532154657435
epoch 55 -0.05302401080941088 9.785641667119998
epoch 60 -0.06482441832160957 9.840318887339562
epoch 65 -0.05450153029942917 9.79250447743882
epoch 70 -0.05018099789303476 9.772422828454603
epoch 75 -0.052326873080435155 9.782401916933223
epoch 80 -0.040623326288498296 9.727851896221042
epoch 85 -0.04360451045796143 9.741776136061663
epoch 90 -0.03557857772209827 9.704243840181404
epoch 95 -0.027905444480716968 9.668225133975584
[32m[I 2022-02-27 01:10:57,780][0m Trial 10 finished with value: 9.678723501868548 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 74, 'fe_dropout_l0': 0.12415266761096069, 'fe_n_units_l1': 13, 'fe_dropout_l1': 0.49761641584894073, 'fe_n_units_l2': 255, 'fe_dropout_l2': 0.4616190132254351, 'fe_n_units_l3': 19, 'fe_dropout_l3': 0.009812307510372154, 'n_units_l(Invariant)': 20, 'n_layers_mlp': 4, 'mlp_n_units_l0': 12, 'mlp_dropout_l0': 0.25275305034025586, 'mlp_n_units_l1': 102, 'mlp_dropout_l1': 0.4891918112471667, 'mlp_n_units_l2': 251, 'mlp_dropout_l2': 0.4972551110530694, 'mlp_n_units_l3': 21, 'mlp_dropout_l3': 0.3265401501408103, 'reduction': 'sum', 'lr': 1.2313344843143423e-05, 'weight_decay': 0.058856179256330805, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 9 with value: 9.425124579623345.[0m

Trial Id: 11 | Model params: 40458 | Timestamp: 2022-02-27 01:10:57.781192

epoch 0 -2.3495170989847853 17.452645655673287
epoch 5 -2.581686552586875 18.04737156473988
epoch 10 -2.871611051999574 18.763594208720694
epoch 15 -2.876572476012498 18.775613022072193
epoch 20 -2.224950349986304 17.12504368519195
epoch 25 -0.8486069896648702 12.96559545951621
epoch 30 -0.20752265747509901 10.478951151058816
epoch 35 -0.13613145296736362 10.164463558914363
epoch 40 -0.13269973063298535 10.14910090143142
epoch 45 -0.11940296057547917 10.089354860791603
epoch 50 -0.11626312439469833 10.075195005953121
epoch 55 -0.10189884219751377 10.010160364277965
epoch 60 -0.1155981651117457 10.072193656030898
epoch 65 -0.11298207052459408 10.060377001098804
epoch 70 -0.10638676177599726 10.030524821692598
epoch 75 -0.1075915497996427 10.035984652069825
epoch 80 -0.10094669941051682 10.005834576169523
epoch 85 -0.09151441606213417 9.962880234494994
epoch 90 -0.10962189081440799 10.045178989873927
epoch 95 -0.10729724506042948 10.03465120289375
[32m[I 2022-02-27 01:58:11,102][0m Trial 11 finished with value: 9.96220850346647 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 76, 'fe_dropout_l0': 0.11429002975553286, 'fe_n_units_l1': 13, 'fe_dropout_l1': 0.49233493440920223, 'fe_n_units_l2': 245, 'fe_dropout_l2': 0.4461149542012699, 'fe_n_units_l3': 12, 'fe_dropout_l3': 0.005108530328664179, 'n_units_l(Invariant)': 13, 'n_layers_mlp': 4, 'mlp_n_units_l0': 8, 'mlp_dropout_l0': 0.2588418007807734, 'mlp_n_units_l1': 111, 'mlp_dropout_l1': 0.4561916616888651, 'mlp_n_units_l2': 256, 'mlp_dropout_l2': 0.49594405582608114, 'mlp_n_units_l3': 10, 'mlp_dropout_l3': 0.3260530003066439, 'reduction': 'sum', 'lr': 1.896498019207341e-05, 'weight_decay': 0.06590083078248785, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 9 with value: 9.425124579623345.[0m

Trial Id: 12 | Model params: 54530 | Timestamp: 2022-02-27 01:58:11.102592

[32m[I 2022-02-27 01:58:43,651][0m Trial 12 pruned. [0m
epoch 0 -0.9009972006229803 13.148036779965127

Trial Id: 13 | Model params: 96067 | Timestamp: 2022-02-27 01:58:43.651605

[32m[I 2022-02-27 01:59:35,372][0m Trial 13 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 14 | Model params: 83039 | Timestamp: 2022-02-27 01:59:35.373016

[32m[I 2022-02-27 02:00:12,116][0m Trial 14 pruned. [0m
epoch 0 -0.5372898886616639 11.823554483629248

Trial Id: 15 | Model params: 75831 | Timestamp: 2022-02-27 02:00:12.116349

[32m[I 2022-02-27 02:00:49,836][0m Trial 15 pruned. [0m
epoch 0 0.016155872000143456 9.458740713400205

Trial Id: 16 | Model params: 70924 | Timestamp: 2022-02-27 02:00:49.836396

epoch 0 -3.979753088887956 21.280120187120335
epoch 5 -3.188200627496557 19.51568997823178
epoch 10 -3.089673796629625 19.28477188547235
epoch 15 -2.895157376047115 18.82056583424837
epoch 20 -2.7377899152677805 18.436463401399273
epoch 25 -2.424522806794844 17.646972262785372
epoch 30 -2.067000779124746 16.700409286574818
epoch 35 -1.948594316123847 16.374863319843467
epoch 40 -1.8353787858249446 16.05741805805936
epoch 45 -1.7461088550525439 15.802618144523626
epoch 50 -1.5726087408119125 15.295266277117326
epoch 55 -1.5622999071521018 15.264590288795121
epoch 60 -1.4573808448932626 14.948802562783396
epoch 65 -1.5044444139212487 15.091272811898191
epoch 70 -1.3373800892718406 14.579238538785273
epoch 75 -1.3705908758528245 14.682448151663362
epoch 80 -1.3332556398098712 14.566369882420378
epoch 85 -1.2398170711437255 14.271724279205642
epoch 90 -1.206085487289673 14.163850706465666
epoch 95 -1.2175071628010938 14.200468973682424
[32m[I 2022-02-27 03:59:29,104][0m Trial 16 finished with value: 14.277813293792988 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 50, 'fe_dropout_l0': 0.0754772628106162, 'fe_n_units_l1': 135, 'fe_dropout_l1': 0.4969679294549064, 'fe_n_units_l2': 187, 'fe_dropout_l2': 0.17009793820620758, 'fe_n_units_l3': 80, 'fe_dropout_l3': 0.009931976475999405, 'n_units_l(Invariant)': 167, 'n_layers_mlp': 4, 'mlp_n_units_l0': 27, 'mlp_dropout_l0': 0.10308092859413845, 'mlp_n_units_l1': 182, 'mlp_dropout_l1': 0.4136230269693336, 'mlp_n_units_l2': 8, 'mlp_dropout_l2': 0.49745066255526543, 'mlp_n_units_l3': 239, 'mlp_dropout_l3': 0.0050518785909301755, 'reduction': 'sum', 'lr': 1.0755627886647783e-05, 'weight_decay': 0.10297002232796072, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 9 with value: 9.425124579623345.[0m

Trial Id: 17 | Model params: 197069 | Timestamp: 2022-02-27 03:59:29.104605

[32m[I 2022-02-27 04:00:42,437][0m Trial 17 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 18 | Model params: 63700 | Timestamp: 2022-02-27 04:00:42.438072

[32m[I 2022-02-27 04:01:27,600][0m Trial 18 pruned. [0m
epoch 0 -0.8659068121307878 13.026122161366695

Trial Id: 19 | Model params: 160253 | Timestamp: 2022-02-27 04:01:27.600611

[32m[I 2022-02-27 04:02:39,618][0m Trial 19 pruned. [0m
epoch 0 -0.0074150325759871905 9.571376173422744

Trial Id: 20 | Model params: 49500 | Timestamp: 2022-02-27 04:02:39.618563

epoch 0 -3.77216497129801 20.83185269435204
epoch 5 -0.01829190668633185 9.622907643613308
epoch 10 0.05088783240090722 9.290282968415912
epoch 15 0.054265403789451216 9.273737737372599
epoch 20 0.07143511963110538 9.189170265971947
epoch 25 0.0621662689122946 9.234919117801294
epoch 30 0.07763671443392128 9.158433059940977
epoch 35 0.0709725708052964 9.19145869557833
epoch 40 0.059873575560543735 9.246200388995915
epoch 45 0.07172726584041278 9.187724598304335
epoch 50 0.08096432227643235 9.14189770418653
epoch 55 0.06869884515739788 9.202699528327752
epoch 60 0.10097659835973105 9.041816103800521
epoch 65 0.08119632818070166 9.140743718454956
epoch 70 0.0902371493906805 9.095661113809317
epoch 75 0.10150160416545995 9.03917562793862
epoch 80 0.08834710483090402 9.105104390877166
epoch 85 0.0953538410365059 9.07004712273026
epoch 90 0.09602817453068146 9.06666603460481
epoch 95 0.10060040859171515 9.043707646859335
[32m[I 2022-02-27 06:01:12,405][0m Trial 20 finished with value: 9.120093968747884 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 44, 'fe_dropout_l0': 0.25884564706778246, 'fe_n_units_l1': 26, 'fe_dropout_l1': 0.4521847551496266, 'fe_n_units_l2': 131, 'fe_dropout_l2': 0.167566286088571, 'fe_n_units_l3': 123, 'fe_dropout_l3': 0.30169015859647075, 'n_units_l(Invariant)': 130, 'n_layers_mlp': 4, 'mlp_n_units_l0': 37, 'mlp_dropout_l0': 0.22600091563267086, 'mlp_n_units_l1': 22, 'mlp_dropout_l1': 0.4978760377147125, 'mlp_n_units_l2': 158, 'mlp_dropout_l2': 0.0033075024582610024, 'mlp_n_units_l3': 42, 'mlp_dropout_l3': 0.3458367639509633, 'reduction': 'sum', 'lr': 0.00014553858586568378, 'weight_decay': 0.20049865047593457, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 20 with value: 9.120093968747884.[0m

Trial Id: 21 | Model params: 45440 | Timestamp: 2022-02-27 06:01:12.405725

[32m[I 2022-02-27 06:02:23,150][0m Trial 21 pruned. [0m
epoch 0 0.017436665018097375 9.45258189510284

Trial Id: 22 | Model params: 44253 | Timestamp: 2022-02-27 06:02:23.150725

[32m[I 2022-02-27 06:03:32,908][0m Trial 22 pruned. [0m
epoch 0 0.006510165898464537 9.5049948392694

Trial Id: 23 | Model params: 62804 | Timestamp: 2022-02-27 06:03:32.908878

[32m[I 2022-02-27 06:04:43,850][0m Trial 23 pruned. [0m
epoch 0 -1.4090375911080377 14.801030721579917

Trial Id: 24 | Model params: 89576 | Timestamp: 2022-02-27 06:04:43.850261

[32m[I 2022-02-27 06:05:55,346][0m Trial 24 pruned. [0m
epoch 0 -1.5211152101278191 15.141416918572366

Study statistics: 
  Number of finished trials:  25
  Number of pruned trials:  17
  Number of complete trials:  8

Best trial:
  Value:  9.120093968747884
  Params: 
    n_layers_fe: 4
    fe_n_units_l0: 44
    fe_dropout_l0: 0.25884564706778246
    fe_n_units_l1: 26
    fe_dropout_l1: 0.4521847551496266
    fe_n_units_l2: 131
    fe_dropout_l2: 0.167566286088571
    fe_n_units_l3: 123
    fe_dropout_l3: 0.30169015859647075
    n_units_l(Invariant): 130
    n_layers_mlp: 4
    mlp_n_units_l0: 37
    mlp_dropout_l0: 0.22600091563267086
    mlp_n_units_l1: 22
    mlp_dropout_l1: 0.4978760377147125
    mlp_n_units_l2: 158
    mlp_dropout_l2: 0.0033075024582610024
    mlp_n_units_l3: 42
    mlp_dropout_l3: 0.3458367639509633
    reduction: sum
    lr: 0.00014553858586568378
    weight_decay: 0.20049865047593457
    criterion: MSELoss
    batch_size: 32
Target: 67698, NaN: 0, Max: 122.0, Min: 3.0, Mean: 29.60905787467872
Prediction: 67698, NaN: 0, Max: 38.514381408691406, Min: 26.429519653320312, Mean: 28.521824315307857

 XXXXXX======== TRIAL des - glbg ended

Test Set - R-squared:  0.08476069965187527
Test Set - RMSE:  9.110390147953998
Test Set - MAE:  6.990437902887659



