[32m[I 2022-02-26 18:27:12,029][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: qso
Training Set: 216623
Validation Set: 54158
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 25

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 62706 | Timestamp: 2022-02-26 18:27:12.030607

[32m[I 2022-02-26 18:27:48,839][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 89535 | Timestamp: 2022-02-26 18:27:48.840106

epoch 0 -2.9165091586330134 3.929495144111461
epoch 5 -1.235218075079671 2.9685689018172288
epoch 10 -1.2167344721569355 2.9562694858969594
epoch 15 -1.207935429127859 2.950396385789283
epoch 20 -1.219810196534164 2.958319690465533
epoch 25 -1.1911377774836187 2.939151864974252
epoch 30 -1.1942805955172813 2.9412589687913475
epoch 35 -1.1886832460101662 2.9375051720259333
epoch 40 -1.178257415851331 2.9305003921012327
epoch 45 -1.2238711751997382 2.9610244675802875
epoch 50 -1.1885349526380922 2.9374056555867276
epoch 55 -1.1779043124458863 2.930262860118338
epoch 60 -1.1919360483601875 2.9396872091466624
epoch 65 -1.1976868122906592 2.943540965149235
epoch 70 -1.191747043250626 2.939560465512579
epoch 75 -1.2077175807045988 2.950250830116077
epoch 80 -1.2003063531293154 2.9452947249176344
epoch 85 -1.191814938802601 2.9396059957518794
epoch 90 -1.188133098733036 2.937135963269739
epoch 95 -1.1951044901798915 2.9418110996681364
[32m[I 2022-02-26 20:17:15,281][0m Trial 1 finished with value: 2.9391763938766573 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 196, 'fe_dropout_l0': 0.4425843978515922, 'fe_n_units_l1': 250, 'fe_dropout_l1': 0.1138198929824571, 'n_units_l(Invariant)': 4, 'n_layers_mlp': 4, 'mlp_n_units_l0': 120, 'mlp_dropout_l0': 0.4023800759553955, 'mlp_n_units_l1': 56, 'mlp_dropout_l1': 0.049474754323870995, 'mlp_n_units_l2': 235, 'mlp_dropout_l2': 0.1306151985401578, 'mlp_n_units_l3': 64, 'mlp_dropout_l3': 0.48486349534141465, 'reduction': 'sum', 'lr': 1.699435083905281e-05, 'weight_decay': 0.009590657666469193, 'criterion': 'PoissonNLLLoss', 'batch_size': 32}. Best is trial 1 with value: 2.9391763938766573.[0m

Trial Id: 2 | Model params: 46591 | Timestamp: 2022-02-26 20:17:15.281525

[32m[I 2022-02-26 20:17:49,959][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 66382 | Timestamp: 2022-02-26 20:17:49.960111

[32m[I 2022-02-26 20:18:49,549][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 114143 | Timestamp: 2022-02-26 20:18:49.549978

[32m[I 2022-02-26 20:19:48,081][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 156289 | Timestamp: 2022-02-26 20:19:48.081990

[32m[I 2022-02-26 20:20:49,887][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 245056 | Timestamp: 2022-02-26 20:20:49.887577

epoch 0 -1.238373622415113 2.970663586899469
epoch 5 -1.2527563836905147 2.980192364720522
epoch 10 -1.238631744622348 2.9708348657533485
epoch 15 -1.205520482809634 2.9487824350073524
epoch 20 -1.2219908868253073 2.9597724262540654
epoch 25 -1.2302808253813624 2.9652885354518452
epoch 30 -1.251664589899001 2.979470105120697
epoch 35 -1.2480142187315177 2.9770539851819287
epoch 40 -1.2577141088634267 2.983469872840442
epoch 45 -1.2504887423650173 2.9786920451709435
epoch 50 -1.250885285721306 2.9789544611722634
epoch 55 -1.2519327416830275 2.979647513079747
epoch 60 -1.25384180152833 2.9809102329351322
epoch 65 -1.2540026138746994 2.98101657549611
epoch 70 -1.2521537601080555 2.9797937298895087
epoch 75 -1.264838343175744 2.988173346417288
epoch 80 -1.254396755291057 2.981277198693499
epoch 85 -1.247710809436541 2.9768530753471043
epoch 90 -1.2516234829962194 2.979442908053359
epoch 95 -1.2535617491263662 2.980725029828974
[32m[I 2022-02-26 22:37:34,033][0m Trial 6 finished with value: 2.9800234218461426 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 240, 'fe_dropout_l0': 0.1497661804069379, 'fe_n_units_l1': 252, 'fe_dropout_l1': 0.03631502994692554, 'n_units_l(Invariant)': 484, 'n_layers_mlp': 4, 'mlp_n_units_l0': 59, 'mlp_dropout_l0': 0.16315756265503717, 'mlp_n_units_l1': 202, 'mlp_dropout_l1': 0.13059936360627694, 'mlp_n_units_l2': 123, 'mlp_dropout_l2': 0.4198583534144568, 'mlp_n_units_l3': 172, 'mlp_dropout_l3': 0.28722237892311336, 'reduction': 'sum', 'lr': 4.223298452054916e-05, 'weight_decay': 0.17962807654356275, 'criterion': 'PoissonNLLLoss', 'batch_size': 128}. Best is trial 1 with value: 2.9391763938766573.[0m

Trial Id: 7 | Model params: 95693 | Timestamp: 2022-02-26 22:37:34.034135

[32m[I 2022-02-26 22:38:07,989][0m Trial 7 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 8 | Model params: 150976 | Timestamp: 2022-02-26 22:38:07.989492

[32m[I 2022-02-26 22:39:21,600][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 167081 | Timestamp: 2022-02-26 22:39:21.601045

[32m[I 2022-02-26 22:40:20,221][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 25236 | Timestamp: 2022-02-26 22:40:20.221536

epoch 0 0.01133493860682111 1.9742937769381086
epoch 5 0.01881748870722011 1.966808527260145
epoch 10 0.01981464726063631 1.965808856727385
epoch 15 0.022650026305666593 1.962963553080572
epoch 20 0.00714232998560449 1.9784755188158047
epoch 25 0.022560136224029415 1.9630538211021507
epoch 30 0.019501828266820675 1.9661225184706028
epoch 35 0.013428973962160029 1.9722018488529791
epoch 40 0.02240988333771221 1.9632046964548215
epoch 45 0.016205274622669963 1.9694249160894408
epoch 50 0.010934363148864312 1.97469369677638
epoch 55 0.008744965120429216 1.9768780819188227
epoch 60 0.019298075162541006 1.966326793587231
epoch 65 0.0190151022456313 1.9666104562796116
epoch 70 0.02284776245689646 1.9627649709437403
epoch 75 0.018019630015501886 1.9676080300947512
epoch 80 0.012990266210818113 1.9726402988228542
epoch 85 0.012225072755716715 1.9734048095220103
epoch 90 0.010486876589226535 1.9751403551832003
epoch 95 0.016868064934286497 1.9687613957204821
[32m[I 2022-02-27 00:14:32,918][0m Trial 10 finished with value: 1.9672123627224223 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 48, 'fe_dropout_l0': 0.49070176490588463, 'fe_n_units_l1': 248, 'fe_dropout_l1': 0.03430787701741386, 'n_units_l(Invariant)': 3, 'n_layers_mlp': 2, 'mlp_n_units_l0': 153, 'mlp_dropout_l0': 0.4886999628498784, 'mlp_n_units_l1': 55, 'mlp_dropout_l1': 0.41443086644059435, 'reduction': 'sum', 'lr': 0.006881569219240025, 'weight_decay': 0.02122159987316228, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 10 with value: 1.9672123627224223.[0m

Trial Id: 11 | Model params: 16988 | Timestamp: 2022-02-27 00:14:32.918223

epoch 0 0.02354384430945411 1.962065751095959
epoch 5 0.019345594066951688 1.9662791548376464
epoch 10 0.019898075036163587 1.965725195739456
epoch 15 0.01611175453013003 1.96951852119769
epoch 20 0.024168107574661257 1.9614384615892089
epoch 25 0.022857851477868008 1.9627548382196325
epoch 30 0.023799698978253514 1.9618086803772636
epoch 35 0.02762666024287408 1.9579595018932463
epoch 40 0.02289779853913043 1.962714717603997
epoch 45 0.026251423268819685 1.9593435931677459
epoch 50 0.01930017951797469 1.9663246839489263
epoch 55 0.02795558326308667 1.9576283161241586
epoch 60 0.023318124272243446 1.9622925159950044
epoch 65 0.02591863652001536 1.9596783756254135
epoch 70 0.021091009683331774 1.9645285366887963
epoch 75 0.020249712337093828 1.965372536340339
epoch 80 0.021895449528472888 1.963721173669507
epoch 85 0.019590408859010977 1.9660337043168798
epoch 90 0.024624384858917603 1.9609798454783154
epoch 95 0.028109580774347886 1.9574732399647718
[32m[I 2022-02-27 01:48:15,116][0m Trial 11 finished with value: 1.9574306274178244 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 9, 'fe_dropout_l0': 0.4799840597123655, 'fe_n_units_l1': 244, 'fe_dropout_l1': 0.019574559005533593, 'n_units_l(Invariant)': 9, 'n_layers_mlp': 2, 'mlp_n_units_l0': 154, 'mlp_dropout_l0': 0.49856485454659405, 'mlp_n_units_l1': 56, 'mlp_dropout_l1': 0.45538781425864444, 'reduction': 'sum', 'lr': 0.005544184180774864, 'weight_decay': 0.008298229989336776, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 11 with value: 1.9574306274178244.[0m

Trial Id: 12 | Model params: 20939 | Timestamp: 2022-02-27 01:48:15.116871

epoch 0 0.023742090931085702 1.9618665651677032
epoch 5 0.028386331961912425 1.9571945194403522
epoch 10 0.02703922894727373 1.9585508349658212
epoch 15 0.027715706799492423 1.9578698482919612
epoch 20 0.017328469045524764 1.9683003528259562
epoch 25 0.02625134494905379 1.9593436719639217
epoch 30 0.02069599216212603 1.9649248681810645
epoch 35 0.028682597125338716 1.956896102084803
epoch 40 0.015524151179678425 1.9701065569563527
epoch 45 0.022905016387847477 1.9627074683090677
epoch 50 0.02596957640875097 1.959627133959525
epoch 55 0.02147359196792198 1.964144605560905
epoch 60 0.028227786112780096 1.9573541983433522
epoch 65 0.024952118350152652 1.9606503658623033
epoch 70 0.024946288263929195 1.960656227494237
epoch 75 0.026791432737908294 1.9588002235282325
epoch 80 0.021635728401126264 1.9639818748513076
epoch 85 0.025444456911758007 1.9601553000893899
epoch 90 0.02385511907035509 1.9617529924406918
epoch 95 0.021179617027263564 1.9644396236250177
[32m[I 2022-02-27 03:22:23,877][0m Trial 12 finished with value: 1.9588666125062875 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 9, 'fe_dropout_l0': 0.4758502991279626, 'fe_n_units_l1': 227, 'fe_dropout_l1': 0.03786251455077533, 'n_units_l(Invariant)': 7, 'n_layers_mlp': 2, 'mlp_n_units_l0': 162, 'mlp_dropout_l0': 0.4983979777544738, 'mlp_n_units_l1': 81, 'mlp_dropout_l1': 0.4719569599594377, 'reduction': 'sum', 'lr': 0.006419329761858022, 'weight_decay': 0.005833765305522945, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 11 with value: 1.9574306274178244.[0m

Trial Id: 13 | Model params: 37257 | Timestamp: 2022-02-27 03:22:23.877324

epoch 0 0.003745628671422807 1.981856946311105
epoch 5 0.012228280011463477 1.9734016057460897
epoch 10 0.008347241385508686 1.977274636011857
epoch 15 0.010480318406680733 1.9751469004776656
epoch 20 -0.0035623366691679426 1.9891125623645902
epoch 25 0.0036521956186984506 1.9819498776991902
epoch 30 0.017666183277484038 1.9679621013644792
epoch 35 0.013806682111317414 1.9718242845409235
epoch 40 -0.03153169042446313 2.0166404338501533
epoch 45 0.00706333966439332 1.9785542195768615
epoch 50 0.014361531462051658 1.9712695153427806
epoch 55 0.015326412078120022 1.9703044021046796
epoch 60 -0.004336375776631041 1.9898795073219124
epoch 65 0.010780175993601038 1.9748476099885173
epoch 70 0.00939366919219653 1.97623111484404
epoch 75 0.007915417227726484 1.977705100211487
epoch 80 0.014045137112934203 1.9715858831138637
epoch 85 0.01357854916976009 1.972052339250997
epoch 90 0.004246548504628578 1.981358641711106
epoch 95 0.0020346373304223064 1.983558060755392
[32m[I 2022-02-27 04:57:56,681][0m Trial 13 finished with value: 1.970951677910457 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 9, 'fe_dropout_l0': 0.37405500446327844, 'fe_n_units_l1': 215, 'fe_dropout_l1': 0.017563262318296413, 'n_units_l(Invariant)': 71, 'n_layers_mlp': 2, 'mlp_n_units_l0': 177, 'mlp_dropout_l0': 0.4946063135753775, 'mlp_n_units_l1': 87, 'mlp_dropout_l1': 0.4893014220501528, 'reduction': 'sum', 'lr': 0.00951151737058079, 'weight_decay': 0.05074308861517732, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 11 with value: 1.9574306274178244.[0m

Trial Id: 14 | Model params: 94936 | Timestamp: 2022-02-27 04:57:56.681447

[32m[I 2022-02-27 04:58:55,209][0m Trial 14 pruned. [0m
epoch 0 0.02519151467501124 1.9604096590648812

Trial Id: 15 | Model params: 27054 | Timestamp: 2022-02-27 04:58:55.209508

[32m[I 2022-02-27 04:59:52,652][0m Trial 15 pruned. [0m
epoch 0 0.023869153228164075 1.9617388902051667

Trial Id: 16 | Model params: 29795 | Timestamp: 2022-02-27 04:59:52.652633

[32m[I 2022-02-27 05:00:55,313][0m Trial 16 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 17 | Model params: 50590 | Timestamp: 2022-02-27 05:00:55.313583

epoch 0 -0.0019011239012456382 1.9874655756110298
epoch 5 0.0013824945441154313 1.9842060551001912
epoch 10 -0.00043414681091458185 1.986010025548228
epoch 15 -0.02059588457123751 2.0059222219108213
epoch 20 -0.005283930633539047 1.9908179755070092
epoch 25 0.00013805895796670242 1.9854419876929572
epoch 30 -0.020138402913500997 2.005472594640671
epoch 35 -0.025946475363483268 2.0111734867908058
epoch 40 -0.006192275815883219 1.9917171948983152
epoch 45 -0.006327311113495382 1.9918508388884406
epoch 50 0.00951483671535236 1.97611024828752
epoch 55 -0.0057760671306317235 1.9913052181032056
[32m[I 2022-02-27 05:56:25,916][0m Trial 17 pruned. [0m

Trial Id: 18 | Model params: 65597 | Timestamp: 2022-02-27 05:56:25.916541

[32m[I 2022-02-27 05:57:24,185][0m Trial 18 pruned. [0m
epoch 0 0.027498676648508802 1.9580883507825708

Trial Id: 19 | Model params: 68105 | Timestamp: 2022-02-27 05:57:24.186002

[32m[I 2022-02-27 05:58:42,955][0m Trial 19 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 20 | Model params: 83892 | Timestamp: 2022-02-27 05:58:42.956067

epoch 0 -0.0014155043908028464 1.986983856897974
epoch 5 -0.001700633766263504 1.987266710090119
epoch 10 -1.720059999854584e-05 1.985596132413826
epoch 15 -0.0011543780109513069 1.986724779758044
epoch 20 -6.776221104320967e-05 1.9856463283856052
epoch 25 -0.0006497344284233098 1.9862240007044971
epoch 30 -0.0006355702185747436 1.986209943141625
epoch 35 -0.0035405706106113044 1.9890909915195698
epoch 40 -0.0009109160905680369 1.986483198014737
epoch 45 -0.000242826225667514 1.9858201166125833
epoch 50 -0.00323555259060182 1.9887886845069445
epoch 55 -0.0007472091470597242 1.9863207388059085
[32m[I 2022-02-27 06:55:51,029][0m Trial 20 pruned. [0m

Trial Id: 21 | Model params: 22892 | Timestamp: 2022-02-27 06:55:51.029993

[32m[I 2022-02-27 06:56:48,121][0m Trial 21 pruned. [0m
epoch 0 0.022926533339754696 1.962685857454743

Trial Id: 22 | Model params: 17352 | Timestamp: 2022-02-27 06:56:48.121805

[32m[I 2022-02-27 06:57:45,087][0m Trial 22 pruned. [0m
epoch 0 0.020549109432478563 1.9650722191081686

Trial Id: 23 | Model params: 52406 | Timestamp: 2022-02-27 06:57:45.087707

[32m[I 2022-02-27 06:58:42,729][0m Trial 23 pruned. [0m
epoch 0 0.02745144753250839 1.9581358970721576

Trial Id: 24 | Model params: 39857 | Timestamp: 2022-02-27 06:58:42.730153

[32m[I 2022-02-27 06:59:39,890][0m Trial 24 pruned. [0m
epoch 0 0.015567911678312396 1.9700627703040587

Study statistics: 
  Number of finished trials:  25
  Number of pruned trials:  19
  Number of complete trials:  6

Best trial:
  Value:  1.9574306274178244
  Params: 
    n_layers_fe: 2
    fe_n_units_l0: 9
    fe_dropout_l0: 0.4799840597123655
    fe_n_units_l1: 244
    fe_dropout_l1: 0.019574559005533593
    n_units_l(Invariant): 9
    n_layers_mlp: 2
    mlp_n_units_l0: 154
    mlp_dropout_l0: 0.49856485454659405
    mlp_n_units_l1: 56
    mlp_dropout_l1: 0.45538781425864444
    reduction: sum
    lr: 0.005544184180774864
    weight_decay: 0.008298229989336776
    criterion: MSELoss
    batch_size: 32
Target: 67698, NaN: 0, Max: 45.0, Min: 0.0, Mean: 3.3989925847144673
Prediction: 67698, NaN: 0, Max: 4.904659271240234, Min: 3.209517240524292, Mean: 3.3997565121582936

 XXXXXX======== TRIAL des - qso ended

Test Set - R-squared:  0.027549823046273292
Test Set - RMSE:  1.9623414393621368
Test Set - MAE:  1.5529458920125712



./hp_optim.sh: line 11: e: command not found
