[32m[I 2022-02-24 20:02:05,609][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: qso
Training Set: 216623
Validation Set: 54158
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 211568 | Timestamp: 2022-02-24 20:02:05.609834

[32m[I 2022-02-24 20:03:15,789][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 140465 | Timestamp: 2022-02-24 20:03:15.789687

epoch 0 0.008570329352630468 1.9770522139057314
epoch 5 0.020504188099600085 1.9651172814242157
epoch 10 0.012755726086632668 1.9728746611613237
epoch 15 0.019921941895409412 1.9657012615082363
epoch 20 0.019795139166640663 1.9658284188403257
epoch 25 0.014413074248441737 1.9712179720765888
epoch 30 -0.0010506827590803791 1.9866218889023752
epoch 35 0.016464163943755383 1.969165768213457
epoch 40 0.014917220277307464 1.9707137502755232
epoch 45 0.019395482650236495 1.9662291391907454
epoch 50 0.007061101539681092 1.9785564494515224
epoch 55 0.019137197662479233 1.9664880682613417
epoch 60 0.010583129778858558 1.9750442886540522
epoch 65 0.018144174228788446 1.9674832506326656
epoch 70 0.01530410383367109 1.9703267210659239
epoch 75 0.019425096703848843 1.9661994491099142
epoch 80 0.014917021085497972 1.970713949522747
epoch 85 0.018610701758952075 1.9670157715301573
epoch 90 0.01814992502384205 1.9674774887839213
epoch 95 0.00673645351080987 1.9788798741642686
[32m[I 2022-02-24 21:38:14,151][0m Trial 1 finished with value: 1.96613121034931 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 147, 'fe_dropout_l0': 0.4921020926450126, 'fe_n_units_l1': 206, 'fe_dropout_l1': 0.4891554994627627, 'n_units_l(Invariant)': 510, 'n_layers_mlp': 2, 'mlp_n_units_l0': 21, 'mlp_dropout_l0': 0.36443635274002784, 'mlp_n_units_l1': 110, 'mlp_dropout_l1': 0.45846691103121384, 'reduction': 'sum', 'lr': 0.005648861851941123, 'weight_decay': 0.1178833403528779, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 1 with value: 1.96613121034931.[0m

Trial Id: 2 | Model params: 104719 | Timestamp: 2022-02-24 21:38:14.151748

[32m[I 2022-02-24 21:38:38,190][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 121398 | Timestamp: 2022-02-24 21:38:38.191004

[32m[I 2022-02-24 21:39:38,673][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 57330 | Timestamp: 2022-02-24 21:39:38.673698

[32m[I 2022-02-24 21:41:21,572][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 150523 | Timestamp: 2022-02-24 21:41:21.572326

[32m[I 2022-02-24 21:43:32,404][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 108076 | Timestamp: 2022-02-24 21:43:32.404378

[32m[I 2022-02-24 21:44:30,384][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 64873 | Timestamp: 2022-02-24 21:44:30.385084

[32m[I 2022-02-24 21:45:21,135][0m Trial 7 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 8 | Model params: 103410 | Timestamp: 2022-02-24 21:45:21.135368

[32m[I 2022-02-24 21:45:49,974][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 109100 | Timestamp: 2022-02-24 21:45:49.975009

[32m[I 2022-02-24 21:46:36,721][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 254886 | Timestamp: 2022-02-24 21:46:36.721639

epoch 0 -0.01877686415401092 2.0041338349430617
epoch 5 0.0015584117326515878 1.9840312778092744
epoch 10 0.002033508393801786 1.9835591826934793
epoch 15 0.002942718992583915 1.98265540285512
epoch 20 -0.006650040541942959 1.9921702068242526
epoch 25 0.0031537683014457585 1.9824455552336622
epoch 30 -0.0038812741773479598 1.9894286125912775
epoch 35 -0.004692445485399599 1.9902322143656688
epoch 40 -0.002515201538122236 1.9880745534750786
epoch 45 -0.0024286642637207922 1.9879887461647523
epoch 50 -0.010333161512187328 1.9958113454101902
epoch 55 0.0022651304069033484 1.983328983264921
epoch 60 0.000956909748144219 1.984628818557293
epoch 65 0.004618130473876492 1.9809889187428493
epoch 70 0.0011123854510904918 1.9844743839940884
epoch 75 0.0011673639993494689 1.984419770732096
epoch 80 0.0018143691657707128 1.9837769514122592
epoch 85 0.0023628519512129964 1.9832318538957079
epoch 90 -0.0002815774373436941 1.9858585833670364
epoch 95 0.0029056910969126326 1.9826922176285673
[32m[I 2022-02-25 00:14:10,220][0m Trial 10 finished with value: 1.9822838228696091 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 126, 'fe_dropout_l0': 0.49885265066215767, 'fe_n_units_l1': 174, 'fe_dropout_l1': 0.496665900182961, 'fe_n_units_l2': 254, 'fe_dropout_l2': 0.03820253335007684, 'fe_n_units_l3': 245, 'fe_dropout_l3': 0.4871733295783705, 'n_units_l(Invariant)': 505, 'n_layers_mlp': 2, 'mlp_n_units_l0': 11, 'mlp_dropout_l0': 0.2447803817140795, 'mlp_n_units_l1': 9, 'mlp_dropout_l1': 0.49664655848120093, 'reduction': 'sum', 'lr': 0.0012827192165224578, 'weight_decay': 0.10719466752493295, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 1 with value: 1.96613121034931.[0m

Trial Id: 11 | Model params: 257919 | Timestamp: 2022-02-25 00:14:10.220448

epoch 0 -0.045446447513278754 2.0301965190153513
epoch 5 0.004170754718936909 1.9814340478341976
epoch 10 0.0013673096184927402 1.9842211409096548
epoch 15 -0.006991419019892087 1.9925079738521787
epoch 20 -0.008629025122439904 1.9941274602023409
epoch 25 0.0011231368223039162 1.9844637041749242
epoch 30 -0.010510450692093665 1.9959864461834296
epoch 35 0.002718049445391557 1.9828787687588336
epoch 40 -0.0014084364079236522 1.9869768448272598
epoch 45 -0.0010569420227122261 1.9866280997620829
epoch 50 -0.008538902990315345 1.994038369452135
epoch 55 -0.009065247490111394 1.9945586340763748
epoch 60 -0.005226811892079963 1.9907614170417502
epoch 65 0.0009388673825119209 1.9846467393244112
epoch 70 0.0002674914989339028 1.9853134753914246
epoch 75 0.0004843256189577261 1.9850981642749952
epoch 80 -0.005764403762109627 1.9912936720967482
epoch 85 -0.0058119262513445236 1.991340715973989
epoch 90 -0.0029342225876405337 1.988489987603115
epoch 95 -0.006215087064854741 1.9917397717459038
[32m[I 2022-02-25 02:01:14,637][0m Trial 11 finished with value: 1.983969578309099 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 135, 'fe_dropout_l0': 0.49972029178299554, 'fe_n_units_l1': 180, 'fe_dropout_l1': 0.4733781570951064, 'fe_n_units_l2': 254, 'fe_dropout_l2': 0.012928792629613484, 'fe_n_units_l3': 255, 'fe_dropout_l3': 0.4908447548027708, 'n_units_l(Invariant)': 471, 'n_layers_mlp': 2, 'mlp_n_units_l0': 17, 'mlp_dropout_l0': 0.22533995432175097, 'mlp_n_units_l1': 10, 'mlp_dropout_l1': 0.48820686072289515, 'reduction': 'sum', 'lr': 0.0011893252581635229, 'weight_decay': 0.1172024320878219, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 1 with value: 1.96613121034931.[0m

Trial Id: 12 | Model params: 226818 | Timestamp: 2022-02-25 02:01:14.637912

epoch 0 0.004057165462866608 1.9815470507424457
epoch 5 0.007161256692500562 1.9784566610248868
epoch 10 0.0009932090670423666 1.984592763391366
epoch 15 -0.00399758343436174 1.9895438564293666
epoch 20 3.114386464386776e-06 1.9855759639790287
epoch 25 0.003302630174052412 1.982297527600836
epoch 30 0.0021062563891560693 1.9834868843822395
epoch 35 -0.0012373651877988223 1.9868071193391177
epoch 40 0.00658157165524198 1.9790341537816212
epoch 45 -0.0016409449051926206 1.9872075010561736
epoch 50 -0.01773788136976151 2.0031116328369016
epoch 55 -0.03227890989054116 2.017370707197254
epoch 60 -0.019381908046583574 2.004728866591294
epoch 65 -0.008895489933096634 1.9943908522388762
epoch 70 0.004562301875177033 1.981044472439394
epoch 75 -0.005461055495865619 1.9909933527402135
epoch 80 -0.001252031607323234 1.9868216709534652
epoch 85 -0.03412918349164529 2.0191778818823716
epoch 90 0.00015523974995523826 1.9854249295317588
epoch 95 -0.011443292520209258 1.99690752034695
[32m[I 2022-02-25 03:28:36,376][0m Trial 12 finished with value: 2.011335253472054 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 123, 'fe_dropout_l0': 0.4386390501140822, 'fe_n_units_l1': 171, 'fe_dropout_l1': 0.49563412441567856, 'fe_n_units_l2': 178, 'fe_dropout_l2': 0.0027611173264837086, 'fe_n_units_l3': 252, 'fe_dropout_l3': 0.48513500771940693, 'n_units_l(Invariant)': 507, 'n_layers_mlp': 2, 'mlp_n_units_l0': 9, 'mlp_dropout_l0': 0.277212963538035, 'mlp_n_units_l1': 15, 'mlp_dropout_l1': 0.4907126123206051, 'reduction': 'sum', 'lr': 0.00998849434518536, 'weight_decay': 0.16693540976935362, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 1 with value: 1.96613121034931.[0m

Trial Id: 13 | Model params: 165726 | Timestamp: 2022-02-25 03:28:36.376514

epoch 0 0.00023696404807904692 1.9853437865478483
epoch 5 0.017900651281197555 1.9677272261751917
epoch 10 0.01367446710736464 1.9719564574189588
epoch 15 0.01620008351291058 1.9694301120348714
epoch 20 0.019029956935645687 1.9665955663973276
epoch 25 0.01870762891520128 1.966918632732545
epoch 30 0.015748967914505085 1.9698815955147295
epoch 35 0.01844729616047569 1.9671795230666442
epoch 40 0.018297032199992458 1.9673300931138602
epoch 45 0.018352598085306426 1.9672744153840238
epoch 50 0.017826266397881985 1.9678017432741421
epoch 55 0.01811800506683192 1.967509469881671
epoch 60 0.019562522624841483 1.966061664511736
epoch 65 0.01957660655978244 1.96604754327267
epoch 70 0.01461385231456247 1.971017179289867
epoch 75 0.013939787638693413 1.9716912124732375
epoch 80 0.011329610333547624 1.9742990970222318
epoch 85 0.019764950274940296 1.9658586909429605
epoch 90 0.017540345812367852 1.968088145804649
epoch 95 0.01811549434102555 1.9675119853945677
[32m[I 2022-02-25 04:29:26,919][0m Trial 13 finished with value: 1.966925727517428 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 174, 'fe_dropout_l0': 0.42429812483424945, 'fe_n_units_l1': 182, 'fe_dropout_l1': 0.3851366982899857, 'fe_n_units_l2': 110, 'fe_dropout_l2': 0.16052523636445362, 'fe_n_units_l3': 174, 'fe_dropout_l3': 0.3320238903250148, 'n_units_l(Invariant)': 507, 'n_layers_mlp': 2, 'mlp_n_units_l0': 54, 'mlp_dropout_l0': 0.23764863117306345, 'mlp_n_units_l1': 52, 'mlp_dropout_l1': 0.4892660262538935, 'reduction': 'sum', 'lr': 0.0008839753358554638, 'weight_decay': 0.09592401435413724, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 1 with value: 1.96613121034931.[0m

Trial Id: 14 | Model params: 145905 | Timestamp: 2022-02-25 04:29:26.920138

epoch 0 -0.026356047591518772 2.011574891070614
epoch 5 0.02045084345500936 1.9651707921459807
epoch 10 0.019090547145542702 1.966534831475302
epoch 15 0.016700949983851077 1.9689287158283328
epoch 20 0.010571970095710537 1.9750554269350835
epoch 25 0.02096326114695768 1.9646567189102444
epoch 30 0.016007976372381605 1.9696223884891666
epoch 35 0.021826507929833205 1.963790378792526
epoch 40 0.016194838730623884 1.969435361688905
epoch 45 0.017442416003466854 1.9681862311013738
epoch 50 0.02077148875226187 1.9648491266414596
epoch 55 0.020925083899138053 1.9646950241404133
epoch 60 0.021664663569135212 1.9639528322097553
epoch 65 0.02155384628419088 1.9640640587748097
epoch 70 0.0211314629194711 1.9644879443770302
epoch 75 0.011376750323247253 1.974252028985464
epoch 80 0.020513605895042253 1.9651078341571433
epoch 85 0.014671972814077616 1.9709590507112695
epoch 90 0.017255055549536213 1.9683738754155395
epoch 95 0.021244944866635973 1.9643740678091772
[32m[I 2022-02-25 05:29:13,430][0m Trial 14 finished with value: 1.9639577135257953 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 195, 'fe_dropout_l0': 0.41610576430893104, 'fe_n_units_l1': 198, 'fe_dropout_l1': 0.3393859617865676, 'fe_n_units_l2': 78, 'fe_dropout_l2': 0.18875410888960995, 'fe_n_units_l3': 165, 'fe_dropout_l3': 0.333890368257953, 'n_units_l(Invariant)': 436, 'n_layers_mlp': 2, 'mlp_n_units_l0': 57, 'mlp_dropout_l0': 0.3294371225103128, 'mlp_n_units_l1': 55, 'mlp_dropout_l1': 0.1796620100738467, 'reduction': 'sum', 'lr': 0.0006332720208222198, 'weight_decay': 0.08972901558687425, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 14 with value: 1.9639577135257953.[0m

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  9
  Number of complete trials:  6

Best trial:
  Value:  1.9639577135257953
  Params: 
    n_layers_fe: 4
    fe_n_units_l0: 195
    fe_dropout_l0: 0.41610576430893104
    fe_n_units_l1: 198
    fe_dropout_l1: 0.3393859617865676
    fe_n_units_l2: 78
    fe_dropout_l2: 0.18875410888960995
    fe_n_units_l3: 165
    fe_dropout_l3: 0.333890368257953
    n_units_l(Invariant): 436
    n_layers_mlp: 2
    mlp_n_units_l0: 57
    mlp_dropout_l0: 0.3294371225103128
    mlp_n_units_l1: 55
    mlp_dropout_l1: 0.1796620100738467
    reduction: sum
    lr: 0.0006332720208222198
    weight_decay: 0.08972901558687425
    criterion: MSELoss
    batch_size: 256
Target: 67698, NaN: 0, Max: 45.0, Min: 0.0, Mean: 3.3989925847144673
Prediction: 67698, NaN: 0, Max: 4.492347240447998, Min: 2.6677706241607666, Mean: 3.3449567309961123

 XXXXXX======== TRIAL des - qso ended

Test Set - R-squared:  0.02103633988311593
Test Set - RMSE:  1.9689023648724193
Test Set - MAE:  1.5510076199286749



./hp_optim.sh: line 11: e: command not found
