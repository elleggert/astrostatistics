[32m[I 2022-03-04 12:39:28,696][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: glbg
Training Set: 270781
Validation Set: 67698
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 360120 | Timestamp: 2022-03-04 12:39:28.697259

epoch 0 -7.566146046509626 27.871630950945985
epoch 5 -7.577786989009953 27.890562562550475
epoch 10 -7.553496266868304 27.85104408226308
epoch 15 -7.593084149864932 27.915420744345507
epoch 20 -7.589125495776818 27.908989978477358
epoch 25 -7.5645263298660925 27.868995793986645
epoch 30 -7.589376753815863 27.90939818690409
epoch 35 -7.567929091776644 27.874531543206043
epoch 40 -7.5889033030896424 27.908628986337483
epoch 45 -7.567977744110955 27.87461068479835
epoch 50 -7.564063285214633 27.868242409422535
epoch 55 -7.583610703415392 27.900028821823472
epoch 60 -7.618501476240464 27.956675516306838
epoch 65 -7.571851925179772 27.88091200159672
epoch 70 -7.603034417433243 27.931578246027662
[32m[I 2022-03-04 14:01:37,750][0m Trial 0 finished with value: 27.90069786571306 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.23106420469271932, 'n_units_l(Invariant)': 219, 'n_layers_mlp': 4, 'initialiser': 'kaiming_he', 'lr': 0.0013567043889153524, 'weight_decay': 0.05292526732459213, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 75}. Best is trial 0 with value: 27.90069786571306.[0m

Trial Id: 1 | Model params: 374568 | Timestamp: 2022-03-04 14:01:37.750710

epoch 0 -0.9389044414460173 13.260132030439891
epoch 5 -0.696079981838643 12.402030920450272
epoch 10 -0.9215991276389468 13.200824035957567
epoch 15 -0.8892402607496273 13.08920415760749
epoch 20 -0.7155946051708562 12.473174022322482
epoch 25 -0.5618244245745896 11.901062904752424
epoch 30 -0.47504504714520834 11.56570970366112
epoch 35 -0.35906024768240297 11.101687554525787
epoch 40 -0.2884281557940691 10.809354224967251
epoch 45 -0.23481609544273563 10.582073811340596
[32m[I 2022-03-04 15:42:33,946][0m Trial 1 finished with value: 10.437097666732996 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.41274137207702544, 'n_units_l(Invariant)': 275, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 1.163699047471671e-05, 'weight_decay': 0.13613007558009427, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 1 with value: 10.437097666732996.[0m

Trial Id: 2 | Model params: 125922 | Timestamp: 2022-03-04 15:42:33.946264

epoch 0 -7.634780183392454 27.983065477429133
epoch 5 -7.58170049245623 27.896924189747647
epoch 10 -7.602219525033245 27.93025535408348
epoch 15 -7.590578739888253 27.911350920806242
epoch 20 -7.562669823396771 27.86597509131605
epoch 25 -7.589646391280915 27.909836248973985
epoch 30 -7.5801899601475 27.89446890365278
epoch 35 -7.576102748096265 27.887824284442903
epoch 40 -7.584400674112716 27.901312646248012
epoch 45 -7.5878215510260425 27.906871418078225
[32m[I 2022-03-04 16:44:44,279][0m Trial 2 finished with value: 27.90503629337312 and parameters: {'n_layers_fe': 4, 'fe_neurons': 128, 'fe_dropout': 0.09793974142882955, 'n_units_l(Invariant)': 368, 'n_layers_mlp': 2, 'initialiser': 'kaiming_he', 'lr': 0.0005256495270463235, 'weight_decay': 0.2234107080828943, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 50}. Best is trial 1 with value: 10.437097666732996.[0m

Trial Id: 3 | Model params: 219248 | Timestamp: 2022-03-04 16:44:44.279578

epoch 0 -8.987076544921742 30.094617984645808
epoch 5 -7.591784224870011 27.91330920179502
epoch 10 -7.5955698176193085 27.91945791207353
epoch 15 -7.586596089860295 27.90488022583668
epoch 20 -7.59341928101974 27.91596509116063
epoch 25 -7.567580974395881 27.873965262406216
epoch 30 -7.594067342602697 27.917017694487996
epoch 35 -7.589382722151765 27.909407883337202
epoch 40 -7.614108277968521 27.949549284770214
epoch 45 -7.590930737273911 27.911922746186832
epoch 50 -7.570832007577959 27.879253253926358
epoch 55 -7.583847890046098 27.900414292946728
epoch 60 -7.568699373849075 27.87578451630693
epoch 65 -7.608804868856396 27.94094417375361
epoch 70 -7.5952714634918586 27.918973362592503
[32m[I 2022-03-04 18:19:19,122][0m Trial 3 finished with value: 27.876756372311974 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.30838181193071035, 'n_units_l(Invariant)': 183, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0029304053715687468, 'weight_decay': 0.14637936359595302, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 75}. Best is trial 1 with value: 10.437097666732996.[0m

Trial Id: 4 | Model params: 108502 | Timestamp: 2022-03-04 18:19:19.122324

epoch 0 -4941.42862586863 669.4834550635139
epoch 5 -250.8508487723622 151.12675421779693
epoch 10 -10.479432083210877 32.264864610570555
epoch 15 -14.141122476298992 37.055159060596026
epoch 20 -9.615501625553007 31.027008608069668
epoch 25 -9.407677671983697 30.721793267354904
[32m[I 2022-03-04 18:54:06,691][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 195512 | Timestamp: 2022-03-04 18:54:06.692188

epoch 0 -0.2331344830098694 10.57486585158267
epoch 5 -0.3360417846249242 11.007271179020185
epoch 10 -0.01094123918337453 9.574863737177067
epoch 15 -0.02406021281234305 9.636789932932063
epoch 20 0.002299788608148723 9.511952606069595
epoch 25 0.02989432403853487 9.379488783711654
epoch 30 0.05118264228376823 9.276004617361737
epoch 35 0.030172588201601847 9.378143485540212
epoch 40 0.06552755558584411 9.205616856826095
epoch 45 0.04964742077500672 9.283506043131638
[32m[I 2022-03-04 19:40:27,347][0m Trial 5 finished with value: 9.27177154580879 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.31101428314399715, 'n_units_l(Invariant)': 91, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 1.7774159802744814e-05, 'weight_decay': 0.18752888598523026, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 50}. Best is trial 5 with value: 9.27177154580879.[0m

Trial Id: 6 | Model params: 93158 | Timestamp: 2022-03-04 19:40:27.347767

[32m[I 2022-03-04 19:41:18,639][0m Trial 6 pruned. [0m
epoch 0 0.08229253444218365 9.122666067870217

Trial Id: 7 | Model params: 48396 | Timestamp: 2022-03-04 19:41:18.639903

[32m[I 2022-03-04 19:42:40,852][0m Trial 7 pruned. [0m
epoch 0 0.04802163949512028 9.291443360950396

Trial Id: 8 | Model params: 30708 | Timestamp: 2022-03-04 19:42:40.853053

[32m[I 2022-03-04 19:43:06,620][0m Trial 8 pruned. [0m
epoch 0 0.030479734295041472 9.376658330450704

Trial Id: 9 | Model params: 123062 | Timestamp: 2022-03-04 19:43:06.620733

[32m[I 2022-03-04 19:44:29,082][0m Trial 9 pruned. [0m
epoch 0 0.06324974157861307 9.216829558011428

Trial Id: 10 | Model params: 306198 | Timestamp: 2022-03-04 19:44:29.082723

[32m[I 2022-03-04 19:46:05,623][0m Trial 10 pruned. [0m
epoch 0 -0.1558913903484318 10.23830728606642

Trial Id: 11 | Model params: 315744 | Timestamp: 2022-03-04 19:46:05.623666

[32m[I 2022-03-04 19:47:44,342][0m Trial 11 pruned. [0m
epoch 0 -0.41958441786876066 11.346195370447145

Trial Id: 12 | Model params: 331740 | Timestamp: 2022-03-04 19:47:44.342267

[32m[I 2022-03-04 19:49:28,402][0m Trial 12 pruned. [0m
epoch 0 -0.6327632401940504 12.168337665740333

Trial Id: 13 | Model params: 377922 | Timestamp: 2022-03-04 19:49:28.402432

[32m[I 2022-03-04 19:51:28,523][0m Trial 13 pruned. [0m
epoch 0 -0.23937526872141768 10.601591315802036

Trial Id: 14 | Model params: 324000 | Timestamp: 2022-03-04 19:51:28.523649

[32m[I 2022-03-04 19:53:10,033][0m Trial 14 pruned. [0m
epoch 0 -1.1144153898637033 13.84729043269643

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  10
  Number of complete trials:  5

Best trial:
  Value:  9.27177154580879
  Params: 
    n_layers_fe: 2
    fe_neurons: 256
    fe_dropout: 0.31101428314399715
    n_units_l(Invariant): 91
    n_layers_mlp: 2
    initialiser: uniform
    lr: 1.7774159802744814e-05
    weight_decay: 0.18752888598523026
    criterion: MSELoss
    batch_size: 128
    epochs: 50
Target: 67698, NaN: 0, Max: 122.0, Min: 3.0, Mean: 29.60905787467872
Prediction: 67698, NaN: 0, Max: 42.043155670166016, Min: 22.27263641357422, Mean: 27.326313260253198

 XXXXXX======== TRIAL des - glbg ended

Test Set - R-squared:  0.052048423510482666
Test Set - RMSE:  9.27177154580879
Test Set - MAE:  7.033958786674756



[32m[I 2022-03-04 19:53:45,370][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: glbg
Training Set: 270781
Validation Set: 67698
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Previous best Test-set performance: 0.10000555796016108

Trial Id: 0 | Model params: 181064 | Timestamp: 2022-03-04 19:53:45.371255

epoch 0 0.10854518792290879 8.991234247219863
epoch 1 0.10824682656303142 8.992738761198023
epoch 2 0.11150708602283699 8.976284932422569
epoch 3 0.11086989545575876 8.979503066691139
epoch 4 0.11232050790855397 8.972175063670145
epoch 5 0.11207718929032229 8.97340464466123
epoch 6 0.11219457193831461 8.97281148678739
epoch 7 0.11397607782236818 8.963804364785174
epoch 8 0.10904520568947507 8.988712298039609
[32m[I 2022-03-04 20:02:12,060][0m Trial 0 finished with value: 8.952689100063735 and parameters: {'lr': 5.6030893400533116e-05, 'weight_decay': 0.021799853513668564, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 10}. Best is trial 0 with value: 8.952689100063735.[0m
epoch 9 0.11617208388430356 8.952689100063735

Previous best Test-set performance: 0.10000555796016108

Trial Id: 1 | Model params: 181064 | Timestamp: 2022-03-04 20:02:12.060385

epoch 0 0.0658743234310627 9.203908669420386
epoch 1 0.07600483526273005 9.153864824192246
epoch 2 0.0754505666597931 9.156609935536288
epoch 3 0.08001728016350784 9.133967891425378
epoch 4 0.05879270555175653 9.238730268906755
epoch 5 0.049557160753533 9.283946884551135
epoch 6 0.08043112664115981 9.13191324107159
epoch 7 0.08374907444028301 9.115423670357195
epoch 8 0.09283558509711232 9.07011197268133
epoch 9 0.10544704581530862 9.006844663123056
epoch 10 0.1040878534343741 9.01368460923702
epoch 11 0.10406330128955366 9.01380811675646
epoch 12 0.08504853234677401 9.108957476548872
epoch 13 0.11243574922614341 8.971592646905131
epoch 14 0.10422720013316256 9.012983605214343
epoch 15 0.11089533071390312 8.979374627888543
epoch 16 0.11306905566444958 8.968391311748737
epoch 17 0.10246801086959889 9.021829468270267
epoch 18 0.0750967032507367 9.15836207507095
[32m[I 2022-03-04 20:19:02,323][0m Trial 1 finished with value: 8.965004477417732 and parameters: {'lr': 0.002563071870959778, 'weight_decay': 0.054490941556854675, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 0 with value: 8.952689100063735.[0m
epoch 19 0.11373881256311635 8.965004477417732

Previous best Test-set performance: 0.10000555796016108

Trial Id: 2 | Model params: 181064 | Timestamp: 2022-03-04 20:19:02.323687

epoch 0 -0.3840086639238589 11.203121603269883
epoch 1 -0.7010030706858588 12.420017117745804
epoch 2 -1.0345425578139764 13.5832293881363
epoch 3 -1.3618786865789283 14.635192499488731
[32m[I 2022-03-04 20:23:15,160][0m Trial 2 finished with value: 15.658520742781613 and parameters: {'lr': 2.2123123458795926e-05, 'weight_decay': 0.07986840009733527, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 5}. Best is trial 0 with value: 8.952689100063735.[0m
epoch 4 -1.7037228580658201 15.658520742781613

Previous best Test-set performance: 0.10000555796016108

Trial Id: 3 | Model params: 181064 | Timestamp: 2022-03-04 20:23:15.160608

epoch 0 0.02320598862858325 9.411766406726144
epoch 1 0.05935311451314573 9.235979419981094
epoch 2 0.013980177271367245 9.456108976922893
epoch 3 0.007761785588906278 9.485879864899527
[32m[I 2022-03-04 20:29:32,238][0m Trial 3 finished with value: 9.302292083038598 and parameters: {'lr': 0.004861936890489101, 'weight_decay': 0.11587893367446694, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 5}. Best is trial 0 with value: 8.952689100063735.[0m
epoch 4 0.04579727507216269 9.302292083038598

Previous best Test-set performance: 0.10000555796016108

Trial Id: 4 | Model params: 181064 | Timestamp: 2022-03-04 20:29:32.238416

epoch 0 0.10876181891963466 8.990141708172183
epoch 1 0.10692227068720628 8.999414916378024
epoch 2 0.11156084370853336 8.976013376175043
epoch 3 0.11263470686554455 8.970587048192407
epoch 4 0.10575212005918966 9.005308705624387
epoch 5 0.11327137738077175 8.96736834382511
epoch 6 0.11443602304983935 8.961477455697741
epoch 7 0.11226599872043697 8.972450533856744
epoch 8 0.11578861235952509 8.954631066918004
[32m[I 2022-03-04 20:37:57,961][0m Trial 4 finished with value: 8.946587517191075 and parameters: {'lr': 0.00010092978657597553, 'weight_decay': 0.05866938901882471, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 10}. Best is trial 4 with value: 8.946587517191075.[0m
epoch 9 0.11737639502206776 8.946587517191075

Previous best Test-set performance: 0.10000555796016108

Trial Id: 5 | Model params: 181064 | Timestamp: 2022-03-04 20:37:57.961958

epoch 0 -0.33208697961823086 10.990967844117858
epoch 1 -0.5170478398901519 11.729224093469266
epoch 2 -0.7171211932118797 12.478722292356395
epoch 3 -0.9603751011832096 13.333348620332645
[32m[I 2022-03-04 20:42:10,751][0m Trial 5 finished with value: 14.138268865491762 and parameters: {'lr': 1.6519754580519656e-05, 'weight_decay': 0.12736997252758622, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 5}. Best is trial 4 with value: 8.946587517191075.[0m
epoch 4 -1.2042110815375642 14.138268865491762

Previous best Test-set performance: 0.10000555796016108

Trial Id: 6 | Model params: 181064 | Timestamp: 2022-03-04 20:42:10.751279

epoch 0 -8.928972155618546 30.00694567233178
epoch 1 -8.928972155618546 30.00694567233178
epoch 2 -8.928972155618546 30.00694567233178
epoch 3 -8.928972155618546 30.00694567233178
epoch 4 -8.928972155618546 30.00694567233178
epoch 5 -8.928972155618546 30.00694567233178
epoch 6 -8.928972155618546 30.00694567233178
epoch 7 -8.928972155618546 30.00694567233178
epoch 8 -8.928972155618546 30.00694567233178
epoch 9 -8.928972155618546 30.00694567233178
epoch 10 -8.928972155618546 30.00694567233178
epoch 11 -8.928972155618546 30.00694567233178
epoch 12 -8.928972155618546 30.00694567233178
epoch 13 -8.928972155618546 30.00694567233178
epoch 14 -8.928970060883062 30.006942507018387
epoch 15 -8.928898017094273 30.006833642869516
epoch 16 -8.928682635579525 30.006508181155585
epoch 17 -8.928057752125124 30.00556390354035
epoch 18 -8.926225869188716 30.00279552639786
[32m[I 2022-03-04 20:59:24,486][0m Trial 6 finished with value: 30.08727965580056 and parameters: {'lr': 0.003042806856774966, 'weight_decay': 0.028411608976344958, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 20}. Best is trial 4 with value: 8.946587517191075.[0m
epoch 19 -8.982206603291052 30.08727965580056

Previous best Test-set performance: 0.10000555796016108

Trial Id: 7 | Model params: 181064 | Timestamp: 2022-03-04 20:59:24.486832

[32m[I 2022-03-04 21:00:39,110][0m Trial 7 pruned. [0m
epoch 0 0.10500203104719885 9.009084709676749

Previous best Test-set performance: 0.10000555796016108

Trial Id: 8 | Model params: 181064 | Timestamp: 2022-03-04 21:00:39.110461

[32m[I 2022-03-04 21:01:30,700][0m Trial 8 pruned. [0m
epoch 0 0.1047001651205689 9.010603878727936

Previous best Test-set performance: 0.10000555796016108

Trial Id: 9 | Model params: 181064 | Timestamp: 2022-03-04 21:01:30.700609

[32m[I 2022-03-04 21:02:22,332][0m Trial 9 pruned. [0m
epoch 0 0.03945909400712877 9.33313564789901

Previous best Test-set performance: 0.10000555796016108

Trial Id: 10 | Model params: 181064 | Timestamp: 2022-03-04 21:02:22.333052

[32m[I 2022-03-04 21:03:12,834][0m Trial 10 pruned. [0m
epoch 0 0.08479282486756612 9.110230257629851

Previous best Test-set performance: 0.10000555796016108

Trial Id: 11 | Model params: 181064 | Timestamp: 2022-03-04 21:03:12.834870

[32m[I 2022-03-04 21:04:03,395][0m Trial 11 pruned. [0m
epoch 0 0.1077077243719693 8.995456594355213

Previous best Test-set performance: 0.10000555796016108

Trial Id: 12 | Model params: 181064 | Timestamp: 2022-03-04 21:04:03.395253

[32m[I 2022-03-04 21:04:53,873][0m Trial 12 pruned. [0m
epoch 0 0.10279395684888903 9.020191144453728

Previous best Test-set performance: 0.10000555796016108

Trial Id: 13 | Model params: 181064 | Timestamp: 2022-03-04 21:04:53.873304

[32m[I 2022-03-04 21:05:44,399][0m Trial 13 pruned. [0m
epoch 0 0.10489378617162148 9.009629491789807

Previous best Test-set performance: 0.10000555796016108

Trial Id: 14 | Model params: 181064 | Timestamp: 2022-03-04 21:05:44.400110

[32m[I 2022-03-04 21:06:34,906][0m Trial 14 pruned. [0m
epoch 0 0.10928911864434365 8.9874818127967

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  8
  Number of complete trials:  7

Best trial:
  Value:  8.946587517191075
  Params: 
    lr: 0.00010092978657597553
    weight_decay: 0.05866938901882471
    criterion: MSELoss
    batch_size: 256
    epochs: 10
Traceback (most recent call last):
  File "fine_tune.py", line 323, in <module>
    main()
  File "fine_tune.py", line 76, in main
    model = torch.load(f"trained_models/{area}/{gal}/{trial.number}.pt")
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 594, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'trained_models/des/glbg/4.pt'
