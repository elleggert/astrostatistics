[32m[I 2022-03-04 12:38:58,738][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: qso
Training Set: 270781
Validation Set: 67698
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 51036 | Timestamp: 2022-03-04 12:38:58.739587

epoch 0 0.021907006943370555 1.9680266225805476
epoch 5 0.016179824280263322 1.9737800614575882
epoch 10 0.022482135333336095 1.9674479279026236
epoch 15 0.02475610794409422 1.9651581857995957
epoch 20 0.023720366290127304 1.966201440762945
epoch 25 0.02372691532745741 1.9661948459576328
epoch 30 0.02415244516038917 1.9657662948851817
epoch 35 0.025845161066219036 1.964060634977864
epoch 40 0.024887260856348625 1.9650260419907384
epoch 45 0.025241717868616287 1.9646688624872548
[32m[I 2022-03-04 13:49:46,586][0m Trial 0 finished with value: 1.9701627606576582 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.3367956359954297, 'n_units_l(Invariant)': 461, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.001254588051380666, 'weight_decay': 0.043450342711246155, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 50}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 1 | Model params: 91728 | Timestamp: 2022-03-04 13:49:46.586488

epoch 0 -0.006108871130038551 1.9960130867475174
epoch 5 -0.0067128757253487326 1.9966121373193686
epoch 10 -0.009185388929325189 1.9990624995690782
epoch 15 -0.006407216521248316 1.9963090075878334
epoch 20 -0.004672144591881144 1.9945874212126067
[32m[I 2022-03-04 14:20:37,617][0m Trial 1 finished with value: 2.0040582551817447 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.04307859228347716, 'n_units_l(Invariant)': 359, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0023853270367242916, 'weight_decay': 0.19979843693913155, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 25}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 2 | Model params: 34800 | Timestamp: 2022-03-04 14:20:37.617652

epoch 0 -1.2473140186435612 2.983134094288096
epoch 5 -1.2223808310946223 2.966539507098516
epoch 10 -1.2088430705659365 2.957490282147886
epoch 15 -1.2261120452984873 2.9690287637018846
epoch 20 -1.2234524460334826 2.9672546421643706
epoch 25 -1.2267441543301056 2.9694502646530183
epoch 30 -1.2399085153340863 2.9782149243992766
epoch 35 -1.2242246494862532 2.9677698601477216
epoch 40 -1.234627710244561 2.9747021351327296
epoch 45 -1.2374418930912756 2.976574644303234
epoch 50 -1.233181705483842 2.9737395297045324
epoch 55 -1.2446860467181295 2.9813893701867653
epoch 60 -1.2300943675239084 2.9716832451149195
epoch 65 -1.2242649496599216 2.9677967461682155
epoch 70 -1.242084347103063 2.9796610820630813
[32m[I 2022-03-04 14:59:02,822][0m Trial 2 finished with value: 2.985364714115124 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.22226532448430686, 'n_units_l(Invariant)': 215, 'n_layers_mlp': 4, 'initialiser': 'kaiming_he', 'lr': 0.0008888935761388057, 'weight_decay': 0.11254273936669913, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 75}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 3 | Model params: 409656 | Timestamp: 2022-03-04 14:59:02.823193

epoch 0 -1.6612255467616226 3.246248314632956
epoch 5 -1.2748008058129616 3.001321932820514
epoch 10 -1.2838041630582624 3.0072554829015155
epoch 15 -1.2717887959224763 2.999334284996128
epoch 20 -1.2655736416029693 2.9952286892946165
[32m[I 2022-03-04 15:34:44,086][0m Trial 3 finished with value: 2.999545055259928 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.4673419595765536, 'n_units_l(Invariant)': 411, 'n_layers_mlp': 4, 'initialiser': 'kaiming_he', 'lr': 1.2602655652996343e-05, 'weight_decay': 0.2147650543378931, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 25}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 4 | Model params: 93032 | Timestamp: 2022-03-04 15:34:44.086870

epoch 0 -0.037294881738649366 2.026711877743096
epoch 5 -0.008316332319790343 1.9982015712027432
epoch 10 -0.00455064094992963 1.9944668062612654
epoch 15 -0.01099957630423476 2.000858525133958
epoch 20 -0.003972956967299268 1.9938932477105518
epoch 25 -0.0007759075295976636 1.9907160415246201
epoch 30 -0.009342140846073876 1.9992177459266038
epoch 35 -0.005310225094518506 1.9952207150373538
epoch 40 -0.002587723457509794 1.9925172339934378
epoch 45 -0.00719945207080297 1.997094592098247
[32m[I 2022-03-04 16:06:19,231][0m Trial 4 finished with value: 1.9938974032714798 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.3443116607178117, 'n_units_l(Invariant)': 115, 'n_layers_mlp': 4, 'initialiser': 'normal', 'lr': 0.009190450228623515, 'weight_decay': 0.17511472552598548, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 50}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 5 | Model params: 53082 | Timestamp: 2022-03-04 16:06:19.231556

epoch 0 -1.2907265041502756 3.011809616271171
epoch 5 -1.2578751198643499 2.990135397501967
epoch 10 -1.2735799830482253 3.0005164614435462
epoch 15 -1.2734655970349498 3.0004409810480124
epoch 20 -1.2739571146918838 3.000765307490629
epoch 25 -1.2682431251652546 2.9969927811101975
epoch 30 -1.2773447392832789 3.0029996687068055
epoch 35 -1.2744837590405318 3.0011127732784506
epoch 40 -1.2731051659653398 3.0002031294130966
epoch 45 -1.2763890533618234 3.002369499367577
epoch 50 -1.2793138287599 3.0042976490477633
epoch 55 -1.2594114931448224 2.9911525447443585
epoch 60 -1.2749873782491616 3.001445010072426
epoch 65 -1.273195877308258 3.0002629924022517
epoch 70 -1.2671606980004175 2.9962775990656616
[32m[I 2022-03-04 17:00:30,732][0m Trial 5 finished with value: 3.000239350424099 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.08649279263905785, 'n_units_l(Invariant)': 492, 'n_layers_mlp': 4, 'initialiser': 'uniform', 'lr': 0.002716701817998607, 'weight_decay': 0.23376662176437124, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 75}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 6 | Model params: 65988 | Timestamp: 2022-03-04 17:00:30.732784

[32m[I 2022-03-04 17:01:43,271][0m Trial 6 pruned. [0m
epoch 0 -0.029874766407049336 2.0194499956603504

Trial Id: 7 | Model params: 177146 | Timestamp: 2022-03-04 17:01:43.271792

epoch 0 -1.559772902959439 3.1837694706643695
epoch 5 -1.477909840955812 3.132446378733653
epoch 10 -1.5282139179695737 3.164082539445298
epoch 15 -1.439176193341679 3.107867404195122
epoch 20 -1.4209558210746813 3.0962379355173697
epoch 25 -1.1824145941972928 2.939744075694611
epoch 30 -1.2730393233397215 3.0001596772479924
epoch 35 -1.2160984417265621 2.962343523735306
epoch 40 -1.2742220034329055 3.000940078991912
epoch 45 -1.1925219391735 2.9465435822613384
[32m[I 2022-03-04 18:13:11,707][0m Trial 7 finished with value: 2.938274474719215 and parameters: {'n_layers_fe': 4, 'fe_neurons': 128, 'fe_dropout': 0.2640917729381705, 'n_units_l(Invariant)': 508, 'n_layers_mlp': 4, 'initialiser': 'xavier', 'lr': 0.0046043150214254095, 'weight_decay': 0.06935726672593127, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 50}. Best is trial 0 with value: 1.9701627606576582.[0m

Trial Id: 8 | Model params: 319356 | Timestamp: 2022-03-04 18:13:11.708130

[32m[I 2022-03-04 18:14:05,878][0m Trial 8 pruned. [0m
epoch 0 -1.2070464045211495 2.9562872307860286

Trial Id: 9 | Model params: 32028 | Timestamp: 2022-03-04 18:14:05.878730

[32m[I 2022-03-04 18:14:34,022][0m Trial 9 pruned. [0m
epoch 0 -1.222451966050988 2.966586983878109

Trial Id: 10 | Model params: 41466 | Timestamp: 2022-03-04 18:14:34.023115

[32m[I 2022-03-04 18:16:04,051][0m Trial 10 pruned. [0m
epoch 0 -0.4045234412564569 2.358334428656934

Trial Id: 11 | Model params: 83802 | Timestamp: 2022-03-04 18:16:04.051406

[32m[I 2022-03-04 18:17:02,881][0m Trial 11 pruned. [0m
epoch 0 -0.003373693165216407 1.99329808904845

Trial Id: 12 | Model params: 90562 | Timestamp: 2022-03-04 18:17:02.881331

[32m[I 2022-03-04 18:18:05,237][0m Trial 12 pruned. [0m
epoch 0 0.012971636745475301 1.9769956403072424

Trial Id: 13 | Model params: 40014 | Timestamp: 2022-03-04 18:18:05.237696

[32m[I 2022-03-04 18:19:34,728][0m Trial 13 pruned. [0m
epoch 0 -0.004430116598479916 1.9943471562311423

Trial Id: 14 | Model params: 57706 | Timestamp: 2022-03-04 18:19:34.728982

[32m[I 2022-03-04 18:21:14,891][0m Trial 14 pruned. [0m
epoch 0 -0.00216868577205398 1.9921007980792949

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  8
  Number of complete trials:  7

Best trial:
  Value:  1.9701627606576582
  Params: 
    n_layers_fe: 4
    fe_neurons: 64
    fe_dropout: 0.3367956359954297
    n_units_l(Invariant): 461
    n_layers_mlp: 2
    initialiser: uniform
    lr: 0.001254588051380666
    weight_decay: 0.043450342711246155
    criterion: MSELoss
    batch_size: 32
    epochs: 50
Target: 67698, NaN: 0, Max: 45.0, Min: 0.0, Mean: 3.3989925847144673
Prediction: 67698, NaN: 0, Max: 1.1614570617675781, Min: 1.1614570617675781, Mean: 1.1614570617675781

 XXXXXX======== TRIAL des - qso ended

Test Set - R-squared:  -1.2643231419753742
Test Set - RMSE:  2.994401956215235
Test Set - MAE:  2.3740668618706167



[32m[I 2022-03-04 18:23:34,577][0m A new study created in memory with name: DeepSet[0m
Starting Loading des
Finished Loading des
Finished des setup

++++++++ Session Characteristics +++++++

Area: des
Gal Type: qso
Training Set: 270781
Validation Set: 67698
Test Samples: 67698
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Previous best Test-set performance: 0.029479080716163675

Trial Id: 0 | Model params: 157906 | Timestamp: 2022-03-04 18:23:34.577745

epoch 0 -1.1712751632910843 2.932231990272072
epoch 1 -1.1658979727238923 2.9285988846041398
epoch 2 -1.1627342143694483 2.9264591796650476
epoch 3 -1.1502698092983294 2.918014017886118
epoch 4 -1.2016070778843928 2.952642057851258
epoch 5 -1.2422680894413762 2.9797831735175913
epoch 6 -1.2469963750034587 2.9829232632581393
epoch 7 -1.248051418203576 2.9836234743504337
epoch 8 -1.2470193874210453 2.9829385378933755
epoch 9 -1.248006445312797 2.9835936300945045
epoch 10 -1.2481898220047296 2.9837153179957925
epoch 11 -1.2449233196320573 2.9815469388257205
epoch 12 -1.2474248154092065 2.9832076304144803
epoch 13 -1.2486950476122147 2.9840505576379868
epoch 14 -1.249707948518218 2.9847225489834996
epoch 15 -1.2479862345454267 2.983580218021678
epoch 16 -1.2465404518163044 2.98262062528113
epoch 17 -1.248214987156668 2.983732017083758
epoch 18 -1.248213247005018 2.98373086235718
[32m[I 2022-03-04 18:49:38,931][0m Trial 0 finished with value: 2.9823679130275935 and parameters: {'lr': 1.5625733343493963e-05, 'weight_decay': 0.1591096447862904, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 20}. Best is trial 0 with value: 2.9823679130275935.[0m
epoch 19 -1.2461597770203805 2.9823679130275935

Previous best Test-set performance: 0.029479080716163675

Trial Id: 1 | Model params: 157906 | Timestamp: 2022-03-04 18:49:38.932189

epoch 0 -1.209915325669829 2.958208033293841
epoch 1 -1.2071364546109753 2.9563475401693595
epoch 2 -1.2127223283098703 2.960086173720031
epoch 3 -1.2262433895604308 2.9691163511933834
epoch 4 -1.182575895663442 2.9398527113932054
epoch 5 -1.2078795271414462 2.9568451523078476
epoch 6 -1.2327820576398008 2.973473429152906
epoch 7 -1.2619731222934432 2.992847688152386
epoch 8 -1.1952307090614949 2.948363186595217
epoch 9 -1.2308027342194086 2.9721551700559403
epoch 10 -1.2092028515236302 2.957731133427719
epoch 11 -1.2086851316474565 2.9573845455356036
epoch 12 -1.204326197996267 2.954464842457752
epoch 13 -1.2256913929987032 2.9687482324981542
epoch 14 -1.2262610353356678 2.969128118158355
epoch 15 -1.1875702525703957 2.943214400620766
epoch 16 -1.20499251704573 2.954911343402686
epoch 17 -1.2119057508076811 2.959539931928182
epoch 18 -1.2109503482620778 2.958900696422704
[32m[I 2022-03-04 19:14:29,667][0m Trial 1 finished with value: 2.968018032748572 and parameters: {'lr': 0.0026485424623962244, 'weight_decay': 0.061211516061747726, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 20}. Best is trial 1 with value: 2.968018032748572.[0m
epoch 19 -1.224596655889469 2.968018032748572

Previous best Test-set performance: 0.029479080716163675

Trial Id: 2 | Model params: 157906 | Timestamp: 2022-03-04 19:14:29.668137

epoch 0 -1.2781291589526664 3.0035168080658554
epoch 1 -1.282919577358784 3.0066730264722055
epoch 2 -1.2767286944979652 3.002593470343214
epoch 3 -1.2965834953134268 3.015657496183949
[32m[I 2022-03-04 19:22:27,303][0m Trial 2 finished with value: 3.008403419486135 and parameters: {'lr': 0.00012789684095729887, 'weight_decay': 0.2722760810346128, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 5}. Best is trial 1 with value: 2.968018032748572.[0m
epoch 4 -1.2855480539510227 3.008403419486135

Previous best Test-set performance: 0.029479080716163675

Trial Id: 3 | Model params: 157906 | Timestamp: 2022-03-04 19:22:27.303628

epoch 0 -1.25407438099329 2.987617651857603
epoch 1 -1.2719505348857538 2.999441051211516
epoch 2 -1.2590285890617814 2.9908990776236704
epoch 3 -1.265765044133195 2.995355209622914
epoch 4 -1.2934192368658857 3.01357927676112
epoch 5 -1.2623313011452626 2.993084634450543
epoch 6 -1.2564515526725066 2.9891926239689806
epoch 7 -1.2600201184928284 2.9915553860777186
epoch 8 -1.271909727594199 2.999414114090039
[32m[I 2022-03-04 19:34:29,444][0m Trial 3 finished with value: 3.0056584273060625 and parameters: {'lr': 0.0006859493120192947, 'weight_decay': 0.21111815385917254, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 10}. Best is trial 1 with value: 2.968018032748572.[0m
epoch 9 -1.2813790989155378 3.0056584273060625

Previous best Test-set performance: 0.029479080716163675

Trial Id: 4 | Model params: 157906 | Timestamp: 2022-03-04 19:34:29.445049

epoch 0 0.028762585662935436 1.9611174194331142
epoch 1 0.025741665506366807 1.9641649644685162
epoch 2 0.028853802057334565 1.961025325441628
epoch 3 0.02717033059144125 1.9627242976045784
epoch 4 0.028819933631665462 1.961059520221752
epoch 5 0.02854436913783609 1.9613377178829228
epoch 6 0.027891844778851982 1.961996320167739
epoch 7 0.028615616513339548 1.9612657934827262
epoch 8 0.02913686526650161 1.960739511329535
epoch 9 0.02986083803608719 1.9600083131323776
epoch 10 0.028403683603144825 1.9614797325295228
epoch 11 0.028662973037999917 1.961217985495735
epoch 12 0.02527202367877046 1.9646383208927634
epoch 13 0.028581538176507215 1.961300195976363
epoch 14 0.02886039555408948 1.9610186683409292
epoch 15 0.02701425404108737 1.9628817367542628
epoch 16 0.028833415131753748 1.961045908886037
epoch 17 0.027242344791181927 1.9626516504393499
epoch 18 0.029004287275030016 1.9608733829449045
[32m[I 2022-03-04 19:58:39,723][0m Trial 4 finished with value: 1.960947473638133 and parameters: {'lr': 0.00025828855079868305, 'weight_decay': 0.03209593899946365, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 20}. Best is trial 4 with value: 1.960947473638133.[0m
epoch 19 0.02893090864156389 1.960947473638133

Previous best Test-set performance: 0.029479080716163675

Trial Id: 5 | Model params: 157906 | Timestamp: 2022-03-04 19:58:39.723478

[32m[I 2022-03-04 19:59:51,897][0m Trial 5 pruned. [0m
epoch 0 -3.481035626884399e-05 1.9899788199112742

Previous best Test-set performance: 0.029479080716163675

Trial Id: 6 | Model params: 157906 | Timestamp: 2022-03-04 19:59:51.897896

[32m[I 2022-03-04 20:01:27,598][0m Trial 6 pruned. [0m
epoch 0 -8.049236335683219e-06 1.989952193629074

Previous best Test-set performance: 0.029479080716163675

Trial Id: 7 | Model params: 157906 | Timestamp: 2022-03-04 20:01:27.598704

epoch 0 -1.2807923190736603 3.0052718687553095
epoch 1 -1.2866576027618635 3.009133565022551
epoch 2 -1.282732309970573 3.006549705581342
epoch 3 -1.2911638890920347 3.0120971358191957
[32m[I 2022-03-04 20:07:20,559][0m Trial 7 finished with value: 3.015692608319262 and parameters: {'lr': 0.0016693020470771702, 'weight_decay': 0.2848913618444082, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 5}. Best is trial 4 with value: 1.960947473638133.[0m
epoch 4 -1.2966369751399602 3.015692608319262

Previous best Test-set performance: 0.029479080716163675

Trial Id: 8 | Model params: 157906 | Timestamp: 2022-03-04 20:07:20.560006

epoch 0 -1.3067689848516966 3.0223374114740182
epoch 1 -1.288359813318317 3.0102533710701294
epoch 2 -1.3001264586253924 3.017982742870562
epoch 3 -1.2844112835012376 3.007655176751662
epoch 4 -1.2838391499507926 3.0072785177403025
epoch 5 -1.2704134171240873 2.9984262240551867
epoch 6 -1.282937762021645 3.0066850013194544
epoch 7 -1.2826115433255487 3.0064701746346203
epoch 8 -1.2795504490960479 3.004453586212309
[32m[I 2022-03-04 20:23:15,092][0m Trial 8 finished with value: 2.9999918767647236 and parameters: {'lr': 0.0006814636294186981, 'weight_decay': 0.23049625013059435, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 10}. Best is trial 4 with value: 1.960947473638133.[0m
epoch 9 -1.2727850659190851 2.9999918767647236

Previous best Test-set performance: 0.029479080716163675

Trial Id: 9 | Model params: 157906 | Timestamp: 2022-03-04 20:23:15.092914

[32m[I 2022-03-04 20:24:25,491][0m Trial 9 pruned. [0m
epoch 0 -1.2261277001038793 2.969039203312479

Previous best Test-set performance: 0.029479080716163675

Trial Id: 10 | Model params: 157906 | Timestamp: 2022-03-04 20:24:25.491266

[32m[I 2022-03-04 20:25:37,314][0m Trial 10 pruned. [0m
epoch 0 0.03223186944384593 1.9576117063334093

Previous best Test-set performance: 0.029479080716163675

Trial Id: 11 | Model params: 157906 | Timestamp: 2022-03-04 20:25:37.314793

[32m[I 2022-03-04 20:26:48,214][0m Trial 11 pruned. [0m
epoch 0 0.027541981889429357 1.9623493508193788

Previous best Test-set performance: 0.029479080716163675

Trial Id: 12 | Model params: 157906 | Timestamp: 2022-03-04 20:26:48.214582

[32m[I 2022-03-04 20:27:59,110][0m Trial 12 pruned. [0m
epoch 0 0.031206370876417644 1.9586486264374048

Previous best Test-set performance: 0.029479080716163675

Trial Id: 13 | Model params: 157906 | Timestamp: 2022-03-04 20:27:59.110588

[32m[I 2022-03-04 20:29:11,340][0m Trial 13 pruned. [0m
epoch 0 0.021026266676097305 1.9689124945181404

Previous best Test-set performance: 0.029479080716163675

Trial Id: 14 | Model params: 157906 | Timestamp: 2022-03-04 20:29:11.341034

[32m[I 2022-03-04 20:30:22,487][0m Trial 14 pruned. [0m
epoch 0 -1.1852677024798752 2.941665037168391

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  8
  Number of complete trials:  7

Best trial:
  Value:  1.960947473638133
  Params: 
    lr: 0.00025828855079868305
    weight_decay: 0.03209593899946365
    criterion: MSELoss
    batch_size: 128
    epochs: 20
Target: 67698, NaN: 0, Max: 45.0, Min: 0.0, Mean: 3.3989925847144673
Prediction: 67698, NaN: 0, Max: 5.00814962387085, Min: 3.1167593002319336, Mean: 3.4534222233252825

 XXXXXX======== TRIAL des - qso ended

Test Set - R-squared:  0.02893090864156389
Test Set - RMSE:  1.960947473638133
Test Set - MAE:  1.5571764971312647



