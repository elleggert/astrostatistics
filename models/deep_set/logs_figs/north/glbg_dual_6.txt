[32m[I 2022-03-06 23:14:11,494][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: glbg
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 106032 | Timestamp: 2022-03-06 23:14:11.495557

[32m[I 2022-03-06 23:15:48,989][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 107198 | Timestamp: 2022-03-06 23:15:48.989645

epoch 0 0.18908712590439058 10.17505328965026
epoch 5 0.1902276181980016 10.167895521312413
epoch 10 0.18367793688148748 10.208933197839242
epoch 15 0.20726443528616612 10.060365656993545
epoch 20 0.20676357211004137 10.063543306175768
epoch 25 0.20575742438677502 10.069923624877243
epoch 30 0.19384127233864268 10.145182755042617
epoch 35 0.16776391492975906 10.307963356199947
epoch 40 0.19982941151818379 10.107433364493362
epoch 45 0.20749166846133815 10.05892368013668
epoch 50 0.208643053663232 10.051614037418755
epoch 55 0.21093431643175686 10.037051971610792
epoch 60 0.2025777695594645 10.090060356585878
epoch 65 0.21067827028431185 10.038680315165651
epoch 70 0.20332360201836253 10.085340614196516
[32m[I 2022-03-07 00:22:01,744][0m Trial 1 finished with value: 10.035663725907959 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.038953705371312486, 'n_units_l(Invariant)': 478, 'n_layers_mlp': 2, 'initialiser': 'xavier', 'lr': 0.0027214435669830083, 'weight_decay': 0.1049289123570142, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 75}. Best is trial 1 with value: 10.035663725907959.[0m

Trial Id: 2 | Model params: 67808 | Timestamp: 2022-03-07 00:22:01.744405

epoch 0 -5.860666054342829 29.595980666043864
epoch 5 -5.86517246693209 29.605699096060405
epoch 10 -5.860549842973368 29.595730004957797
epoch 15 -5.831789537843683 29.533630305517086
epoch 20 -5.840890394988969 29.553295130911778
epoch 25 -5.836689605480035 29.544219832989544
epoch 30 -5.827934241604603 29.525295961992505
epoch 35 -5.854158917826609 29.58194188526319
epoch 40 -5.837493327680934 29.545956393293046
epoch 45 -5.8715909010633105 29.619535444455163
epoch 50 -5.830145736053256 29.53007703775944
epoch 55 -5.841550435883573 29.554720816146922
epoch 60 -5.826650059832067 29.52251930740637
epoch 65 -5.851557576125241 29.576327772520695
epoch 70 -5.83644411452415 29.54368939323757
[32m[I 2022-03-07 01:58:45,078][0m Trial 2 finished with value: 29.592588231871087 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.22644298891133424, 'n_units_l(Invariant)': 175, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.002891354349999369, 'weight_decay': 0.1947348892650837, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 75}. Best is trial 1 with value: 10.035663725907959.[0m

Trial Id: 3 | Model params: 39086 | Timestamp: 2022-03-07 01:58:45.078682

epoch 0 -0.0754212896116746 11.717606504347872
epoch 5 0.17111479876680036 10.287190628950466
epoch 10 0.18743293615421786 10.185426101864477
epoch 15 0.18778021629890074 10.183249312756276
epoch 20 0.1902604886641932 10.16768915044495
[32m[I 2022-03-07 02:30:49,628][0m Trial 3 finished with value: 10.158435938736815 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.4538970582736939, 'n_units_l(Invariant)': 406, 'n_layers_mlp': 2, 'initialiser': 'normal', 'lr': 0.00018480948963965662, 'weight_decay': 0.07666239136145417, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 25}. Best is trial 1 with value: 10.035663725907959.[0m

Trial Id: 4 | Model params: 319356 | Timestamp: 2022-03-07 02:30:49.628484

epoch 0 0.14144599136250335 10.469679927503364
epoch 5 0.18296753365886487 10.213374387289026
epoch 10 0.15232106981824356 10.403160264524592
epoch 15 0.17528043986247288 10.26130844416418
epoch 20 0.18279764303672785 10.214436197198157
epoch 25 0.1809497138726932 10.225978562236598
epoch 30 0.18306551167578378 10.212761978228214
epoch 35 0.1765862034041774 10.253181954358883
epoch 40 0.18823449220520916 10.180401160127147
epoch 45 0.16670778755785987 10.314501807740399
[32m[I 2022-03-07 03:55:08,745][0m Trial 4 finished with value: 10.277827051119637 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.12211191963466533, 'n_units_l(Invariant)': 61, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0013982465443944793, 'weight_decay': 0.1875479986375567, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 50}. Best is trial 1 with value: 10.035663725907959.[0m

Trial Id: 5 | Model params: 110842 | Timestamp: 2022-03-07 03:55:08.746055

[32m[I 2022-03-07 03:56:10,359][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 26352 | Timestamp: 2022-03-07 03:56:10.359480

epoch 0 -7.253016965138418 32.460556696618276
epoch 5 -7.284400605640565 32.52221680255002
[32m[I 2022-03-07 04:07:33,946][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 257690 | Timestamp: 2022-03-07 04:07:33.947170

epoch 0 0.07289616141096023 10.879621444055394
epoch 5 0.20228273036336386 10.091926800654635
epoch 10 0.2005863715686509 10.102651425694066
epoch 15 0.188792271616268 10.176902986158645
epoch 20 0.22187289531315013 9.967238870100047
[32m[I 2022-03-07 04:36:31,224][0m Trial 7 finished with value: 9.941604394665818 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.16087017440394047, 'n_units_l(Invariant)': 332, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0005306310493546377, 'weight_decay': 0.04786579026002238, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 25}. Best is trial 7 with value: 9.941604394665818.[0m

Trial Id: 8 | Model params: 471580 | Timestamp: 2022-03-07 04:36:31.224696

[32m[I 2022-03-07 04:38:09,926][0m Trial 8 pruned. [0m
epoch 0 0.1454016013856515 10.445533640709177

Trial Id: 9 | Model params: 306972 | Timestamp: 2022-03-07 04:38:09.926184

epoch 0 -6.663545723952462 31.27983627543172
epoch 5 -6.565276916456161 31.078640258448036
epoch 10 -6.573193626483715 31.09489718148248
epoch 15 -6.60531836813471 31.160778136290578
epoch 20 -6.5962274548377975 31.142148762547368
epoch 25 -6.513753821442264 30.972629373264013
epoch 30 -6.502145227467574 30.948694089485258
epoch 35 -6.501223562869007 30.946792953811336
epoch 40 -6.503178129888885 30.950824538833874
[32m[I 2022-03-07 05:11:00,155][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 397014 | Timestamp: 2022-03-07 05:11:00.155473

[32m[I 2022-03-07 05:12:54,089][0m Trial 10 pruned. [0m
epoch 0 0.15164881926338913 10.407284552629653

Trial Id: 11 | Model params: 111228 | Timestamp: 2022-03-07 05:12:54.089797

[32m[I 2022-03-07 05:13:50,518][0m Trial 11 pruned. [0m
epoch 0 0.08295860518041032 10.820418661466194

Trial Id: 12 | Model params: 263624 | Timestamp: 2022-03-07 05:13:50.518230

[32m[I 2022-03-07 05:15:03,290][0m Trial 12 pruned. [0m
epoch 0 0.1306429368251112 10.53534321068621

Trial Id: 13 | Model params: 110448 | Timestamp: 2022-03-07 05:15:03.291150

epoch 0 0.052442182588423036 10.998981060202727
epoch 5 0.15918431336036232 10.360960010641202
epoch 10 0.20241182274400804 10.091110193307271
epoch 15 0.19761882836551348 10.121385334157784
epoch 20 0.21703691881334286 9.998163556405547
[32m[I 2022-03-07 05:38:33,294][0m Trial 13 finished with value: 10.016903489991117 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.18522536739929835, 'n_units_l(Invariant)': 503, 'n_layers_mlp': 2, 'initialiser': 'kaiming_he', 'lr': 0.0005158994796549513, 'weight_decay': 0.048936991035287467, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 25}. Best is trial 7 with value: 9.941604394665818.[0m

Trial Id: 14 | Model params: 33212 | Timestamp: 2022-03-07 05:38:33.294610

epoch 0 0.03985030962647185 11.071821305744635
epoch 5 0.18763672643186713 10.184148779002902
epoch 10 0.19962772276133456 10.10870710990315
epoch 15 0.20237729829644513 10.091328593131031
epoch 20 0.2090914170081981 10.048766135564321
[32m[I 2022-03-07 05:53:08,142][0m Trial 14 finished with value: 10.054144206961933 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.19241694316857472, 'n_units_l(Invariant)': 317, 'n_layers_mlp': 2, 'initialiser': 'kaiming_he', 'lr': 0.00037444592605293133, 'weight_decay': 0.05758373628471365, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 25}. Best is trial 7 with value: 9.941604394665818.[0m

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  8
  Number of complete trials:  7

Best trial:
  Value:  9.941604394665818
  Params: 
    n_layers_fe: 2
    fe_neurons: 256
    fe_dropout: 0.16087017440394047
    n_units_l(Invariant): 332
    n_layers_mlp: 2
    initialiser: uniform
    lr: 0.0005306310493546377
    weight_decay: 0.04786579026002238
    criterion: MSELoss
    batch_size: 256
    epochs: 25
Target: 72610, NaN: 0, Max: 135.0, Min: 0.0, Mean: 30.72970665197631
Prediction: 72610, NaN: 0, Max: 60.092811584472656, Min: 9.883185386657715, Mean: 31.054703807108428

 XXXXXX======== TRIAL north - glbg ended

Test Set - R-squared:  0.22587023700131148
Test Set - RMSE:  9.941604394665818
Test Set - MAE:  7.740048174798333



[32m[I 2022-03-07 05:53:43,329][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: glbg
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 15

+++++++++++++++++++++++++++++++++++++++

Previous best Test-set performance: 0.22587023700131148

Trial Id: 0 | Model params: 257690 | Timestamp: 2022-03-07 05:53:43.330345

epoch 0 -0.7614853630849991 14.996472454749965
epoch 1 -1.6020321891402811 18.22661109973062
epoch 2 -2.2858043316375807 20.481909537141885
epoch 3 -2.6788741490975516 21.672402627980084
[32m[I 2022-03-07 05:59:48,168][0m Trial 0 finished with value: 23.182019087329838 and parameters: {'lr': 2.2001682934901144e-05, 'weight_decay': 0.23434468130665678, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 5}. Best is trial 0 with value: 23.182019087329838.[0m
epoch 4 -3.20923650940464 23.182019087329838

Previous best Test-set performance: 0.22587023700131148

Trial Id: 1 | Model params: 257690 | Timestamp: 2022-03-07 05:59:48.168182

epoch 0 0.23186929476544904 9.90300863453335
epoch 1 0.22724219332557305 9.93279095266643
epoch 2 0.2324313197874286 9.89938506040492
epoch 3 0.22990209520495608 9.915681436899977
epoch 4 0.22974873881646718 9.916668686305778
epoch 5 0.23076965897231871 9.91009454329466
epoch 6 0.2282854518025228 9.926083826522678
epoch 7 0.2279696516422215 9.928114589222504
epoch 8 0.22776986221235607 9.929399126836485
epoch 9 0.22709238853493985 9.933753678341441
epoch 10 0.23098656344320445 9.908697240529818
epoch 11 0.2316005430372654 9.904740903476537
epoch 12 0.23089664632121143 9.909276512265366
epoch 13 0.23220437155324725 9.900848435588092
epoch 14 0.23196468344086163 9.902393723426101
epoch 15 0.231964313989933 9.902396105118738
epoch 16 0.22380975650500223 9.954826253775462
epoch 17 0.2311839045211952 9.907425794307748
epoch 18 0.22932630925830477 9.919387617116426
[32m[I 2022-03-07 06:23:01,787][0m Trial 1 finished with value: 9.920648474831077 and parameters: {'lr': 4.5763080602014784e-05, 'weight_decay': 0.17039335995276725, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 20}. Best is trial 1 with value: 9.920648474831077.[0m
epoch 19 0.2291303754641646 9.920648474831077

Previous best Test-set performance: 0.22587023700131148

Trial Id: 2 | Model params: 257690 | Timestamp: 2022-03-07 06:23:01.788020

[32m[I 2022-03-07 06:24:24,513][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Previous best Test-set performance: 0.22587023700131148

Trial Id: 3 | Model params: 257690 | Timestamp: 2022-03-07 06:24:24.513183

[32m[I 2022-03-07 06:25:34,147][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Previous best Test-set performance: 0.22587023700131148

Trial Id: 4 | Model params: 257690 | Timestamp: 2022-03-07 06:25:34.147460

epoch 0 0.185084225173624 10.200135878539552
epoch 1 0.18463629935009562 10.202938791884844
epoch 2 0.17976579843898743 10.233366583602663
epoch 3 0.1789674283019227 10.238345665902905
epoch 4 0.13921115719730026 10.483297470243794
epoch 5 0.18959505380663044 10.171866138979775
epoch 6 0.1870156475577578 10.188041096255612
epoch 7 0.19461198902216437 10.140332015939947
epoch 8 0.18964791330500408 10.171534398340652
[32m[I 2022-03-07 06:36:56,448][0m Trial 4 finished with value: 10.266369502136182 and parameters: {'lr': 0.002686595184390015, 'weight_decay': 0.16976021558802762, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 10}. Best is trial 1 with value: 9.920648474831077.[0m
epoch 9 0.17446670682620524 10.266369502136182

Previous best Test-set performance: 0.22587023700131148

Trial Id: 5 | Model params: 257690 | Timestamp: 2022-03-07 06:36:56.448234

epoch 0 0.22862119045443796 9.92392439299082
epoch 1 0.22812581771025753 9.927110410413341
epoch 2 0.22937826272710937 9.919053263364065
epoch 3 0.22801094116872223 9.92784909925028
[32m[I 2022-03-07 06:42:37,127][0m Trial 5 finished with value: 9.909849712302876 and parameters: {'lr': 0.00032068308350825716, 'weight_decay': 0.1077021049432501, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 5}. Best is trial 5 with value: 9.909849712302876.[0m
epoch 4 0.23080766650092444 9.909849712302876

Previous best Test-set performance: 0.22587023700131148

Trial Id: 6 | Model params: 257690 | Timestamp: 2022-03-07 06:42:37.127885

epoch 0 0.2313773784446589 9.906179105301353
epoch 1 0.23068039048899092 9.91066955535402
epoch 2 0.23135217436742272 9.90634152184331
epoch 3 0.23114178728739254 9.907697164571983
epoch 4 0.23072779482361094 9.91036421026236
epoch 5 0.23072171174202927 9.910403393684309
epoch 6 0.2299544988768174 9.915344059695652
epoch 7 0.22985358001942058 9.91599376962112
epoch 8 0.2299613471090438 9.915299969619417
epoch 9 0.22958791859105443 9.917703879455201
epoch 10 0.2295017401566849 9.918258562016215
epoch 11 0.2306864319224854 9.91063064124874
epoch 12 0.2293080401956682 9.919505187523932
epoch 13 0.2302403589112919 9.913503477749893
epoch 14 0.22951379492876478 9.918180974031737
epoch 15 0.22943972952764768 9.918657670690559
epoch 16 0.22741939389622812 9.931652046580334
epoch 17 0.22946130758807715 9.918518793239203
epoch 18 0.22927239172935499 9.919734598933372
[32m[I 2022-03-07 07:05:47,331][0m Trial 6 finished with value: 9.932841035949268 and parameters: {'lr': 1.161525471939244e-05, 'weight_decay': 0.2649768035852721, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 20}. Best is trial 5 with value: 9.909849712302876.[0m
epoch 19 0.22723440048153665 9.932841035949268

Previous best Test-set performance: 0.22587023700131148

Trial Id: 7 | Model params: 257690 | Timestamp: 2022-03-07 07:05:47.331471

[32m[I 2022-03-07 07:06:55,489][0m Trial 7 pruned. [0m
epoch 0 0.2317635085034141 9.903690527727429

Previous best Test-set performance: 0.22587023700131148

Trial Id: 8 | Model params: 257690 | Timestamp: 2022-03-07 07:06:55.489539

[32m[I 2022-03-07 07:08:03,702][0m Trial 8 pruned. [0m
epoch 0 0.232201456898255 9.900867228043314

Previous best Test-set performance: 0.22587023700131148

Trial Id: 9 | Model params: 257690 | Timestamp: 2022-03-07 07:08:03.702280

epoch 0 -1.1574650725175668 16.596689977625655
epoch 1 -2.318878413802104 20.584734314690866
epoch 2 -2.9307027056239443 22.40189171266052
epoch 3 -3.5376943594681416 24.0695081012759
epoch 4 -3.7662140867112646 24.668137908005594
epoch 5 -4.290317396585685 25.989053256446677
epoch 6 -4.630068388500339 26.810593618136334
epoch 7 -4.923974280976132 27.50148701554981
epoch 8 -5.12954155144996 27.974581065909632
epoch 9 -5.198728912014075 28.132019946393374
epoch 10 -5.255080730689935 28.259602865218977
epoch 11 -5.6156804456947995 29.06275993237046
epoch 12 -5.882368546911795 29.642754506345046
epoch 13 -5.8782142111405085 29.633806675121036
epoch 14 -5.879984350750855 29.637619627064616
epoch 15 -5.882446994831745 29.64292344570003
epoch 16 -5.829186846392618 29.52800408935227
[32m[I 2022-03-07 07:29:02,150][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Previous best Test-set performance: 0.22587023700131148

Trial Id: 10 | Model params: 257690 | Timestamp: 2022-03-07 07:29:02.151156

epoch 0 0.13151967795179187 10.530029456965982
epoch 1 0.15454396981206042 10.389511013326674
epoch 2 0.10844758775870933 10.668983278242791
epoch 3 0.188970899931995 10.17578244510497
[32m[I 2022-03-07 07:34:29,182][0m Trial 10 finished with value: 10.24844181573004 and parameters: {'lr': 0.00814279240889285, 'weight_decay': 0.11111783482330413, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 5}. Best is trial 5 with value: 9.909849712302876.[0m
epoch 4 0.17734737068746087 10.24844181573004

Previous best Test-set performance: 0.22587023700131148

Trial Id: 11 | Model params: 257690 | Timestamp: 2022-03-07 07:34:29.182664

[32m[I 2022-03-07 07:35:37,261][0m Trial 11 pruned. [0m
epoch 0 0.23161246278341663 9.904664079856962

Previous best Test-set performance: 0.22587023700131148

Trial Id: 12 | Model params: 257690 | Timestamp: 2022-03-07 07:35:37.262053

[32m[I 2022-03-07 07:36:59,289][0m Trial 12 pruned. [0m
epoch 0 0.22720442117830508 9.93303370547644

Previous best Test-set performance: 0.22587023700131148

Trial Id: 13 | Model params: 257690 | Timestamp: 2022-03-07 07:36:59.289954

[32m[I 2022-03-07 07:38:07,397][0m Trial 13 pruned. [0m
epoch 0 0.21835713083650599 9.989730678153565

Previous best Test-set performance: 0.22587023700131148

Trial Id: 14 | Model params: 257690 | Timestamp: 2022-03-07 07:38:07.398033

[32m[I 2022-03-07 07:39:29,158][0m Trial 14 pruned. [0m
epoch 0 0.2299462970079006 9.915396864455614

Study statistics: 
  Number of finished trials:  15
  Number of pruned trials:  9
  Number of complete trials:  6

Best trial:
  Value:  9.909849712302876
  Params: 
    lr: 0.00032068308350825716
    weight_decay: 0.1077021049432501
    criterion: MSELoss
    batch_size: 256
    epochs: 5
Target: 72610, NaN: 0, Max: 135.0, Min: 0.0, Mean: 30.72970665197631
Prediction: 72610, NaN: 0, Max: 61.13066482543945, Min: 13.274694442749023, Mean: 31.027974806172086

 XXXXXX======== TRIAL north - glbg ended

Test Set - R-squared:  0.23080766650092444
Test Set - RMSE:  9.909849712302876
Test Set - MAE:  7.711128869704875



