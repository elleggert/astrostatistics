[32m[I 2022-02-23 17:20:00,208][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: qso
Training Set: 232352
Validation Set: 58087
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 20

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 90693 | Timestamp: 2022-02-23 17:20:00.208962

[32m[I 2022-02-23 17:22:18,638][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 57472 | Timestamp: 2022-02-23 17:22:18.639105

epoch 0 0.07359855768648293 2.3514627369349586
epoch 5 0.08288123375673584 2.339652078429474
epoch 10 0.082449755120514 2.340202384025976
epoch 15 0.0803258722998963 2.342909289045583
epoch 20 0.06768927274024772 2.3589505139308278
epoch 25 0.07451883828204364 2.350294483560588
epoch 30 0.08145118995502476 2.341475452801063
epoch 35 0.08255485922618466 2.3400683467216585
epoch 40 0.07389555098978018 2.351085781203311
epoch 45 0.08381059587657402 2.3384663349753385
epoch 50 0.08430113996094246 2.3378402229452875
epoch 55 0.08362340579562866 2.338705213172297
epoch 60 0.07528908010366464 2.349316250833895
epoch 65 0.08315065541371969 2.3393083938030217
epoch 70 0.06826625993205693 2.3582204489189578
epoch 75 0.08213664972376766 2.3406016360022917
epoch 80 0.08458315682782303 2.337480191293439
epoch 85 0.08357413330294117 2.3387680870427605
epoch 90 0.08135122980150522 2.3416028536946416
epoch 95 0.08187058144353565 2.3409408557386913
[32m[I 2022-02-23 18:41:27,453][0m Trial 1 finished with value: 2.339656031479134 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 31, 'fe_dropout_l0': 0.11040682485986675, 'fe_n_units_l1': 235, 'fe_dropout_l1': 0.46975016043722645, 'fe_n_units_l2': 8, 'fe_dropout_l2': 0.475996083905412, 'fe_n_units_l3': 162, 'fe_dropout_l3': 0.15573967360369922, 'n_units_l(Invariant)': 186, 'n_layers_mlp': 2, 'mlp_n_units_l0': 208, 'mlp_dropout_l0': 0.04074468108633378, 'mlp_n_units_l1': 53, 'mlp_dropout_l1': 0.292974181597725, 'reduction': 'sum', 'lr': 0.0006102653261312606, 'weight_decay': 0.14413009351823403, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 1 with value: 2.339656031479134.[0m

Trial Id: 2 | Model params: 144628 | Timestamp: 2022-02-23 18:41:27.453589

epoch 0 0.009345192930210189 2.4316421640692125
epoch 5 0.061303303965379974 2.367015677127428
epoch 10 0.06573856362036168 2.3614170852261913
epoch 15 0.047598335522298085 2.384232274529285
epoch 20 0.06244593230738815 2.3655746138102356
epoch 25 0.04443321349426166 2.388190754985884
epoch 30 0.014029489750326807 2.4258863596772904
epoch 35 0.05729047701476642 2.3720696497243243
epoch 40 0.060968710053009634 2.3674374952060493
epoch 45 0.06325275991345214 2.3645565276182863
epoch 50 -0.0025430996825464014 2.446189038767417
epoch 55 0.05865922987372252 2.370346978838376
epoch 60 0.06762271398346076 2.3590347165506076
epoch 65 0.022048719195621458 2.416000943857688
epoch 70 0.05993716183741238 2.3687374814975737
epoch 75 0.06744029640544502 2.359265475257254
epoch 80 0.06947260866028715 2.3566933186127015
epoch 85 0.07003293731359161 2.3559836556527785
epoch 90 0.057030023687215325 2.3723973067340705
epoch 95 0.03531296237196502 2.3995605384515817
[32m[I 2022-02-23 22:01:24,118][0m Trial 2 finished with value: 2.3663857234536576 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 160, 'fe_dropout_l0': 0.10310488353872388, 'fe_n_units_l1': 219, 'fe_dropout_l1': 0.0649602145933807, 'n_units_l(Invariant)': 248, 'n_layers_mlp': 4, 'mlp_n_units_l0': 229, 'mlp_dropout_l0': 0.1689933643543471, 'mlp_n_units_l1': 81, 'mlp_dropout_l1': 0.40991059127255924, 'mlp_n_units_l2': 135, 'mlp_dropout_l2': 0.10385459156350707, 'mlp_n_units_l3': 136, 'mlp_dropout_l3': 0.36768044456517923, 'reduction': 'sum', 'lr': 0.001978312571082144, 'weight_decay': 0.2823220264596028, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 1 with value: 2.339656031479134.[0m

Trial Id: 3 | Model params: 162829 | Timestamp: 2022-02-23 22:01:24.118355

[32m[I 2022-02-23 22:02:30,952][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 57712 | Timestamp: 2022-02-23 22:02:30.952936

[32m[I 2022-02-23 22:03:09,059][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 162042 | Timestamp: 2022-02-23 22:03:09.059929

[32m[I 2022-02-23 22:04:04,826][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 117108 | Timestamp: 2022-02-23 22:04:04.826848

[32m[I 2022-02-23 22:04:49,649][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 161571 | Timestamp: 2022-02-23 22:04:49.649621

epoch 0 0.10792448554999357 2.3074871928114775
epoch 5 0.11570408292341072 2.297403612442099
epoch 10 0.12016697452892244 2.291598976113074
epoch 15 0.12262971114368304 2.2883895265213727
epoch 20 0.11765062939088688 2.294873652448703
epoch 25 0.12179744590448438 2.289474641686584
epoch 30 0.12192606853821952 2.2893069759014457
epoch 35 0.12421161736321817 2.286325602728781
epoch 40 0.12437540222459398 2.286111805058843
epoch 45 0.1223650536846459 2.2887346451670574
epoch 50 0.12492890465644135 2.285389138931638
epoch 55 0.12482473895845747 2.2855251576346083
epoch 60 0.12307837578769665 2.28780433986849
epoch 65 0.12291261235511453 2.2880205600928103
epoch 70 0.11799042715446939 2.294431725446249
epoch 75 0.12018638727808217 2.2915736949061856
epoch 80 0.12308052385390622 2.287801537817503
epoch 85 0.12509362139653635 2.2851740366575926
epoch 90 0.12191705444884016 2.2893187266003316
epoch 95 0.12096175833400513 2.2905637016894933
[32m[I 2022-02-24 01:23:28,495][0m Trial 7 finished with value: 2.284800309440577 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 152, 'fe_dropout_l0': 0.08012820488441569, 'fe_n_units_l1': 208, 'fe_dropout_l1': 0.06855881013790027, 'n_units_l(Invariant)': 242, 'n_layers_mlp': 4, 'mlp_n_units_l0': 214, 'mlp_dropout_l0': 0.36593735508345077, 'mlp_n_units_l1': 181, 'mlp_dropout_l1': 0.010395373462992963, 'mlp_n_units_l2': 108, 'mlp_dropout_l2': 0.12378714693398651, 'mlp_n_units_l3': 132, 'mlp_dropout_l3': 0.40059020765003284, 'reduction': 'sum', 'lr': 0.0002129782693067251, 'weight_decay': 0.01091575020984078, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 7 with value: 2.284800309440577.[0m

Trial Id: 8 | Model params: 67135 | Timestamp: 2022-02-24 01:23:28.496086

[32m[I 2022-02-24 01:24:12,558][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 88332 | Timestamp: 2022-02-24 01:24:12.559085

[32m[I 2022-02-24 01:25:01,638][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 237324 | Timestamp: 2022-02-24 01:25:01.639053

epoch 0 -0.1985668860184273 2.6746664316458237
epoch 5 0.04792429042911661 2.3838242435779526
epoch 10 0.0503250338075395 2.380816834346713
epoch 15 0.04820653473201353 2.3834708732119325
epoch 20 0.05477526836377855 2.3752319577710903
epoch 25 0.05622799342947615 2.3734059973906803
epoch 30 0.04716726019081896 2.3847717882050965
epoch 35 0.03899579455847657 2.394975823990122
epoch 40 0.06282220357968671 2.3650998747393754
epoch 45 0.05489110161366939 2.375086416051091
epoch 50 0.0485423099056409 2.3830504138519824
epoch 55 0.052704991588799266 2.377831708794694
epoch 60 -0.021206834434373878 2.4688536481775
epoch 65 0.04047314017924797 2.393134225437601
epoch 70 0.0569127476803013 2.372544828203386
epoch 75 0.05482327064182624 2.3751716451339795
epoch 80 0.047257536280668644 2.384658812987711
epoch 85 0.05192962130785472 2.3788046490648247
epoch 90 0.04913989940276886 2.38230192572018
epoch 95 0.037946603070470264 2.3962828436495465
[32m[I 2022-02-24 04:59:45,697][0m Trial 10 finished with value: 2.4036414679051954 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 76, 'fe_dropout_l0': 0.17458198429761074, 'fe_n_units_l1': 81, 'fe_dropout_l1': 0.20534443932610613, 'fe_n_units_l2': 241, 'fe_dropout_l2': 0.016388874886910543, 'fe_n_units_l3': 254, 'fe_dropout_l3': 0.4910171294390121, 'n_units_l(Invariant)': 105, 'n_layers_mlp': 4, 'mlp_n_units_l0': 142, 'mlp_dropout_l0': 0.3133115023087474, 'mlp_n_units_l1': 245, 'mlp_dropout_l1': 0.0001234292744017873, 'mlp_n_units_l2': 213, 'mlp_dropout_l2': 0.016990538058200944, 'mlp_n_units_l3': 148, 'mlp_dropout_l3': 0.481325117351452, 'reduction': 'sum', 'lr': 0.007924168784396246, 'weight_decay': 0.0013970122014588821, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 7 with value: 2.284800309440577.[0m

Trial Id: 11 | Model params: 51647 | Timestamp: 2022-02-24 04:59:45.697676

epoch 0 -0.11359236717291155 2.5781110035294077
epoch 5 0.03243279725779746 2.403139927159646
epoch 10 0.07868360198664481 2.345000233041062
epoch 15 0.06481670704659126 2.362581829401384
epoch 20 0.07299686139902262 2.3522262486645933
epoch 25 0.07274193234676618 2.3525496615865436
epoch 30 0.07603016883618685 2.3483746588527183
epoch 35 0.08193090966314132 2.3408639454953524
epoch 40 0.07675336380384434 2.347455437720557
epoch 45 0.07618518061136703 2.3481776605408973
epoch 50 0.08151713759053358 2.341391397637257
epoch 55 0.07764230889034085 2.34632504555633
epoch 60 0.06933260052753298 2.356870607225389
epoch 65 0.07176504903225933 2.3537885623950845
epoch 70 0.08002378423381273 2.3432940486054954
epoch 75 0.060366324916664715 2.3681967247098905
epoch 80 0.07224877170648925 2.3531751782136134
epoch 85 0.0784047080467345 2.3453551365622727
epoch 90 0.0823500234622715 2.3403295628502305
epoch 95 0.07922463037929617 2.344311599895064
[32m[I 2022-02-24 06:21:36,833][0m Trial 11 finished with value: 2.357022124329623 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 15, 'fe_dropout_l0': 0.002087315489957206, 'fe_n_units_l1': 248, 'fe_dropout_l1': 0.4959743136544512, 'fe_n_units_l2': 22, 'fe_dropout_l2': 0.4853996393816965, 'fe_n_units_l3': 217, 'fe_dropout_l3': 0.12838312308456626, 'n_units_l(Invariant)': 132, 'n_layers_mlp': 2, 'mlp_n_units_l0': 256, 'mlp_dropout_l0': 0.04198732519462442, 'mlp_n_units_l1': 9, 'mlp_dropout_l1': 0.2686568643418828, 'reduction': 'sum', 'lr': 0.00020776887297373905, 'weight_decay': 0.15267448172920953, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 7 with value: 2.284800309440577.[0m

Trial Id: 12 | Model params: 68751 | Timestamp: 2022-02-24 06:21:36.833237

[32m[I 2022-02-24 06:23:38,065][0m Trial 12 pruned. [0m
epoch 0 0.029537510082199403 2.4067327437411437

Trial Id: 13 | Model params: 126675 | Timestamp: 2022-02-24 06:23:38.065701

[32m[I 2022-02-24 06:24:32,774][0m Trial 13 pruned. [0m
epoch 0 0.025689468237923507 2.4114995667808667

Trial Id: 14 | Model params: 117046 | Timestamp: 2022-02-24 06:24:32.774605

[32m[I 2022-02-24 06:26:40,540][0m Trial 14 pruned. [0m
epoch 0 0.07592993697582184 2.3485020307482953

Trial Id: 15 | Model params: 56418 | Timestamp: 2022-02-24 06:26:40.540645

epoch 0 0.006958844130649511 2.4345691453039318
epoch 5 0.09564764029372774 2.323310888292707
epoch 10 0.09598919039491272 2.3228721201520646
epoch 15 0.10068974630719207 2.3168251676690628
epoch 20 0.09976356588142254 2.3180178850420776
epoch 25 0.101708983999238 2.3155119028745745
epoch 30 0.10248107050899036 2.3145165907832554
epoch 35 0.10160139051811257 2.3156505698111096
epoch 40 0.09789693845719516 2.320419829122369
epoch 45 0.10213006093389021 2.3149691372656136
epoch 50 0.1032355819359223 2.313543521396446
epoch 55 0.10290112202126467 2.3139749142004327
epoch 60 0.10108759493977859 2.3163126372674845
epoch 65 0.10310445391169987 2.313712662419241
epoch 70 0.0996060415133978 2.318220680839177
epoch 75 0.10416186261034388 2.3123483667507783
epoch 80 0.10381337089860443 2.31279808855447
epoch 85 0.1032376864905572 2.313540806646898
epoch 90 0.10085522937526015 2.3166119970895984
epoch 95 0.10390298695976741 2.312682449116246
[32m[I 2022-02-24 07:33:01,734][0m Trial 15 finished with value: 2.314028997668644 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 208, 'fe_dropout_l0': 0.08877926267614136, 'fe_n_units_l1': 102, 'fe_dropout_l1': 0.00773173726226236, 'n_units_l(Invariant)': 175, 'n_layers_mlp': 2, 'mlp_n_units_l0': 107, 'mlp_dropout_l0': 0.38195377739924197, 'mlp_n_units_l1': 121, 'mlp_dropout_l1': 0.3124653240007826, 'reduction': 'sum', 'lr': 9.597414426780444e-05, 'weight_decay': 0.09106598946812863, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 7 with value: 2.284800309440577.[0m

Trial Id: 16 | Model params: 57166 | Timestamp: 2022-02-24 07:33:01.735114

epoch 0 -2.0482251735473556 4.265422076422783
epoch 5 -1.7608420249829115 4.059375892583106
epoch 10 -1.8163505253871608 4.099980988906429
epoch 15 -1.789187270232563 4.080161249628424
epoch 20 -1.759888901573265 4.058675124457868
epoch 25 -1.792554095407298 4.082623086221823
epoch 30 -2.296245123586774 4.435557768651703
epoch 35 -2.5635453597244084 4.611897381482927
epoch 40 -2.400866304491405 4.505399114020203
epoch 45 -2.395806070043311 4.5020460179791675
epoch 50 -1.6102029955384274 3.9470772984454374
epoch 55 -1.7740168870324835 4.069050126821388
epoch 60 -1.498235740468366 3.861492523528683
epoch 65 -1.4665285053921804 3.8369095302026657
epoch 70 -1.4568788523658487 3.829396718346863
epoch 75 -1.4861649089413733 3.8521523589931586
epoch 80 -1.4644356408070882 3.8352813641016943
epoch 85 -1.4495091006015501 3.8236489992983596
epoch 90 -1.4626541199923233 3.833894866372147
epoch 95 -1.4536250220026834 3.826860098452997
[32m[I 2022-02-24 08:50:35,953][0m Trial 16 finished with value: 3.809030131635064 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 217, 'fe_dropout_l0': 0.05900089865638547, 'fe_n_units_l1': 84, 'fe_dropout_l1': 0.022083051583431823, 'n_units_l(Invariant)': 277, 'n_layers_mlp': 2, 'mlp_n_units_l0': 95, 'mlp_dropout_l0': 0.3807517469787789, 'mlp_n_units_l1': 119, 'mlp_dropout_l1': 0.2007579091283991, 'reduction': 'sum', 'lr': 8.081541060523782e-05, 'weight_decay': 0.00527292103648858, 'criterion': 'PoissonNLLLoss', 'batch_size': 128}. Best is trial 7 with value: 2.284800309440577.[0m

Trial Id: 17 | Model params: 57067 | Timestamp: 2022-02-24 08:50:35.953269

epoch 0 -0.03054447128148774 2.480115225853246
epoch 5 0.10118705760316749 2.316184486295186
epoch 10 0.10522895295640333 2.3109707630583913
epoch 15 0.09822157454781699 2.320002271618543
epoch 20 0.10421488591209827 2.3122799335403585
epoch 25 0.10384947039107395 2.3127515069188678
epoch 30 0.09900691641520931 2.318991828408208
epoch 35 0.10747572901339697 2.3080675079027406
epoch 40 0.10255844181091955 2.314416826301628
epoch 45 0.10814522279196026 2.3072016901477186
epoch 50 0.10820049319620306 2.307130197596978
epoch 55 0.10380689617443595 2.3128064432331428
epoch 60 0.10029899965160927 2.3173284385742297
epoch 65 0.1027129627032809 2.3142175703471315
epoch 70 0.1085937284334324 2.306621481839031
epoch 75 0.10543657498260017 2.3107026295114226
epoch 80 0.10766080138552492 2.3078281969457857
epoch 85 0.09889176455478532 2.319140013614391
epoch 90 0.10714354732565912 2.3084969788205396
epoch 95 0.1023930071503859 2.3146301366363513
[32m[I 2022-02-24 11:35:08,535][0m Trial 17 finished with value: 2.3069648185604685 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 192, 'fe_dropout_l0': 0.19032854135929517, 'fe_n_units_l1': 114, 'fe_dropout_l1': 0.15455620242567442, 'n_units_l(Invariant)': 83, 'n_layers_mlp': 4, 'mlp_n_units_l0': 107, 'mlp_dropout_l0': 0.36407588708626903, 'mlp_n_units_l1': 168, 'mlp_dropout_l1': 0.10669259511397361, 'mlp_n_units_l2': 14, 'mlp_dropout_l2': 0.18741699814842405, 'mlp_n_units_l3': 82, 'mlp_dropout_l3': 0.17007947323735678, 'reduction': 'sum', 'lr': 0.00011097429270296546, 'weight_decay': 0.07593601130542654, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 7 with value: 2.284800309440577.[0m

Trial Id: 18 | Model params: 40517 | Timestamp: 2022-02-24 11:35:08.536093

[32m[I 2022-02-24 11:36:11,296][0m Trial 18 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 19 | Model params: 126897 | Timestamp: 2022-02-24 11:36:11.296310

[32m[I 2022-02-24 11:37:15,787][0m Trial 19 pruned. [0m
epoch 0 0.07791860155446806 2.3459735978702323

Study statistics: 
  Number of finished trials:  20
  Number of pruned trials:  12
  Number of complete trials:  8

Best trial:
  Value:  2.284800309440577
  Params: 
    n_layers_fe: 2
    fe_n_units_l0: 152
    fe_dropout_l0: 0.08012820488441569
    fe_n_units_l1: 208
    fe_dropout_l1: 0.06855881013790027
    n_units_l(Invariant): 242
    n_layers_mlp: 4
    mlp_n_units_l0: 214
    mlp_dropout_l0: 0.36593735508345077
    mlp_n_units_l1: 181
    mlp_dropout_l1: 0.010395373462992963
    mlp_n_units_l2: 108
    mlp_dropout_l2: 0.12378714693398651
    mlp_n_units_l3: 132
    mlp_dropout_l3: 0.40059020765003284
    reduction: sum
    lr: 0.0002129782693067251
    weight_decay: 0.01091575020984078
    criterion: MSELoss
    batch_size: 32
Target: 72610, NaN: 0, Max: 64.0, Min: 0.0, Mean: 4.437694532433549
Prediction: 72610, NaN: 0, Max: 8.203437805175781, Min: 3.3058652877807617, Mean: 4.41709433403115

 XXXXXX======== TRIAL north - qso ended

Test Set - R-squared:  0.12876160874765996
Test Set - RMSE:  2.310223286306026
Test Set - MAE:  1.7961177343836896



