[32m[I 2022-03-01 16:05:59,315][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: elg
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 413526 | Timestamp: 2022-03-01 16:05:59.315905

epoch 0 -13.381644900753896 29.49659878910337
epoch 5 -12.859979834622433 28.956692852273584
epoch 10 -12.86741005205454 28.964453530812534
epoch 15 -12.860413198660153 28.957145547421522
epoch 20 -12.893777083711562 28.991976477902686
epoch 25 -12.854508878821264 28.950977244275016
epoch 30 -12.864033751921102 28.960927326529315
epoch 35 -12.872029928268308 28.9692778291677
epoch 40 -12.861815231367158 28.958610072250153
epoch 45 -12.890113168176214 28.988153501746872
epoch 50 -12.86813621017324 28.965211873490492
epoch 55 -12.878371236703344 28.97589842246195
[32m[I 2022-03-01 17:33:22,262][0m Trial 0 finished with value: 28.960618664678346 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.1154251713317434, 'n_units_l(Invariant)': 426, 'n_layers_mlp': 4, 'lr': 2.861003001599217e-05, 'weight_decay': 0.2833218593063263, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 60}. Best is trial 0 with value: 28.960618664678346.[0m

Trial Id: 1 | Model params: 34206 | Timestamp: 2022-03-01 17:33:22.262722

epoch 0 0.03419969711247273 7.643835442886294
epoch 5 0.11078964273048841 7.334489929686961
epoch 10 0.09494352926948812 7.399553238242155
epoch 15 0.09739818026618963 7.389512067623925
[32m[I 2022-03-01 18:01:07,907][0m Trial 1 finished with value: 7.317698601008332 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.21689381759931226, 'n_units_l(Invariant)': 206, 'n_layers_mlp': 4, 'lr': 0.0010507176215368336, 'weight_decay': 0.2589109862568354, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 20}. Best is trial 1 with value: 7.317698601008332.[0m

Trial Id: 2 | Model params: 34008 | Timestamp: 2022-03-01 18:01:07.907546

epoch 0 -15.944262949506335 32.01687950409052
epoch 5 -14.268130721290023 30.392091994347368
epoch 10 -14.213006500081537 30.337178418634203
epoch 15 -14.45632615613218 30.57882525311562
[32m[I 2022-03-01 18:11:24,895][0m Trial 2 finished with value: 30.624874715299935 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.2089535350254489, 'n_units_l(Invariant)': 203, 'n_layers_mlp': 2, 'lr': 0.00011192157473998827, 'weight_decay': 0.10401962989576467, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 20}. Best is trial 1 with value: 7.317698601008332.[0m

Trial Id: 3 | Model params: 26946 | Timestamp: 2022-03-01 18:11:24.895350

epoch 0 0.0924709950070054 7.4096538071101286
epoch 5 0.10677806429122016 7.35101569972228
epoch 10 0.09663337794121285 7.3926420853223505
epoch 15 0.10254444674914365 7.368415966263163
[32m[I 2022-03-01 18:40:08,727][0m Trial 3 finished with value: 7.468714359374772 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.162767886412013, 'n_units_l(Invariant)': 96, 'n_layers_mlp': 4, 'lr': 0.0035498007407173708, 'weight_decay': 0.14937315736720083, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 20}. Best is trial 1 with value: 7.317698601008332.[0m

Trial Id: 4 | Model params: 247628 | Timestamp: 2022-03-01 18:40:08.728132

[32m[I 2022-03-01 18:41:32,006][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 53614 | Timestamp: 2022-03-01 18:41:32.006349

epoch 0 0.11791577717250701 7.305041499020447
epoch 5 0.11001614724461684 7.33767925469273
epoch 10 0.11034972958552536 7.336303977140958
epoch 15 0.06811088201783977 7.508441138144539
epoch 20 0.11965639065946931 7.2978304343828215
epoch 25 0.10948949407137487 7.3398499910064885
epoch 30 0.11147160321970684 7.331676876690448
epoch 35 0.1144243145505437 7.319484615554331
[32m[I 2022-03-01 19:07:41,840][0m Trial 5 finished with value: 7.3311975488038055 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.14237418403658386, 'n_units_l(Invariant)': 374, 'n_layers_mlp': 4, 'lr': 0.006493202028983634, 'weight_decay': 0.050387544434668176, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 40}. Best is trial 1 with value: 7.317698601008332.[0m

Trial Id: 6 | Model params: 31966 | Timestamp: 2022-03-01 19:07:41.840709

[32m[I 2022-03-01 19:08:11,108][0m Trial 6 pruned. [0m
epoch 0 0.10564826252151038 7.355663237834629

Trial Id: 7 | Model params: 358572 | Timestamp: 2022-03-01 19:08:11.108645

[32m[I 2022-03-01 19:09:40,620][0m Trial 7 pruned. [0m
epoch 0 0.11151664000522787 7.331491064202939

Trial Id: 8 | Model params: 30576 | Timestamp: 2022-03-01 19:09:40.620696

[32m[I 2022-03-01 19:10:07,070][0m Trial 8 pruned. [0m
epoch 0 0.10883973701929017 7.342527247275049

Trial Id: 9 | Model params: 561364 | Timestamp: 2022-03-01 19:10:07.070859

[32m[I 2022-03-01 19:11:59,455][0m Trial 9 pruned. [0m
epoch 0 0.09631409012580217 7.393948405456545

Trial Id: 10 | Model params: 84058 | Timestamp: 2022-03-01 19:11:59.455841

epoch 0 -0.33100024105068004 8.973393801630856
epoch 5 0.11044289450662625 7.33591983513669
epoch 10 0.11899987445233184 7.300551105601626
epoch 15 0.1181120663720816 7.304228662506912
[32m[I 2022-03-01 19:39:50,680][0m Trial 10 pruned. [0m
epoch 20 0.10883540777465084 7.342545082202973

Trial Id: 11 | Model params: 53878 | Timestamp: 2022-03-01 19:39:50.681173

[32m[I 2022-03-01 19:40:28,946][0m Trial 11 pruned. [0m
epoch 0 0.052810123661298225 7.569831006142656

Trial Id: 12 | Model params: 124232 | Timestamp: 2022-03-01 19:40:28.946230

[32m[I 2022-03-01 19:41:10,413][0m Trial 12 pruned. [0m
epoch 0 0.07590163263449679 7.476989345773466

Trial Id: 13 | Model params: 61270 | Timestamp: 2022-03-01 19:41:10.413875

epoch 0 -0.009980258980617274 7.816711853524086
epoch 5 -1.2130518706957405 11.570801866122878
epoch 10 -1.112710065232247 11.305443684705747
epoch 15 -0.3346438502230149 8.98566772673771
epoch 20 -1.9913089187676012 13.452354184490181
epoch 25 -0.085566826145131 8.103934868744746
epoch 30 -1.5612802215052692 12.447903367354662
epoch 35 -1.3093164115584588 11.81977967747018
[32m[I 2022-03-01 20:48:24,664][0m Trial 13 finished with value: 29.17143363973303 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.34640265380710067, 'n_units_l(Invariant)': 490, 'n_layers_mlp': 4, 'lr': 0.009985059059600933, 'weight_decay': 0.014755034844120718, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 40}. Best is trial 1 with value: 7.317698601008332.[0m

Trial Id: 14 | Model params: 45100 | Timestamp: 2022-03-01 20:48:24.664832

[32m[I 2022-03-01 20:50:04,380][0m Trial 14 pruned. [0m
epoch 0 0.09717255943568126 7.390435577658061

Trial Id: 15 | Model params: 30246 | Timestamp: 2022-03-01 20:50:04.380387

epoch 0 -4.128454469043845 17.614118445029888
epoch 5 0.058130972114045165 7.548539262295613
[32m[I 2022-03-01 20:53:37,733][0m Trial 15 pruned. [0m

Trial Id: 16 | Model params: 130992 | Timestamp: 2022-03-01 20:53:37.734042

[32m[I 2022-03-01 20:54:22,152][0m Trial 16 pruned. [0m
epoch 0 0.06363184383622111 7.526463819243949

Trial Id: 17 | Model params: 29062 | Timestamp: 2022-03-01 20:54:22.152962

epoch 0 -12.861485115465497 28.958265248919606
epoch 5 -12.855159938389605 28.951657477312473
epoch 10 -12.8771709164268 28.974645353572505
epoch 15 -12.864803572690814 28.96173136431106
[32m[I 2022-03-01 21:27:45,253][0m Trial 17 finished with value: 28.95886131795393 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.31068641724765794, 'n_units_l(Invariant)': 2, 'n_layers_mlp': 4, 'lr': 0.0025356495022178585, 'weight_decay': 0.19363380789218793, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 20}. Best is trial 1 with value: 7.317698601008332.[0m

Trial Id: 18 | Model params: 50248 | Timestamp: 2022-03-01 21:27:45.254044

[32m[I 2022-03-01 21:28:22,524][0m Trial 18 pruned. [0m
epoch 0 0.04183488339034558 7.613561114069248

Trial Id: 19 | Model params: 29912 | Timestamp: 2022-03-01 21:28:22.524222

epoch 0 -0.9125468302066782 10.756567313150347
[32m[I 2022-03-01 21:36:29,038][0m Trial 19 pruned. [0m
epoch 5 -0.37881540831824223 9.133152816143213

Trial Id: 20 | Model params: 171166 | Timestamp: 2022-03-01 21:36:29.038686

epoch 0 -12.846482314243758 28.94258970210672
epoch 5 -12.86616494309039 28.963153190296584
[32m[I 2022-03-01 21:46:45,644][0m Trial 20 pruned. [0m

Trial Id: 21 | Model params: 28266 | Timestamp: 2022-03-01 21:46:45.645172

[32m[I 2022-03-01 21:48:16,220][0m Trial 21 pruned. [0m
epoch 0 0.07178058626969153 7.4936427369725065

Trial Id: 22 | Model params: 25758 | Timestamp: 2022-03-01 21:48:16.221048

[32m[I 2022-03-01 21:49:44,411][0m Trial 22 pruned. [0m
epoch 0 0.09484664254882702 7.3999492904693955

Trial Id: 23 | Model params: 32886 | Timestamp: 2022-03-01 21:49:44.411396

[32m[I 2022-03-01 21:51:13,626][0m Trial 23 pruned. [0m
epoch 0 0.1086646258503906 7.343248607633185

Trial Id: 24 | Model params: 21798 | Timestamp: 2022-03-01 21:51:13.626381

[32m[I 2022-03-01 21:52:42,571][0m Trial 24 pruned. [0m
epoch 0 0.10361178653059522 7.364033051040047

Trial Id: 25 | Model params: 27606 | Timestamp: 2022-03-01 21:52:42.571825

[32m[I 2022-03-01 21:53:08,989][0m Trial 25 pruned. [0m
epoch 0 0.1142168161533661 7.3203420760713795

Trial Id: 26 | Model params: 24768 | Timestamp: 2022-03-01 21:53:08.989708

[32m[I 2022-03-01 21:54:37,796][0m Trial 26 pruned. [0m
epoch 0 0.11043508421069548 7.3359520396903495

Trial Id: 27 | Model params: 36516 | Timestamp: 2022-03-01 21:54:37.796285

[32m[I 2022-03-01 21:56:07,092][0m Trial 27 pruned. [0m
epoch 0 0.05808545922703401 7.548721639916151

Trial Id: 28 | Model params: 31566 | Timestamp: 2022-03-01 21:56:07.092687

[32m[I 2022-03-01 21:56:28,965][0m Trial 28 pruned. [0m
epoch 0 0.1039548747864264 7.36262364213866

Trial Id: 29 | Model params: 415332 | Timestamp: 2022-03-01 21:56:28.965684

epoch 0 -12.871448384378994 28.96867059709156
epoch 5 -12.865135387721558 28.962077920980136
epoch 10 -12.85968571956611 28.95638561356787
epoch 15 -12.892828972248584 28.990987254669058
epoch 20 -12.856854045399384 28.953427421033943
epoch 25 -12.899512062940387 28.997959416439038
epoch 30 -12.894187201699298 28.992404368865657
epoch 35 -12.858657522650283 28.955311512062686
epoch 40 -12.856977805093575 28.95355671659089
epoch 45 -12.86697287164518 28.96399696425087
epoch 50 -12.848044897024142 28.944222749237834
epoch 55 -12.903002902676151 29.00160058289018
[32m[I 2022-03-01 23:29:40,580][0m Trial 29 finished with value: 29.008883022065927 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.1252855075405798, 'n_units_l(Invariant)': 433, 'n_layers_mlp': 4, 'lr': 0.0003605235870850734, 'weight_decay': 0.2596195447403018, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 60}. Best is trial 1 with value: 7.317698601008332.[0m

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  22
  Number of complete trials:  8

Best trial:
  Value:  7.317698601008332
  Params: 
    n_layers_fe: 2
    fe_neurons: 64
    fe_dropout: 0.21689381759931226
    n_units_l(Invariant): 206
    n_layers_mlp: 4
    lr: 0.0010507176215368336
    weight_decay: 0.2589109862568354
    criterion: MSELoss
    batch_size: 32
    epochs: 20
Traceback (most recent call last):
  File "hp_optim.py", line 392, in <module>
    main()
  File "hp_optim.py", line 76, in main
    model = torch.load(f"trained_models/{area}/{gal}/{trial.number}.pt")
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 594, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'trained_models/north/elg/1.pt'
[32m[I 2022-03-01 23:31:12,127][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: qso
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 89128 | Timestamp: 2022-03-01 23:31:12.128736

epoch 0 -1.4555434915226315 3.8784595838461913
epoch 5 -1.4216876734027677 3.851629642963353
epoch 10 -1.3987917375806194 3.8333787144212557
epoch 15 -1.3809429634109085 3.8190905080972435
epoch 20 -1.4311579326951174 3.8591533919282153
epoch 25 -1.3929277897940064 3.8286904193423195
epoch 30 -1.4309195213450248 3.858964163471341
epoch 35 -1.3971219691253451 3.8320442990507066
epoch 40 -1.4200638438992041 3.8503380976661887
epoch 45 -1.392988176043981 3.8287387281126763
epoch 50 -1.389393753980937 3.8258621416607452
epoch 55 -1.4455814306691042 3.870584195374661
[32m[I 2022-03-02 00:12:09,213][0m Trial 0 finished with value: 3.8357563712027525 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.07507424853734623, 'n_units_l(Invariant)': 339, 'n_layers_mlp': 2, 'lr': 0.00018655183412378995, 'weight_decay': 0.07754025840138437, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 60}. Best is trial 0 with value: 3.8357563712027525.[0m

Trial Id: 1 | Model params: 16184 | Timestamp: 2022-03-02 00:12:09.213448

epoch 0 -2.3916034725363575 4.558143467828462
epoch 5 -2.5062493072647807 4.634542309683372
epoch 10 -2.5633369359896543 4.672119041259272
epoch 15 -2.6185548483435044 4.70817974689607
[32m[I 2022-03-02 00:20:05,866][0m Trial 1 finished with value: 4.738867829098983 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.4868633987895828, 'n_units_l(Invariant)': 59, 'n_layers_mlp': 2, 'lr': 1.7240206536488217e-05, 'weight_decay': 0.04503933897804393, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 20}. Best is trial 0 with value: 3.8357563712027525.[0m

Trial Id: 2 | Model params: 305682 | Timestamp: 2022-03-02 00:20:05.866551

epoch 0 0.040552957155223446 2.424353576512075
epoch 5 0.09950786747684315 2.348688472668467
epoch 10 0.10130391076162548 2.3463450587208197
epoch 15 0.08240319536904783 2.3708899796063645
epoch 20 0.10201634169314666 2.3454148553771157
epoch 25 0.10424794749632116 2.3424987125172776
epoch 30 0.09778380166385259 2.3509357755777454
epoch 35 0.10191100482965709 2.345552414338996
epoch 40 0.103013646556259 2.3441120791892502
epoch 45 0.10376729638038507 2.3431271082981135
epoch 50 0.10386791891873437 2.342995569907242
epoch 55 0.09652663684668061 2.3525731241975536
[32m[I 2022-03-02 00:58:04,470][0m Trial 2 finished with value: 2.351205240502974 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.16594140044939165, 'n_units_l(Invariant)': 8, 'n_layers_mlp': 4, 'lr': 8.447767555131369e-05, 'weight_decay': 0.14931616144847004, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 3 | Model params: 46548 | Timestamp: 2022-03-02 00:58:04.470987

epoch 0 -2.239019965164477 4.4544313215949725
epoch 5 -2.390984187280613 4.557727304805019
epoch 10 -2.4534574134437013 4.5995199541082386
epoch 15 -2.4698605740724973 4.610430366339057
epoch 20 -2.5575102130031855 4.668297583768087
epoch 25 -2.509114244732673 4.636435352872081
epoch 30 -2.4808746607145284 4.617741819615098
epoch 35 -2.671343365567157 4.7423975430515775
epoch 40 -2.657594610560685 4.733509349606765
epoch 45 -2.2408097230007504 4.455661825335287
epoch 50 -2.142586773670802 4.38762087487972
epoch 55 -2.2989693228858448 4.495464716862406
[32m[I 2022-03-02 01:29:17,427][0m Trial 3 finished with value: 4.424636562820494 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.18734725744813296, 'n_units_l(Invariant)': 393, 'n_layers_mlp': 4, 'lr': 8.614289488453438e-05, 'weight_decay': 0.1623604217800024, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 4 | Model params: 460744 | Timestamp: 2022-03-02 01:29:17.428050

epoch 0 -1.3602309318313908 3.8024429227371535
epoch 5 -1.5206864518477956 3.9295685423741853
epoch 10 -1.478277722103873 3.8963722472927205
epoch 15 -1.4826149262453434 3.8997802540542743
epoch 20 -1.4822806625546954 3.8995177085407016
epoch 25 -1.4895517010964032 3.9052247204833415
epoch 30 -1.479304915538056 3.89717964537402
epoch 35 -1.4761546091007114 3.894702900270902
epoch 40 -1.47068496143384 3.890398962711522
epoch 45 -1.4829878213288974 3.90007312151953
epoch 50 -1.473476980704878 3.892596531823728
epoch 55 -1.4824890744747519 3.8996814065719594
[32m[I 2022-03-02 02:52:28,990][0m Trial 4 finished with value: 3.902434198451521 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.4337638313334492, 'n_units_l(Invariant)': 99, 'n_layers_mlp': 4, 'lr': 0.00012921835655410526, 'weight_decay': 0.26412414814446805, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 5 | Model params: 96542 | Timestamp: 2022-03-02 02:52:28.990654

[32m[I 2022-03-02 02:53:00,589][0m Trial 5 pruned. [0m
epoch 0 0.06826345600276984 2.389087299695551

Trial Id: 6 | Model params: 190094 | Timestamp: 2022-03-02 02:53:00.589999

epoch 0 -1.4915570400419154 3.906797237097978
[32m[I 2022-03-02 03:00:54,230][0m Trial 6 pruned. [0m
epoch 5 -1.475712431477926 3.894355137786

Trial Id: 7 | Model params: 137492 | Timestamp: 2022-03-02 03:00:54.230903

[32m[I 2022-03-02 03:02:21,394][0m Trial 7 pruned. [0m
epoch 0 -1.4360521551248646 3.8630359161042733

Trial Id: 8 | Model params: 429006 | Timestamp: 2022-03-02 03:02:21.394282

[32m[I 2022-03-02 03:04:09,688][0m Trial 8 pruned. [0m
epoch 0 0.014212270573503938 2.4574073837922326

Trial Id: 9 | Model params: 342318 | Timestamp: 2022-03-02 03:04:09.688597

[32m[I 2022-03-02 03:05:33,671][0m Trial 9 pruned. [0m
epoch 0 -1.4154687525327532 3.846680949973298

Trial Id: 10 | Model params: 367344 | Timestamp: 2022-03-02 03:05:33.671213

[32m[I 2022-03-02 03:06:29,300][0m Trial 10 pruned. [0m
epoch 0 0.11189255321950642 2.3324815153376357

Trial Id: 11 | Model params: 121112 | Timestamp: 2022-03-02 03:06:29.300372

[32m[I 2022-03-02 03:07:08,473][0m Trial 11 pruned. [0m
epoch 0 0.09312060843918568 2.357003466795041

Trial Id: 12 | Model params: 86268 | Timestamp: 2022-03-02 03:07:08.473650

[32m[I 2022-03-02 03:07:46,698][0m Trial 12 pruned. [0m
epoch 0 -0.060392826073650596 2.5487007417236267

Trial Id: 13 | Model params: 107072 | Timestamp: 2022-03-02 03:07:46.699074

[32m[I 2022-03-02 03:08:21,694][0m Trial 13 pruned. [0m
epoch 0 0.09172349257897228 2.35881833856934

Trial Id: 14 | Model params: 21336 | Timestamp: 2022-03-02 03:08:21.694546

epoch 0 -2.5659463302317502 4.673829400067851
epoch 5 -2.645685993952248 4.725797244828668
epoch 10 -2.701018313327754 4.761525033034443
epoch 15 -2.7516639185740632 4.793993249115138
epoch 20 -2.7615907690898465 4.8003314788770375
epoch 25 -2.720169500686494 4.7738285652924475
epoch 30 -2.715097268878269 4.770573038319637
epoch 35 -2.6906417576126094 4.754845397088192
epoch 40 -2.6974977278970766 4.75925979916325
epoch 45 -2.707740160269419 4.765847049354824
epoch 50 -2.7372600924809225 4.784781569702287
epoch 55 -2.7459813267522986 4.790361176636638
[32m[I 2022-03-02 03:24:13,358][0m Trial 14 finished with value: 4.733336589081312 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.3024581736342399, 'n_units_l(Invariant)': 11, 'n_layers_mlp': 4, 'lr': 1.1290267006020006e-05, 'weight_decay': 0.20450946452289545, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 15 | Model params: 277040 | Timestamp: 2022-03-02 03:24:13.359044

[32m[I 2022-03-02 03:25:33,845][0m Trial 15 pruned. [0m
epoch 0 0.06020102937285787 2.3994015627538294

Trial Id: 16 | Model params: 87698 | Timestamp: 2022-03-02 03:25:33.846079

[32m[I 2022-03-02 03:26:12,605][0m Trial 16 pruned. [0m
epoch 0 0.1145609719460694 2.3289747777129435

Trial Id: 17 | Model params: 356766 | Timestamp: 2022-03-02 03:26:12.605219

epoch 0 -2.0844990341875573 4.346881230667774
epoch 5 -2.2022387312340594 4.429067589863252
epoch 10 -1.804740155160736 4.145069063829309
epoch 15 -1.710324960217938 4.074704671570123
epoch 20 -1.6663202091723055 4.041490916879045
epoch 25 -1.5982276701595688 3.989551325595534
epoch 30 -1.529638758331187 3.936540358058898
epoch 35 -1.463821610399667 3.884991607392068
epoch 40 -1.474838842140239 3.893667988654333
epoch 45 -1.4270934608269092 3.8559261269503
epoch 50 -1.4633413125585815 3.884612918443979
epoch 55 -3.06582136223758 4.990678592911726
[32m[I 2022-03-02 04:16:12,406][0m Trial 17 finished with value: 4.4556083851786665 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.18972035995311695, 'n_units_l(Invariant)': 206, 'n_layers_mlp': 4, 'lr': 0.00014884696206192118, 'weight_decay': 0.1960094955278676, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 18 | Model params: 116952 | Timestamp: 2022-03-02 04:16:12.406575

[32m[I 2022-03-02 04:16:51,591][0m Trial 18 pruned. [0m
epoch 0 -1.3434174894974351 3.788875093682659

Trial Id: 19 | Model params: 403980 | Timestamp: 2022-03-02 04:16:51.591610

[32m[I 2022-03-02 04:18:32,991][0m Trial 19 pruned. [0m
epoch 0 0.0798861907448094 2.3741394756347085

Trial Id: 20 | Model params: 32358 | Timestamp: 2022-03-02 04:18:32.991794

epoch 0 -2.1118214253774363 4.366091050092846
[32m[I 2022-03-02 04:25:48,302][0m Trial 20 pruned. [0m

Trial Id: 21 | Model params: 436234 | Timestamp: 2022-03-02 04:25:48.302577

[32m[I 2022-03-02 04:27:02,680][0m Trial 21 pruned. [0m
epoch 0 -1.51266903694746 3.9233142792072138

Trial Id: 22 | Model params: 451714 | Timestamp: 2022-03-02 04:27:02.680852

[32m[I 2022-03-02 04:28:21,706][0m Trial 22 pruned. [0m
epoch 0 -1.4763005340241495 3.8948176600373996

Trial Id: 23 | Model params: 463066 | Timestamp: 2022-03-02 04:28:21.706338

[32m[I 2022-03-02 04:29:44,507][0m Trial 23 pruned. [0m
epoch 0 -1.468592135582219 3.8887509070991206

Trial Id: 24 | Model params: 436750 | Timestamp: 2022-03-02 04:29:44.507695

[32m[I 2022-03-02 04:30:59,462][0m Trial 24 pruned. [0m
epoch 0 -1.6951430383368558 4.063276388541666

Trial Id: 25 | Model params: 510022 | Timestamp: 2022-03-02 04:30:59.462654

[32m[I 2022-03-02 04:32:36,476][0m Trial 25 pruned. [0m
epoch 0 -1.362387304663308 3.804179535146243

Trial Id: 26 | Model params: 92252 | Timestamp: 2022-03-02 04:32:36.477167

epoch 0 -2.6102020330003324 4.7027425933131095
epoch 5 -2.7237731037656037 4.776140129233622
epoch 10 -2.7290150251065906 4.7795006114084755
epoch 15 -2.8680688283016202 4.867798040389069
epoch 20 -2.909218329059725 4.89362197896754
epoch 25 -2.784779445965936 4.815104791388566
epoch 30 -2.7679109566037345 4.804362521036067
epoch 35 -1.8487823571075586 4.177486839503118
epoch 40 -2.456073614402499 4.601261830285634
epoch 45 -1.5987851577090244 3.9899793107805253
epoch 50 -1.4779957509684074 3.8961505821118076
epoch 55 -1.4764493211990972 3.894934667283522
[32m[I 2022-03-02 05:03:08,068][0m Trial 26 finished with value: 3.8928926227436107 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.2908288383445058, 'n_units_l(Invariant)': 109, 'n_layers_mlp': 4, 'lr': 2.385165899852784e-05, 'weight_decay': 0.23834589353983532, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 27 | Model params: 49348 | Timestamp: 2022-03-02 05:03:08.068621

[32m[I 2022-03-02 05:03:34,578][0m Trial 27 pruned. [0m
epoch 0 -0.05553339070519159 2.542854102526285

Trial Id: 28 | Model params: 126442 | Timestamp: 2022-03-02 05:03:34.578227

epoch 0 -2.392443345549166 4.558707806311198
epoch 5 -2.2694359911270174 4.475297125796115
epoch 10 -2.149384113396095 4.3923634710285455
epoch 15 -2.158030626108567 4.3983888705561345
epoch 20 -1.6841857114886114 4.055008183166353
epoch 25 -1.48618684060963 3.9025846910524726
epoch 30 -1.4487046924290232 3.8730549759911272
epoch 35 -1.471780947235462 3.8912617496195345
epoch 40 -1.470255570267693 3.8900608832799537
epoch 45 -1.4801778029074666 3.897865623831699
epoch 50 -1.472213237414111 3.8916020064487586
epoch 55 -1.4716034210217264 3.891122009613484
[32m[I 2022-03-02 05:43:18,132][0m Trial 28 finished with value: 3.891677808783065 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.2880711995923132, 'n_units_l(Invariant)': 372, 'n_layers_mlp': 4, 'lr': 1.1988798397119448e-05, 'weight_decay': 0.2313834658464292, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 60}. Best is trial 2 with value: 2.351205240502974.[0m

Trial Id: 29 | Model params: 91078 | Timestamp: 2022-03-02 05:43:18.132760

epoch 0 -2.7268544345158956 4.778115789919075
epoch 5 -2.9122434691090384 4.895515072126669
epoch 10 -2.912383242026485 4.895602522501101
epoch 15 -3.056304896458607 4.984834577485775
[32m[I 2022-03-02 05:56:38,693][0m Trial 29 finished with value: 4.985101933744559 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.35220915082653215, 'n_units_l(Invariant)': 354, 'n_layers_mlp': 2, 'lr': 1.0082576456375521e-05, 'weight_decay': 0.2957419015905932, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 20}. Best is trial 2 with value: 2.351205240502974.[0m

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  20
  Number of complete trials:  10

Best trial:
  Value:  2.351205240502974
  Params: 
    n_layers_fe: 2
    fe_neurons: 256
    fe_dropout: 0.16594140044939165
    n_units_l(Invariant): 8
    n_layers_mlp: 4
    lr: 8.447767555131369e-05
    weight_decay: 0.14931616144847004
    criterion: MSELoss
    batch_size: 128
    epochs: 60
Target: 72610, NaN: 0, Max: 64.0, Min: 0.0, Mean: 4.437694532433549
Prediction: 72610, NaN: 0, Max: 8.229500770568848, Min: 3.1857993602752686, Mean: 4.633551834224259

 XXXXXX======== TRIAL north - qso ended

Test Set - R-squared:  0.09757696525773607
Test Set - RMSE:  2.351205240502974
Test Set - MAE:  1.844785839311841



[32m[I 2022-03-02 05:58:12,957][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: glbg
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 35398 | Timestamp: 2022-03-02 05:58:12.957885

epoch 0 -6.141874337105323 30.196436662272344
epoch 5 -5.951549909387386 29.791366020717916
epoch 10 -5.885466221988385 29.64942468764564
epoch 15 -5.858169299902424 29.59059484637948
epoch 20 -5.87781652661999 29.632949979168657
epoch 25 -5.834387876386858 29.539246043122695
epoch 30 -5.852374677824112 29.578091323868097
epoch 35 -5.838799944349394 29.5487793134123
[32m[I 2022-03-02 06:18:20,288][0m Trial 0 finished with value: 29.52337998853955 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.19261988104572453, 'n_units_l(Invariant)': 98, 'n_layers_mlp': 4, 'lr': 0.0003139945062273958, 'weight_decay': 0.15080387121138386, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 40}. Best is trial 0 with value: 29.52337998853955.[0m

Trial Id: 1 | Model params: 42914 | Timestamp: 2022-03-02 06:18:20.288685

epoch 0 0.1346104111673938 10.511275710783895
epoch 5 0.18211042485723805 10.21873015881854
epoch 10 0.1772493476866519 10.249052373006078
epoch 15 0.15527790983262113 10.385000469165755
epoch 20 0.17517120797299723 10.261987963028949
epoch 25 0.1757677375590283 10.258276473628078
epoch 30 0.13587929689993616 10.50356675481847
epoch 35 0.18263359505229915 10.215461386106439
epoch 40 0.16417297063712055 10.330177893754083
epoch 45 0.18203909591859113 10.219175741760031
epoch 50 0.1737703457443558 10.27069857841323
epoch 55 0.17794930094614025 10.244691766283893
[32m[I 2022-03-02 06:51:59,172][0m Trial 1 finished with value: 10.201899264891937 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.15439866780624695, 'n_units_l(Invariant)': 464, 'n_layers_mlp': 2, 'lr': 0.007257123173358593, 'weight_decay': 0.22613067826668426, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 60}. Best is trial 1 with value: 10.201899264891937.[0m

Trial Id: 2 | Model params: 29128 | Timestamp: 2022-03-02 06:51:59.172157

epoch 0 0.1599076305583108 10.356502509953257
epoch 5 0.17296345297787996 10.275712517325383
epoch 10 0.18737557987447673 10.185785572402978
epoch 15 0.1732230644466478 10.2740995884816
epoch 20 0.17654174396588962 10.253458755985902
epoch 25 0.1814188844023309 10.223049306781846
epoch 30 0.18430021485557468 10.205041348229868
epoch 35 0.15152214538075537 10.408061519741274
epoch 40 0.1794945759588097 10.235058350208156
epoch 45 0.17667927769726588 10.252602455548422
epoch 50 0.18458418065518545 10.203264876646918
epoch 55 0.183059732040038 10.212798104711204
[32m[I 2022-03-02 07:20:21,686][0m Trial 2 finished with value: 10.239511113782221 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.23445389112709286, 'n_units_l(Invariant)': 3, 'n_layers_mlp': 4, 'lr': 0.0016457970020898156, 'weight_decay': 0.20258067105188676, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 60}. Best is trial 1 with value: 10.201899264891937.[0m

Trial Id: 3 | Model params: 370182 | Timestamp: 2022-03-02 07:20:21.686924

[32m[I 2022-03-02 07:21:20,832][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 28266 | Timestamp: 2022-03-02 07:21:20.832777

epoch 0 -6.482772252740124 30.90870847065132
epoch 5 -6.3214980637517595 30.573810587038803
epoch 10 -6.266657387257247 30.45909089398875
[32m[I 2022-03-02 07:41:15,976][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 378438 | Timestamp: 2022-03-02 07:41:15.976936

epoch 0 0.14805446906080244 10.429308383882203
epoch 5 0.18561727561786245 10.196799290538886
epoch 10 0.17409999683992616 10.268649459985944
epoch 15 0.18106240634849258 10.22527504591835
epoch 20 0.18553472394962622 10.197316087762234
epoch 25 0.16581173346971045 10.320046002257284
epoch 30 0.1634487022176072 10.33465262432123
epoch 35 0.18017214563297523 10.230831444903597
[32m[I 2022-03-02 08:47:17,785][0m Trial 5 finished with value: 10.241435839984003 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.4773886247130871, 'n_units_l(Invariant)': 290, 'n_layers_mlp': 2, 'lr': 0.000947762013855716, 'weight_decay': 0.1081327645088301, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 40}. Best is trial 1 with value: 10.201899264891937.[0m

Trial Id: 6 | Model params: 93422 | Timestamp: 2022-03-02 08:47:17.785783

epoch 0 -0.017945346916343752 11.400183069911266
epoch 5 0.191368523661673 10.160730114846624
epoch 10 0.19759518004843402 10.121534485193822
epoch 15 0.2005262392219045 10.10303138213549
[32m[I 2022-03-02 08:57:15,297][0m Trial 6 finished with value: 10.090342969808974 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.031109378444895586, 'n_units_l(Invariant)': 118, 'n_layers_mlp': 4, 'lr': 0.00037480067529604305, 'weight_decay': 0.26073612182983913, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 7 | Model params: 111496 | Timestamp: 2022-03-02 08:57:15.297984

epoch 0 0.10730348385570776 10.675826685154714
epoch 5 0.1736205226810471 10.271629746741144
epoch 10 0.15323707650242369 10.397537888078302
epoch 15 0.1495701260904263 10.420027103130016
[32m[I 2022-03-02 09:29:09,993][0m Trial 7 finished with value: 10.26635275828889 and parameters: {'n_layers_fe': 4, 'fe_neurons': 128, 'fe_dropout': 0.411026070814367, 'n_units_l(Invariant)': 3, 'n_layers_mlp': 4, 'lr': 0.0008851603668190429, 'weight_decay': 0.1561250058975673, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 8 | Model params: 533758 | Timestamp: 2022-03-02 09:29:09.994056

epoch 0 0.040434565021739144 11.068452166657886
epoch 5 0.18428142141879733 10.205158907838324
epoch 10 0.17251247032933614 10.278513806145801
epoch 15 0.19279857775920206 10.15174158048379
[32m[I 2022-03-02 10:03:54,056][0m Trial 8 finished with value: 10.172685648811688 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.4920952799164523, 'n_units_l(Invariant)': 382, 'n_layers_mlp': 4, 'lr': 0.00021209682768922526, 'weight_decay': 0.14372216542755825, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 9 | Model params: 228278 | Timestamp: 2022-03-02 10:03:54.056649

[32m[I 2022-03-02 10:05:12,290][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 63388 | Timestamp: 2022-03-02 10:05:12.290217

epoch 0 -0.18400550035435903 12.294941161133977
epoch 5 0.01943366075941544 11.18891784732995
epoch 10 0.1471674410104835 10.434736361369152
epoch 15 0.16824105437269044 10.305008040315577
[32m[I 2022-03-02 10:15:29,122][0m Trial 10 finished with value: 10.16517450937366 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.014509939558653151, 'n_units_l(Invariant)': 141, 'n_layers_mlp': 2, 'lr': 3.7114397638216724e-05, 'weight_decay': 0.2914293794551131, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 11 | Model params: 62088 | Timestamp: 2022-03-02 10:15:29.122570

epoch 0 -0.3440486255474724 13.099571367558093
epoch 5 -0.03954370122616102 11.520490506843302
epoch 10 0.059275297644488356 10.959250878173119
epoch 15 0.1365693884613426 10.499371813942785
[32m[I 2022-03-02 10:25:42,865][0m Trial 11 finished with value: 10.345827911606047 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.0017235514638413371, 'n_units_l(Invariant)': 131, 'n_layers_mlp': 2, 'lr': 2.9685341951499016e-05, 'weight_decay': 0.2909809829187022, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 12 | Model params: 69108 | Timestamp: 2022-03-02 10:25:42.865723

epoch 0 -0.09433734616183198 11.820210344159207
epoch 5 0.13772724500290645 10.492329647234968
epoch 10 0.1895731335845614 10.17200370480902
epoch 15 0.1906852246252655 10.165022150982583
[32m[I 2022-03-02 10:36:47,497][0m Trial 12 finished with value: 10.130734456683534 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.0025332518638839646, 'n_units_l(Invariant)': 185, 'n_layers_mlp': 2, 'lr': 7.094885916596661e-05, 'weight_decay': 0.2943300061085665, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 13 | Model params: 70928 | Timestamp: 2022-03-02 10:36:47.497588

epoch 0 -0.1292973488225444 12.007531898619545
epoch 5 0.09319932630183303 10.759832528524406
epoch 10 0.17936891538294797 10.235842070857085
epoch 15 0.1722545781003041 10.280115366436847
[32m[I 2022-03-02 10:48:05,327][0m Trial 13 finished with value: 10.17069566406142 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.07069395450449299, 'n_units_l(Invariant)': 199, 'n_layers_mlp': 2, 'lr': 6.764717084519504e-05, 'weight_decay': 0.26940649246477316, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 14 | Model params: 85232 | Timestamp: 2022-03-02 10:48:05.327821

epoch 0 -0.0692676391063134 11.684033847158934
epoch 5 0.179106602930994 10.237477869423408
epoch 10 0.18681164199190348 10.18931927996999
epoch 15 0.19881883472851425 10.11381395051434
[32m[I 2022-03-02 10:57:01,950][0m Trial 14 finished with value: 10.114390348977409 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.05368383535445586, 'n_units_l(Invariant)': 55, 'n_layers_mlp': 4, 'lr': 8.520642684583907e-05, 'weight_decay': 0.25198956522382565, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 15 | Model params: 82632 | Timestamp: 2022-03-02 10:57:01.950514

[32m[I 2022-03-02 10:57:27,787][0m Trial 15 pruned. [0m
epoch 0 0.16116418454282322 10.348754329638133

Trial Id: 16 | Model params: 83282 | Timestamp: 2022-03-02 10:57:27.787828

[32m[I 2022-03-02 10:57:53,151][0m Trial 16 pruned. [0m
epoch 0 0.03130382662108411 11.120988376400506

Trial Id: 17 | Model params: 84842 | Timestamp: 2022-03-02 10:57:53.151987

epoch 0 -0.7653626545532839 15.012968116381739
epoch 5 -0.11485197053168972 11.930487709147886
epoch 10 -0.010749259380580467 11.35981635752401
epoch 15 0.1064650802946272 10.680838775134077
[32m[I 2022-03-02 11:06:34,123][0m Trial 17 finished with value: 10.412930391621902 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.08410495857283166, 'n_units_l(Invariant)': 52, 'n_layers_mlp': 4, 'lr': 1.0248234986787255e-05, 'weight_decay': 0.19128897602214195, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 18 | Model params: 87572 | Timestamp: 2022-03-02 11:06:34.123912

[32m[I 2022-03-02 11:07:02,026][0m Trial 18 pruned. [0m
epoch 0 0.14162240456627362 10.468604232411291

Trial Id: 19 | Model params: 119552 | Timestamp: 2022-03-02 11:07:02.026197

epoch 0 -0.0928921669901186 11.81240289552399
epoch 5 0.1623387652681354 10.34150636448587
epoch 10 0.19473915529400598 10.139531433422153
epoch 15 0.1977671793547382 10.12044962742048
[32m[I 2022-03-02 11:20:18,715][0m Trial 19 finished with value: 10.114203464981776 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.030952470431793815, 'n_units_l(Invariant)': 319, 'n_layers_mlp': 4, 'lr': 8.63542707502975e-05, 'weight_decay': 0.2622023335593322, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 20 | Model params: 122282 | Timestamp: 2022-03-02 11:20:18.716154

epoch 0 -1.2236226508745487 16.84923313294862
epoch 5 -0.4815890530531075 13.753507702232918
epoch 10 -0.7960997095736111 15.143100898725885
epoch 15 -0.8471073348638665 15.356620828303999
epoch 20 -0.5406855796211085 14.02512057500752
epoch 25 -0.12337437752355918 11.976001776972831
epoch 30 -0.03765392385566391 11.510014244211888
epoch 35 -0.016564790335370283 11.392449875945504
epoch 40 0.03699335603953757 11.088281335157221
epoch 45 0.0378339822277689 11.083440696331225
epoch 50 0.03485740102145751 11.10057146420091
epoch 55 0.043563759070770036 11.05039002287816
[32m[I 2022-03-02 12:02:06,501][0m Trial 20 finished with value: 11.089197776408904 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.28463737556408786, 'n_units_l(Invariant)': 340, 'n_layers_mlp': 4, 'lr': 1.0640485725612873e-05, 'weight_decay': 0.1859250734823617, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 60}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 21 | Model params: 128132 | Timestamp: 2022-03-02 12:02:06.502194

[32m[I 2022-03-02 12:02:56,854][0m Trial 21 pruned. [0m
epoch 0 -0.06361479995472585 11.653108246254245

Trial Id: 22 | Model params: 117212 | Timestamp: 2022-03-02 12:02:56.854275

[32m[I 2022-03-02 12:03:40,282][0m Trial 22 pruned. [0m
epoch 0 -0.016038386108952363 11.389499837552547

Trial Id: 23 | Model params: 143472 | Timestamp: 2022-03-02 12:03:40.282212

epoch 0 -0.13476341551262316 12.036556469007163
epoch 5 0.1459312710578904 10.442296131765296
epoch 10 0.18124519932220928 10.224133803436274
epoch 15 0.16266414560483378 10.339497646931774
[32m[I 2022-03-02 12:22:58,150][0m Trial 23 finished with value: 10.317693611978113 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.11475246327591637, 'n_units_l(Invariant)': 503, 'n_layers_mlp': 4, 'lr': 4.735678271654606e-05, 'weight_decay': 0.2782405479575283, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 24 | Model params: 99922 | Timestamp: 2022-03-02 12:22:58.150409

epoch 0 -0.646276473522605 14.497762491379062
epoch 5 -0.10112666979041385 11.856820237634679
epoch 10 0.11078544982063265 10.654985792655589
epoch 15 0.15694093926921082 10.374772803567389
[32m[I 2022-03-02 12:33:29,319][0m Trial 24 finished with value: 10.275825463136256 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.19289721718584618, 'n_units_l(Invariant)': 168, 'n_layers_mlp': 4, 'lr': 1.727052358466293e-05, 'weight_decay': 0.23475176654126098, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Trial Id: 25 | Model params: 108502 | Timestamp: 2022-03-02 12:33:29.319425

[32m[I 2022-03-02 12:34:03,159][0m Trial 25 pruned. [0m
epoch 0 0.019513746534364662 11.188460921868728

Trial Id: 26 | Model params: 127482 | Timestamp: 2022-03-02 12:34:03.159160

[32m[I 2022-03-02 12:35:28,981][0m Trial 26 pruned. [0m
epoch 0 0.12141982447458322 10.591081121968681

Trial Id: 27 | Model params: 133202 | Timestamp: 2022-03-02 12:35:28.981720

[32m[I 2022-03-02 12:36:10,933][0m Trial 27 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 28 | Model params: 113442 | Timestamp: 2022-03-02 12:36:10.933708

[32m[I 2022-03-02 12:36:45,936][0m Trial 28 pruned. [0m
epoch 0 0.11745322756565213 10.61496240249475

Trial Id: 29 | Model params: 34210 | Timestamp: 2022-03-02 12:36:45.936990

epoch 0 -5.847024939286093 29.566543068074782
epoch 5 -5.841151723571747 29.553859607648786
epoch 10 -5.856621723577069 29.587256033518905
epoch 15 -5.835601163849516 29.541867931655144
[32m[I 2022-03-02 12:45:01,230][0m Trial 29 finished with value: 29.537713094374542 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.21957010449781797, 'n_units_l(Invariant)': 80, 'n_layers_mlp': 4, 'lr': 0.0013775029006765996, 'weight_decay': 0.2780821415155825, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 20}. Best is trial 6 with value: 10.090342969808974.[0m

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  12
  Number of complete trials:  18

Best trial:
  Value:  10.090342969808974
  Params: 
    n_layers_fe: 2
    fe_neurons: 128
    fe_dropout: 0.031109378444895586
    n_units_l(Invariant): 118
    n_layers_mlp: 4
    lr: 0.00037480067529604305
    weight_decay: 0.26073612182983913
    criterion: MSELoss
    batch_size: 256
    epochs: 20
Target: 72610, NaN: 0, Max: 135.0, Min: 0.0, Mean: 30.72970665197631
Prediction: 72610, NaN: 0, Max: 54.531864166259766, Min: 20.48212432861328, Mean: 30.995451870419043

 XXXXXX======== TRIAL north - glbg ended

Test Set - R-squared:  0.20253309882116566
Test Set - RMSE:  10.090342969808974
Test Set - MAE:  7.853567586735152



[32m[I 2022-03-02 12:46:46,917][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: rlbg
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 234986 | Timestamp: 2022-03-02 12:46:46.917769

epoch 0 0.23766527853055086 8.544111958900135
epoch 5 0.24981692938329758 8.475741637242802
epoch 10 0.2664421737549799 8.38129752202088
epoch 15 0.2617292943880051 8.40817802270099
epoch 20 0.2712286181565522 8.35390890486992
epoch 25 0.2740857829256086 8.337516977979552
epoch 30 0.26665659083341264 8.38007251657176
epoch 35 0.2733895139634047 8.341514532238842
epoch 40 0.27268438657585414 8.345560994665096
epoch 45 0.27958843427234026 8.305856402800394
epoch 50 0.27474539416731203 8.333728121343746
epoch 55 0.2523519304508687 8.461409005027301
epoch 60 0.2795246283358691 8.306224214227342
epoch 65 0.2742765144844458 8.336421578521103
epoch 70 0.2795758285571367 8.305929070152853
[32m[I 2022-03-02 14:26:05,142][0m Trial 0 finished with value: 8.381911230463247 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.019415540170720447, 'n_units_l(Invariant)': 244, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.00024451333428527955, 'weight_decay': 0.05303876177261872, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 75}. Best is trial 0 with value: 8.381911230463247.[0m

Trial Id: 1 | Model params: 114876 | Timestamp: 2022-03-02 14:26:05.142612

epoch 0 -5.39838733297644 24.7530856010577
epoch 5 -5.153808803614433 24.27538238308964
epoch 10 -5.120503008092908 24.20960134578357
epoch 15 -5.094636282099961 24.158389364675916
epoch 20 -5.0850675918183175 24.139417358873704
[32m[I 2022-03-02 14:44:20,162][0m Trial 1 finished with value: 24.16347196172442 and parameters: {'n_layers_fe': 4, 'fe_neurons': 128, 'fe_dropout': 0.41265150749136115, 'n_units_l(Invariant)': 29, 'n_layers_mlp': 4, 'initialiser': 'kaiming_he', 'lr': 0.00035027398917705614, 'weight_decay': 0.10139163167076562, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 25}. Best is trial 0 with value: 8.381911230463247.[0m

Trial Id: 2 | Model params: 42390 | Timestamp: 2022-03-02 14:44:20.162303

epoch 0 -6.935499629792919 27.56647390999859
[32m[I 2022-03-02 14:48:57,545][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 41928 | Timestamp: 2022-03-02 14:48:57.546140

[32m[I 2022-03-02 14:49:34,235][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 49518 | Timestamp: 2022-03-02 14:49:34.235860

epoch 0 -5.182530233332335 24.331966205646005
epoch 5 -6.9716350743974065 27.629166582804213
epoch 10 -7.125143921435125 27.893923880023955
[32m[I 2022-03-02 14:56:22,936][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 563170 | Timestamp: 2022-03-02 14:56:22.936327

epoch 0 0.17591959488876485 8.883392966880333
epoch 5 0.17551591173372771 8.88556850522449
epoch 10 0.16686195836935924 8.932079148317268
epoch 15 0.15038195006373622 9.019987700986226
epoch 20 0.16452342107050355 8.944606101890152
epoch 25 0.19337863298854618 8.788787039650657
epoch 30 0.13397079672371193 9.106685715862666
epoch 35 0.17315465303329802 8.898283198953258
epoch 40 0.16266985727587213 8.954522724923468
epoch 45 0.16973133734004264 8.916684565254839
epoch 50 0.1671021399483088 8.930791561264204
epoch 55 0.18615467744312308 8.828054713211676
epoch 60 0.16921268360722574 8.919469175785437
epoch 65 0.17534779723582006 8.88647435457308
epoch 70 0.17418302927740326 8.892747925551731
[32m[I 2022-03-02 17:24:13,201][0m Trial 5 finished with value: 8.812195038969708 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.4709968510440481, 'n_units_l(Invariant)': 496, 'n_layers_mlp': 4, 'initialiser': 'xavier', 'lr': 0.0017556771987190696, 'weight_decay': 0.29473985150349646, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 75}. Best is trial 0 with value: 8.381911230463247.[0m

Trial Id: 6 | Model params: 67288 | Timestamp: 2022-03-02 17:24:13.201557

epoch 0 0.2337597744205543 8.565970097088746
epoch 5 0.22646412153147122 8.60665335055241
epoch 10 0.24162958360393016 8.52186738900626
epoch 15 0.24243705744540012 8.517329357519861
epoch 20 0.23777271845728487 8.543509853890868
epoch 25 0.2191352365722663 8.647329207416888
epoch 30 0.2391519553520246 8.535776688446179
epoch 35 0.23968475807932388 8.532787470295148
epoch 40 0.24368854927153072 8.510291147607605
epoch 45 0.241396713770185 8.523175676803678
[32m[I 2022-03-02 17:50:47,993][0m Trial 6 finished with value: 8.515891120332885 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.31521984982307644, 'n_units_l(Invariant)': 171, 'n_layers_mlp': 2, 'initialiser': 'xavier', 'lr': 0.004070210405899778, 'weight_decay': 0.021525347672087213, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 0 with value: 8.381911230463247.[0m

Trial Id: 7 | Model params: 131516 | Timestamp: 2022-03-02 17:50:47.993841

epoch 0 0.1759574334544196 8.88318901911958
epoch 5 0.1504771150764359 9.019482526171299
epoch 10 0.18324269589514053 8.843834233837857
epoch 15 0.19925008189936966 8.756741544221263
epoch 20 0.14695862896066736 9.038141312873536
[32m[I 2022-03-02 18:11:26,327][0m Trial 7 finished with value: 8.863546348491024 and parameters: {'n_layers_fe': 4, 'fe_neurons': 128, 'fe_dropout': 0.4576877470267814, 'n_units_l(Invariant)': 157, 'n_layers_mlp': 4, 'initialiser': 'xavier', 'lr': 0.004580046827900813, 'weight_decay': 0.2932376213863695, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 25}. Best is trial 0 with value: 8.381911230463247.[0m

Trial Id: 8 | Model params: 18824 | Timestamp: 2022-03-02 18:11:26.328092

epoch 0 -6.156265386213242 26.17805037500329
epoch 5 -6.144077888012544 26.155749574375463
epoch 10 -6.172275928672404 26.207317779285354
epoch 15 -6.1300576255061765 26.130071622997665
epoch 20 -6.223547745912508 26.30082393927325
epoch 25 -6.218524084926303 26.291676813248525
epoch 30 -6.210934800841487 26.27785213970467
epoch 35 -6.059737392587069 26.000898352561485
epoch 40 -6.441506362354782 26.694667076740405
epoch 45 -6.1705324273821445 26.204132230514656
epoch 50 -5.669600053097057 25.27225390491693
epoch 55 -5.495130834294778 24.939516640805927
epoch 60 -5.238346031198807 24.441553750702436
epoch 65 -5.083520393691287 24.1363483021104
epoch 70 -5.0445106960447275 24.058838419801678
[32m[I 2022-03-02 18:35:54,799][0m Trial 8 finished with value: 24.036778964511093 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.2244370357758837, 'n_units_l(Invariant)': 99, 'n_layers_mlp': 2, 'initialiser': 'kaiming_he', 'lr': 7.426999541012484e-05, 'weight_decay': 0.05507204702736521, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 75}. Best is trial 0 with value: 8.381911230463247.[0m

Trial Id: 9 | Model params: 144642 | Timestamp: 2022-03-02 18:35:54.799964

[32m[I 2022-03-02 18:37:23,386][0m Trial 9 pruned. [0m
epoch 0 0.20416678402275978 8.729816419348932

Trial Id: 10 | Model params: 238082 | Timestamp: 2022-03-02 18:37:23.386921

[32m[I 2022-03-02 18:38:40,140][0m Trial 10 pruned. [0m
epoch 0 0.21051572238700966 8.694924654410208

Trial Id: 11 | Model params: 222860 | Timestamp: 2022-03-02 18:38:40.140414

epoch 0 -0.09125480874808112 10.22250108811901
epoch 5 0.19984653190569912 8.753479644723933
epoch 10 0.24850920958636125 8.483125880775004
epoch 15 0.2611683276136195 8.411371846337524
epoch 20 0.26639500667890736 8.381566972450807
epoch 25 0.2695791499115012 8.363357491653215
epoch 30 0.27063513867487765 8.357309741327247
epoch 35 0.2687206299745498 8.368271097659001
epoch 40 0.27394309881468315 8.338336339770013
epoch 45 0.27878356060575504 8.310494931123266
[32m[I 2022-03-02 19:20:01,953][0m Trial 11 finished with value: 8.328703448860335 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.37320416203069967, 'n_units_l(Invariant)': 197, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0003881372563740905, 'weight_decay': 0.00437306288214083, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 12 | Model params: 236276 | Timestamp: 2022-03-02 19:20:01.953976

epoch 0 0.11807551062321409 9.189878749177709
epoch 5 0.24055540988857416 8.527900540206232
epoch 10 0.2467979278144441 8.492779201743492
epoch 15 0.2538863149927958 8.452721947723564
epoch 20 0.2536283589023518 8.454183013725906
epoch 25 0.2541672921592707 8.451130202690157
epoch 30 0.2501512368884553 8.473852885083966
epoch 35 0.2580496190201339 8.429105921671656
epoch 40 0.2530935229379784 8.457211526026342
epoch 45 0.251849544647197 8.464251370355452
[32m[I 2022-03-02 20:25:46,941][0m Trial 12 finished with value: 8.434441655361423 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.37853892843024256, 'n_units_l(Invariant)': 249, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.00036011318715529973, 'weight_decay': 0.07581909282909356, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 13 | Model params: 219248 | Timestamp: 2022-03-02 20:25:46.941284

epoch 0 -0.1298132205595015 10.401534320251272
epoch 5 0.1336088629221489 9.108588465255886
epoch 10 0.16980490918181324 8.916289493473343
epoch 15 0.2508585628212815 8.469855285615942
epoch 20 0.24316688380113838 8.513225626355903
epoch 25 0.23608393499243308 8.552969076652886
epoch 30 0.2584089808567699 8.427064366106837
epoch 35 0.2665062044226958 8.380931721419385
epoch 40 0.2654221565971244 8.387122623432202
epoch 45 0.2703214981335962 8.359106447996405
[32m[I 2022-03-02 21:08:04,331][0m Trial 13 finished with value: 8.372777315690023 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.15175853615908994, 'n_units_l(Invariant)': 183, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.00010191846528641389, 'weight_decay': 0.11721347420030614, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 14 | Model params: 193706 | Timestamp: 2022-03-02 21:08:04.331839

epoch 0 -0.14529264752925242 10.472546962091066
epoch 5 0.0915942793183484 9.326828915812756
epoch 10 0.19186603001591984 8.797023691610871
epoch 15 0.15339878327336953 9.003959323634776
epoch 20 0.12934581354568686 9.13097022332635
epoch 25 0.1522152958564802 9.010250568465779
epoch 30 0.1512544456540187 9.015355077547389
epoch 35 0.17838217156731628 8.870110037469784
epoch 40 0.1744572037769856 8.891271589267465
epoch 45 0.17498622705781286 8.88842228606777
[32m[I 2022-03-02 21:44:50,484][0m Trial 14 finished with value: 8.71424010119972 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.19131550111582385, 'n_units_l(Invariant)': 84, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 3.904345827585173e-05, 'weight_decay': 0.22119675409327383, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 15 | Model params: 216152 | Timestamp: 2022-03-02 21:44:50.484484

epoch 0 -0.1998347463864325 10.719012997566516
epoch 5 -0.03354887053472444 9.948545454714852
epoch 10 0.025278285381598264 9.661274037653358
epoch 15 0.17077028146737372 8.911103939749138
epoch 20 0.09240436315350342 9.322669321508286
epoch 25 0.07813002071725528 9.395695129798344
epoch 30 0.08851229691088547 9.342637261185391
epoch 35 0.0951206912578314 9.308708035456336
epoch 40 0.12058688168383724 9.17678485658678
epoch 45 0.18578800506767368 8.830043198727463
[32m[I 2022-03-02 22:27:04,276][0m Trial 15 finished with value: 9.19664794093295 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.15512311309212024, 'n_units_l(Invariant)': 171, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 2.5997292214116767e-05, 'weight_decay': 0.11990117779894165, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 16 | Model params: 258722 | Timestamp: 2022-03-02 22:27:04.276338

epoch 0 -0.09901812862936832 10.258798706231346
epoch 5 0.23951800285991465 8.533723140632038
epoch 10 0.19590405779738895 8.775017989065761
epoch 15 0.2364949341802277 8.550667949311064
epoch 20 0.19072466435090485 8.803233725132323
epoch 25 0.24765993368798012 8.487918008702971
epoch 30 0.2509874961186508 8.469126388970022
epoch 35 0.24919037901195729 8.479280353935703
epoch 40 0.20316741682362738 8.735295931164782
epoch 45 0.25486110019285324 8.44719847227914
[32m[I 2022-03-02 23:17:44,108][0m Trial 16 finished with value: 8.469114503340242 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.3531085608108665, 'n_units_l(Invariant)': 336, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0005550341957837297, 'weight_decay': 0.22022554092115465, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 17 | Model params: 197834 | Timestamp: 2022-03-02 23:17:44.108727

[32m[I 2022-03-02 23:18:29,362][0m Trial 17 pruned. [0m
epoch 0 0.12555002047469477 9.150852732442763

Trial Id: 18 | Model params: 173066 | Timestamp: 2022-03-02 23:18:29.362514

[32m[I 2022-03-02 23:19:07,998][0m Trial 18 pruned. [0m
epoch 0 0.121201449862261 9.173577748629725

Trial Id: 19 | Model params: 353154 | Timestamp: 2022-03-02 23:19:07.998827

epoch 0 -0.8846743542902606 13.434213337229366
epoch 5 -1.300554933907895 14.842613691877617
epoch 10 -0.7750331189539257 13.037589732607398
epoch 15 -0.2554359640755328 10.964563902392378
epoch 20 -0.22520430642502887 10.831742759855096
epoch 25 -0.21152993748540783 10.771127216591566
epoch 30 -0.19092340827559884 10.67913301722548
epoch 35 -0.20156616152966156 10.726744216769058
epoch 40 -0.16827324816494493 10.577092349757498
epoch 45 -0.17459605308559678 10.605675838117124
[32m[I 2022-03-03 00:00:39,976][0m Trial 19 finished with value: 10.408490849353328 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.42673497811263095, 'n_units_l(Invariant)': 192, 'n_layers_mlp': 4, 'initialiser': 'kaiming_he', 'lr': 2.1241133150557686e-05, 'weight_decay': 0.03417457017333318, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 20 | Model params: 274718 | Timestamp: 2022-03-03 00:00:39.976448

[32m[I 2022-03-03 00:01:45,065][0m Trial 20 pruned. [0m
epoch 0 -0.0793966696889592 10.166807885535462

Trial Id: 21 | Model params: 225440 | Timestamp: 2022-03-03 00:01:45.065741

[32m[I 2022-03-03 00:03:02,217][0m Trial 21 pruned. [0m
epoch 0 0.18430189256683827 8.83809789167032

Trial Id: 22 | Model params: 244532 | Timestamp: 2022-03-03 00:03:02.217776

[32m[I 2022-03-03 00:04:19,923][0m Trial 22 pruned. [0m
epoch 0 0.22084938809669596 8.637832699867879

Trial Id: 23 | Model params: 230342 | Timestamp: 2022-03-03 00:04:19.923408

[32m[I 2022-03-03 00:05:12,958][0m Trial 23 pruned. [0m
epoch 0 0.1554812636733789 8.99287847862269

Trial Id: 24 | Model params: 205574 | Timestamp: 2022-03-03 00:05:12.958934

[32m[I 2022-03-03 00:06:29,161][0m Trial 24 pruned. [0m
epoch 0 0.2376537359346973 8.544176642335893

Trial Id: 25 | Model params: 247886 | Timestamp: 2022-03-03 00:06:29.161819

epoch 0 -0.16704132796195048 10.571514215280137
epoch 5 0.014839892591275716 9.712868051391395
epoch 10 0.07906525838459089 9.39092795113871
epoch 15 0.1760054889961019 8.882929995677493
epoch 20 0.24639857497791462 8.495030367894143
epoch 25 0.22046784750419557 8.639947361905332
epoch 30 0.24360192642860967 8.510778489499438
epoch 35 0.256451272761018 8.438180235949314
epoch 40 0.24890621218599174 8.480884823411298
epoch 45 0.21753568969939108 8.65618140110807
[32m[I 2022-03-03 00:55:51,456][0m Trial 25 finished with value: 8.504776707710256 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.3112272814054811, 'n_units_l(Invariant)': 294, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 8.719338560223228e-05, 'weight_decay': 0.16988975975808934, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 50}. Best is trial 11 with value: 8.328703448860335.[0m

Trial Id: 26 | Model params: 228020 | Timestamp: 2022-03-03 00:55:51.456820

[32m[I 2022-03-03 00:56:42,545][0m Trial 26 pruned. [0m
epoch 0 0.00037168057490544193 9.783930427013013

Trial Id: 27 | Model params: 189320 | Timestamp: 2022-03-03 00:56:42.545561

[32m[I 2022-03-03 00:57:25,059][0m Trial 27 pruned. [0m
epoch 0 0.14246154120922805 9.061933761827312

Trial Id: 28 | Model params: 206864 | Timestamp: 2022-03-03 00:57:25.059255

[32m[I 2022-03-03 00:58:41,687][0m Trial 28 pruned. [0m
epoch 0 0.22399058339533573 8.620403128779623

Trial Id: 29 | Model params: 83672 | Timestamp: 2022-03-03 00:58:41.687872

epoch 0 -6.587031170589492 26.95442143812623
epoch 5 -6.698026105913813 27.150871229671175
[32m[I 2022-03-03 01:02:09,648][0m Trial 29 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  16
  Number of complete trials:  14

Best trial:
  Value:  8.328703448860335
  Params: 
    n_layers_fe: 2
    fe_neurons: 256
    fe_dropout: 0.37320416203069967
    n_units_l(Invariant): 197
    n_layers_mlp: 2
    initialiser: uniform
    lr: 0.0003881372563740905
    weight_decay: 0.00437306288214083
    criterion: MSELoss
    batch_size: 256
    epochs: 50
Target: 72610, NaN: 0, Max: 105.0, Min: 1.0, Mean: 25.195950970940643
Prediction: 72610, NaN: 0, Max: 46.77867126464844, Min: 10.544905662536621, Mean: 24.737056397465764

 XXXXXX======== TRIAL north - rlbg ended

Test Set - R-squared:  0.2756196891324698
Test Set - RMSE:  8.328703448860335
Test Set - MAE:  6.440849697148237



[32m[I 2022-03-03 01:04:01,495][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: lrg
Training Set: 290439
Validation Set: 72610
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 30

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 115912 | Timestamp: 2022-03-03 01:04:01.495761

epoch 0 -1.9222932563161854 8.324535859289497
epoch 5 -1.564173738500592 7.797795733750445
epoch 10 -1.5216872164658861 7.732923946818924
epoch 15 -1.585767520520434 7.8305608461735545
epoch 20 -1.7054686169732394 8.009757740053155
epoch 25 -1.7140414842326814 8.022438034920079
epoch 30 -1.7041524511224861 8.007809195537801
epoch 35 -1.7120009037724895 8.019421590879084
epoch 40 -1.7073732289465826 8.01257662259963
epoch 45 -1.7143487019989543 8.022892074728404
[32m[I 2022-03-03 01:52:08,792][0m Trial 0 finished with value: 8.005688904272077 and parameters: {'n_layers_fe': 4, 'fe_neurons': 128, 'fe_dropout': 0.23068996517038037, 'n_units_l(Invariant)': 291, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 3.2694954205339826e-05, 'weight_decay': 0.24157178242372104, 'criterion': 'PoissonNLLLoss', 'batch_size': 256, 'epochs': 50}. Best is trial 0 with value: 8.005688904272077.[0m

Trial Id: 1 | Model params: 104212 | Timestamp: 2022-03-03 01:52:08.793035

epoch 0 -0.3566486499436001 5.671942558955143
epoch 5 -0.0012158863199043246 4.872613863082745
epoch 10 0.007375507568427198 4.851662968209106
epoch 15 0.007645632148989501 4.851002777670174
epoch 20 0.007100181305452757 4.852335779342402
[32m[I 2022-03-03 02:06:59,565][0m Trial 1 finished with value: 4.853277235502351 and parameters: {'n_layers_fe': 2, 'fe_neurons': 128, 'fe_dropout': 0.2786403658703153, 'n_units_l(Invariant)': 201, 'n_layers_mlp': 4, 'initialiser': 'normal', 'lr': 7.481885332504913e-05, 'weight_decay': 0.2723782688481518, 'criterion': 'MSELoss', 'batch_size': 128, 'epochs': 25}. Best is trial 1 with value: 4.853277235502351.[0m

Trial Id: 2 | Model params: 41198 | Timestamp: 2022-03-03 02:06:59.566108

epoch 0 -0.054484385075020514 5.000554984837891
epoch 5 0.009593437098862956 4.846239636275237
epoch 10 0.00913006220462953 4.847373192565626
epoch 15 0.010294361142985431 4.844524458275086
epoch 20 0.011599332783519989 4.8413295424806755
epoch 25 0.011448384829408353 4.841699210832074
epoch 30 0.011742960573676742 4.840977774847674
epoch 35 0.01261809190534302 4.8388338844131855
epoch 40 0.012263516873178726 4.839702634215804
epoch 45 0.013100959841998994 4.837650551274212
epoch 50 0.013217622717959676 4.837364609712252
epoch 55 0.012835410785247303 4.838301350943027
epoch 60 0.013585832391890817 4.836462014229024
epoch 65 0.01435214763144843 4.83458299891898
epoch 70 0.013621499837107476 4.836374573370504
[32m[I 2022-03-03 02:49:18,935][0m Trial 2 finished with value: 4.8346284008037745 and parameters: {'n_layers_fe': 2, 'fe_neurons': 64, 'fe_dropout': 0.2327940545244253, 'n_units_l(Invariant)': 438, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.0004835264121755147, 'weight_decay': 0.003567518588292828, 'criterion': 'MSELoss', 'batch_size': 256, 'epochs': 75}. Best is trial 2 with value: 4.8346284008037745.[0m

Trial Id: 3 | Model params: 567040 | Timestamp: 2022-03-03 02:49:18.935806

epoch 0 -0.0062646368215084625 4.884883782632095
epoch 5 -3.845554985559829e-10 4.869654290355475
epoch 10 -0.000589437886751476 4.871089257360965
epoch 15 -0.0003762597227141562 4.870570330646223
epoch 20 -3.5433647514075766 10.37975093642422
epoch 25 -44070.054931714905 1022.2917445587561
epoch 30 -6773851663941.026 12674066.209475389
epoch 35 -910.5279648178829 147.02227171953786
epoch 40 -1.2566920001559388e+22 545899323034.26825
epoch 45 -7.062998597084951e+17 4092537716.304383
[32m[I 2022-03-03 04:33:58,051][0m Trial 3 finished with value: 11.893470213039416 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.27809898992336, 'n_units_l(Invariant)': 511, 'n_layers_mlp': 4, 'initialiser': 'normal', 'lr': 0.00584032960661842, 'weight_decay': 0.09783310696680375, 'criterion': 'MSELoss', 'batch_size': 32, 'epochs': 50}. Best is trial 2 with value: 4.8346284008037745.[0m

Trial Id: 4 | Model params: 401658 | Timestamp: 2022-03-03 04:33:58.051653

epoch 0 -1.6990770018971313 8.000290699715846
epoch 5 -1.6877344692847989 7.983462892736803
epoch 10 -1.704919270583202 8.008944506653085
epoch 15 -1.703604306151044 8.006997543294636
epoch 20 -1.6796733181708174 7.971481756083033
[32m[I 2022-03-03 05:20:44,199][0m Trial 4 finished with value: 8.00440114977436 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.2209929563609292, 'n_units_l(Invariant)': 380, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 2.506805964546197e-05, 'weight_decay': 0.0914671666074023, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 25}. Best is trial 2 with value: 4.8346284008037745.[0m

Trial Id: 5 | Model params: 32622 | Timestamp: 2022-03-03 05:20:44.199650

[32m[I 2022-03-03 05:21:16,565][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 97582 | Timestamp: 2022-03-03 05:21:16.565194

[32m[I 2022-03-03 05:22:06,859][0m Trial 6 pruned. [0m
epoch 0 0.0069114378767789475 4.852796955261127

Trial Id: 7 | Model params: 88612 | Timestamp: 2022-03-03 05:22:06.859908

epoch 0 -0.7685652264374137 6.476027306936946
epoch 5 -0.0012449905374678494 4.872684683265153
[32m[I 2022-03-03 05:25:54,086][0m Trial 7 pruned. [0m

Trial Id: 8 | Model params: 290714 | Timestamp: 2022-03-03 05:25:54.086727

epoch 0 -2.440212422160457 9.032142074313654
epoch 5 -2.518963557717916 9.134936129739481
epoch 10 -2.8401985219133996 9.542781250034205
epoch 15 -3.0003569994237838 9.739743185085214
epoch 20 -2.959370864674105 9.68971987503492
[32m[I 2022-03-03 06:01:22,511][0m Trial 8 finished with value: 9.546096580597162 and parameters: {'n_layers_fe': 2, 'fe_neurons': 256, 'fe_dropout': 0.4813135721160101, 'n_units_l(Invariant)': 460, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 1.7753702159367407e-05, 'weight_decay': 0.24310925023451715, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 25}. Best is trial 2 with value: 4.8346284008037745.[0m

Trial Id: 9 | Model params: 89912 | Timestamp: 2022-03-03 06:01:22.511598

epoch 0 -1.3896316008133955 7.527722602559426
epoch 5 -0.1768472391958651 5.282727110416645
[32m[I 2022-03-03 06:07:45,038][0m Trial 9 pruned. [0m

Trial Id: 10 | Model params: 44964 | Timestamp: 2022-03-03 06:07:45.038996

[32m[I 2022-03-03 06:08:16,008][0m Trial 10 pruned. [0m
epoch 0 0.007863641820154754 4.850469891614047

Trial Id: 11 | Model params: 38364 | Timestamp: 2022-03-03 06:08:16.008745

[32m[I 2022-03-03 06:08:45,059][0m Trial 11 pruned. [0m
epoch 0 0.004256999173147036 4.859278177725287

Trial Id: 12 | Model params: 34074 | Timestamp: 2022-03-03 06:08:45.059364

[32m[I 2022-03-03 06:09:12,348][0m Trial 12 pruned. [0m
epoch 0 -0.03614513236684935 4.956880236999753

Trial Id: 13 | Model params: 43512 | Timestamp: 2022-03-03 06:09:12.349038

[32m[I 2022-03-03 06:09:43,823][0m Trial 13 pruned. [0m
epoch 0 0.00615701069022867 4.854639886016203

Trial Id: 14 | Model params: 78212 | Timestamp: 2022-03-03 06:09:43.823277

[32m[I 2022-03-03 06:10:10,575][0m Trial 14 pruned. [0m
epoch 0 0.003995666807635856 4.8599157937318385

Trial Id: 15 | Model params: 102128 | Timestamp: 2022-03-03 06:10:10.575878

[32m[I 2022-03-03 06:10:56,502][0m Trial 15 pruned. [0m
epoch 0 -0.07912690607582284 5.058647189599267

Trial Id: 16 | Model params: 31034 | Timestamp: 2022-03-03 06:10:56.502342

[32m[I 2022-03-03 06:11:24,483][0m Trial 16 pruned. [0m
epoch 0 -0.02824709026325012 4.9379521264084385

Trial Id: 17 | Model params: 27870 | Timestamp: 2022-03-03 06:11:24.483991

[32m[I 2022-03-03 06:11:51,682][0m Trial 17 pruned. [0m
epoch 0 0.007696571188549162 4.850878271444597

Trial Id: 18 | Model params: 80942 | Timestamp: 2022-03-03 06:11:51.682772

[32m[I 2022-03-03 06:12:14,127][0m Trial 18 pruned. [0m
epoch 0 -0.11948368604252657 5.1523696701864115

Trial Id: 19 | Model params: 76388 | Timestamp: 2022-03-03 06:12:14.127308

[32m[I 2022-03-03 06:13:35,523][0m Trial 19 pruned. [0m
epoch 0 -0.10269472096079002 5.113588519079337

Trial Id: 20 | Model params: 45752 | Timestamp: 2022-03-03 06:13:35.523895

[32m[I 2022-03-03 06:14:13,319][0m Trial 20 pruned. [0m
epoch 0 -0.014142229047012789 4.903967282947775

Trial Id: 21 | Model params: 410688 | Timestamp: 2022-03-03 06:14:13.319241

epoch 0 -2.3435794156790273 8.904385462922898
epoch 5 -1.809294586373253 8.162003405746837
epoch 10 -1.702392426744574 8.005202790445228
epoch 15 -1.7145656659719108 8.023212712190194
epoch 20 -1.707113690967287 8.012192557010827
[32m[I 2022-03-03 07:03:08,618][0m Trial 21 finished with value: 8.000474615459478 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.23697041564929544, 'n_units_l(Invariant)': 415, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.00014069857558348617, 'weight_decay': 0.08618092933217884, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 25}. Best is trial 2 with value: 4.8346284008037745.[0m

Trial Id: 22 | Model params: 413526 | Timestamp: 2022-03-03 07:03:08.618999

[32m[I 2022-03-03 07:05:05,935][0m Trial 22 pruned. [0m
epoch 0 -1.6867007456798593 7.981927494095134

Trial Id: 23 | Model params: 389274 | Timestamp: 2022-03-03 07:05:05.935862

[32m[I 2022-03-03 07:06:56,017][0m Trial 23 pruned. [0m
epoch 0 -1.6260957861800818 7.891388269505191

Trial Id: 24 | Model params: 408366 | Timestamp: 2022-03-03 07:06:56.017773

epoch 0 -1.7467857061991272 8.07068728231791
epoch 5 -1.7206367362346726 8.032179576519388
epoch 10 -1.7054416306937221 8.00971779242654
epoch 15 -1.710629167131084 8.017393212901785
epoch 20 -1.7172828799783848 8.027227227927773
[32m[I 2022-03-03 07:55:19,978][0m Trial 24 finished with value: 8.010947130304755 and parameters: {'n_layers_fe': 4, 'fe_neurons': 256, 'fe_dropout': 0.3965678836584782, 'n_units_l(Invariant)': 406, 'n_layers_mlp': 2, 'initialiser': 'uniform', 'lr': 0.00043272054562955753, 'weight_decay': 0.13096888244154445, 'criterion': 'PoissonNLLLoss', 'batch_size': 32, 'epochs': 25}. Best is trial 2 with value: 4.8346284008037745.[0m

Trial Id: 25 | Model params: 293294 | Timestamp: 2022-03-03 07:55:19.978534

[32m[I 2022-03-03 07:56:29,631][0m Trial 25 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 26 | Model params: 253820 | Timestamp: 2022-03-03 07:56:29.631245

[32m[I 2022-03-03 07:57:53,982][0m Trial 26 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 27 | Model params: 140226 | Timestamp: 2022-03-03 07:57:53.982294

[32m[I 2022-03-03 07:59:39,238][0m Trial 27 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 28 | Model params: 294584 | Timestamp: 2022-03-03 07:59:39.239006

[32m[I 2022-03-03 08:00:49,340][0m Trial 28 pruned. [0m
epoch 0 0.008181523231054366 4.849692781832599

Trial Id: 29 | Model params: 46944 | Timestamp: 2022-03-03 08:00:49.340223

epoch 0 -1.871802789433925 8.252308157426366
epoch 5 -1.7689103166041091 8.103125686157915
epoch 10 -1.7366702102241973 8.05581274995778
epoch 15 -1.7152016744374445 8.024152555424244
epoch 20 -1.6978248950771824 7.99843480961698
epoch 25 -1.7152557143305147 8.024232406249434
epoch 30 -1.7103020321262243 8.016909404725967
epoch 35 -1.6995928560550366 8.001055180693616
epoch 40 -1.700808239611661 8.002856055337896
epoch 45 -1.6927994583468253 7.990981700921243
[32m[I 2022-03-03 08:35:25,143][0m Trial 29 finished with value: 8.0130895545462 and parameters: {'n_layers_fe': 4, 'fe_neurons': 64, 'fe_dropout': 0.2454322293558818, 'n_units_l(Invariant)': 399, 'n_layers_mlp': 2, 'initialiser': 'kaiming_he', 'lr': 9.22921392316379e-05, 'weight_decay': 0.16935438454830135, 'criterion': 'PoissonNLLLoss', 'batch_size': 128, 'epochs': 50}. Best is trial 2 with value: 4.8346284008037745.[0m

Study statistics: 
  Number of finished trials:  30
  Number of pruned trials:  21
  Number of complete trials:  9

Best trial:
  Value:  4.8346284008037745
  Params: 
    n_layers_fe: 2
    fe_neurons: 64
    fe_dropout: 0.2327940545244253
    n_units_l(Invariant): 438
    n_layers_mlp: 2
    initialiser: uniform
    lr: 0.0004835264121755147
    weight_decay: 0.003567518588292828
    criterion: MSELoss
    batch_size: 256
    epochs: 75
Traceback (most recent call last):
  File "hp_optim.py", line 435, in <module>
    main()
  File "hp_optim.py", line 76, in main
    model = torch.load(f"trained_models/{area}/{gal}/{trial.number}.pt")
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 594, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/vol/bitbucket/ele20/venv/lib/python3.8/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'trained_models/north/lrg/2.pt'
./hp_optim.sh: line 11: 10: command not found
./hp_optim.sh: line 12: syntax error near unexpected token `done'
./hp_optim.sh: line 12: `    done'
