[32m[I 2022-02-25 14:35:31,454][0m A new study created in memory with name: DeepSet[0m
Starting Loading north
Finished Loading north
Finished north setup

++++++++ Session Characteristics +++++++

Area: north
Gal Type: rlbg
Training Set: 232352
Validation Set: 58087
Test Samples: 72610
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 20

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 102667 | Timestamp: 2022-02-25 14:35:31.455223

[32m[I 2022-02-25 14:35:52,743][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 113484 | Timestamp: 2022-02-25 14:35:52.744056

epoch 0 0.19851700489086554 8.752376820735892
epoch 5 0.17722703257656613 8.867860614515415
epoch 10 0.2134953464806123 8.670207659501969
epoch 15 0.18251021225172714 8.839343663775063
epoch 20 0.18790506314896382 8.810128695309322
epoch 25 0.1828521628355153 8.837494750844938
epoch 30 0.20962311919013032 8.691524630202519
epoch 35 0.20468532241633797 8.71863205328627
epoch 40 0.20378730184517513 8.72355293696467
epoch 45 0.15722864203504894 8.974985070143772
epoch 50 0.21924279460601082 8.638470441053116
epoch 55 0.2151327535548605 8.661177798124488
epoch 60 0.21126500515960844 8.682492286529238
epoch 65 0.2093783627489766 8.69287028062751
epoch 70 0.18393856731887548 8.83161803748428
epoch 75 0.16675878153303958 8.924095799134905
epoch 80 0.20592346745659384 8.71184283136142
epoch 85 0.20545892962433587 8.714390689606988
epoch 90 0.2028094262365523 8.728908247202238
epoch 95 0.21346863839050978 8.670354869515608
[32m[I 2022-02-25 16:11:51,060][0m Trial 1 finished with value: 9.516517123708946 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 51, 'fe_dropout_l0': 0.12925796518844912, 'fe_n_units_l1': 42, 'fe_dropout_l1': 0.25769438439155073, 'n_units_l(Invariant)': 79, 'n_layers_mlp': 4, 'mlp_n_units_l0': 201, 'mlp_dropout_l0': 0.09660531070491102, 'mlp_n_units_l1': 197, 'mlp_dropout_l1': 0.43428157578128584, 'mlp_n_units_l2': 247, 'mlp_dropout_l2': 0.015510263795026291, 'mlp_n_units_l3': 57, 'mlp_dropout_l3': 0.06801072793387175, 'reduction': 'sum', 'lr': 0.0051976503830665766, 'weight_decay': 0.01074051989980932, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 1 with value: 9.516517123708946.[0m

Trial Id: 2 | Model params: 129744 | Timestamp: 2022-02-25 16:11:51.060815

epoch 0 -6.425062325047042 26.639673808815893
epoch 5 -6.379168580770957 26.55721730033392
epoch 10 -6.284962471133834 26.38715149634394
epoch 15 -5.2399621844277595 24.42135911555181
epoch 20 -5.13321813619838 24.21157582566794
epoch 25 -5.117263589824711 24.180064126439905
epoch 30 -5.199417261722242 24.341889420043113
epoch 35 -5.170619740147953 24.285287161544357
epoch 40 -5.176150121466663 24.296167496472606
epoch 45 -5.1812743167639095 24.306244364117703
epoch 50 -5.162242245805652 24.26879619594332
epoch 55 -5.122745216324206 24.19089547270113
epoch 60 -5.126978728280435 24.19925730589
epoch 65 -5.13417811812501 24.213470570422405
epoch 70 -5.14226661621839 24.229429194983215
epoch 75 -5.1075026250832885 24.160765057805406
epoch 80 -5.106782709276076 24.15934105274604
epoch 85 -5.107082503170178 24.15993406009451
epoch 90 -5.10340406108017 24.152656910604975
epoch 95 -5.107982482441415 24.161714176773195
[32m[I 2022-02-25 17:00:12,354][0m Trial 2 finished with value: 24.115166580239492 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 247, 'fe_dropout_l0': 0.1636559705606827, 'fe_n_units_l1': 158, 'fe_dropout_l1': 0.49491600027683674, 'fe_n_units_l2': 87, 'fe_dropout_l2': 0.0850711837621903, 'fe_n_units_l3': 137, 'fe_dropout_l3': 0.49758930803589335, 'n_units_l(Invariant)': 419, 'n_layers_mlp': 2, 'mlp_n_units_l0': 102, 'mlp_dropout_l0': 0.0025916543850680873, 'mlp_n_units_l1': 25, 'mlp_dropout_l1': 0.3885612995052118, 'reduction': 'sum', 'lr': 1.2781190185840143e-05, 'weight_decay': 0.08157893109345862, 'criterion': 'PoissonNLLLoss', 'batch_size': 128}. Best is trial 1 with value: 9.516517123708946.[0m

Trial Id: 3 | Model params: 129894 | Timestamp: 2022-02-25 17:00:12.354597

[32m[I 2022-02-25 17:00:40,889][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 88000 | Timestamp: 2022-02-25 17:00:40.889464

[32m[I 2022-02-25 17:00:59,719][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 61542 | Timestamp: 2022-02-25 17:00:59.720147

[32m[I 2022-02-25 17:01:17,369][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 274322 | Timestamp: 2022-02-25 17:01:17.370171

[32m[I 2022-02-25 17:02:24,937][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 67152 | Timestamp: 2022-02-25 17:02:24.937963

[32m[I 2022-02-25 17:03:29,189][0m Trial 7 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 8 | Model params: 43339 | Timestamp: 2022-02-25 17:03:29.189755

epoch 0 -5.2349077646059765 24.411466362673867
epoch 5 -5.318489188447755 24.574544369242577
epoch 10 -5.252760723159073 24.446391126704306
epoch 15 -5.11695164532482 24.179447597982115
epoch 20 -5.122114112794426 24.189648699202177
epoch 25 -5.083704451142724 24.11364732983373
epoch 30 -5.058958209688273 24.06455469293379
epoch 35 -5.0807542255634655 24.10779979675993
epoch 40 -5.050682297731552 24.048114227247172
epoch 45 -5.049418149305945 24.0456019507574
epoch 50 -5.057330226155808 24.06132151906511
epoch 55 -5.052309491303849 24.05134760692905
epoch 60 -5.051385995930067 24.04951259207841
epoch 65 -5.056450032893959 24.05957327506109
epoch 70 -5.052301707454989 24.051332140757406
epoch 75 -5.049927036513623 24.04661330768494
epoch 80 -5.050784958049159 24.048318235361563
epoch 85 -5.052272326220363 24.051273761423026
epoch 90 -5.052723140235894 24.052169495191908
epoch 95 -5.05804617316378 24.06274344271054
[32m[I 2022-02-25 17:32:50,010][0m Trial 8 finished with value: 24.051606611138247 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 44, 'fe_dropout_l0': 0.41353628752571864, 'fe_n_units_l1': 16, 'fe_dropout_l1': 0.010281617579098179, 'n_units_l(Invariant)': 222, 'n_layers_mlp': 4, 'mlp_n_units_l0': 143, 'mlp_dropout_l0': 0.08709741485400513, 'mlp_n_units_l1': 153, 'mlp_dropout_l1': 0.015219632256144033, 'mlp_n_units_l2': 46, 'mlp_dropout_l2': 0.38490716257954205, 'mlp_n_units_l3': 124, 'mlp_dropout_l3': 0.3742822163361941, 'reduction': 'sum', 'lr': 0.002659766124264978, 'weight_decay': 0.018564427873738985, 'criterion': 'PoissonNLLLoss', 'batch_size': 128}. Best is trial 1 with value: 9.516517123708946.[0m

Trial Id: 9 | Model params: 134749 | Timestamp: 2022-02-25 17:32:50.010799

[32m[I 2022-02-25 17:33:11,126][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 44836 | Timestamp: 2022-02-25 17:33:11.126976

epoch 0 0.2032081902204268 8.726724823481534
epoch 5 0.2300086160834871 8.578705988424412
epoch 10 0.24028653128983113 8.521258967483032
epoch 15 0.23570731588887617 8.54690156736841
epoch 20 0.21461710703227943 8.664022465762372
epoch 25 0.2300889285471418 8.578258584080785
epoch 30 0.22950455008085002 8.581513504621817
epoch 35 0.21917319205283026 8.638855481494957
epoch 40 0.23755459180279004 8.536566497197962
epoch 45 0.20843358153140412 8.698062655895345
epoch 50 0.23830027220417416 8.532391045801326
epoch 55 0.23583029350093265 8.546213925152877
epoch 60 0.15688235810906592 8.976828733821705
epoch 65 0.23982730060524882 8.523834038587982
epoch 70 0.24190582195665278 8.512172807914236
epoch 75 0.242501782901124 8.508826310816707
epoch 80 0.24248891847620568 8.50889856226893
epoch 85 0.22302460621835918 8.617523644725269
epoch 90 0.2341759930407079 8.55545949074654
epoch 95 0.24448387496847956 8.497686796719707
[32m[I 2022-02-25 19:07:40,732][0m Trial 10 finished with value: 8.552283414692512 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 170, 'fe_dropout_l0': 0.28001107364137934, 'fe_n_units_l1': 11, 'fe_dropout_l1': 0.23829818321416332, 'n_units_l(Invariant)': 3, 'n_layers_mlp': 4, 'mlp_n_units_l0': 182, 'mlp_dropout_l0': 0.19390348583363742, 'mlp_n_units_l1': 104, 'mlp_dropout_l1': 0.4762220996401481, 'mlp_n_units_l2': 140, 'mlp_dropout_l2': 0.010178169924636854, 'mlp_n_units_l3': 28, 'mlp_dropout_l3': 0.00269309367594002, 'reduction': 'sum', 'lr': 0.0005127828339778242, 'weight_decay': 0.18020197798571302, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 10 with value: 8.552283414692512.[0m

Trial Id: 11 | Model params: 47637 | Timestamp: 2022-02-25 19:07:40.733116

epoch 0 0.11664541332551537 9.188537355406519
epoch 5 0.23475164019276884 8.552243443930452
epoch 10 0.1435091930286565 9.047741916783966
epoch 15 0.24133842105721182 8.515357709776156
epoch 20 0.19190314209579085 8.78841507021142
epoch 25 0.23479302477426844 8.552012188419384
epoch 30 0.2000318399300529 8.744101737033
epoch 35 0.23704966950169692 8.539392659815434
epoch 40 0.23947656226044467 8.525800230398602
epoch 45 0.2288158229278352 8.585348051069849
epoch 50 0.24003775954803064 8.522654016414505
epoch 55 0.2142253022230609 8.666183311406947
epoch 60 0.2442129865121192 8.49921007258524
epoch 65 0.23781561382156635 8.535105131874525
epoch 70 0.2287845958059509 8.58552187011598
epoch 75 0.24200058278637926 8.511640785779234
epoch 80 0.2347363865842963 8.55232867895338
epoch 85 0.2330261202884425 8.561880025783058
epoch 90 0.24051108016551792 8.51999955810744
epoch 95 0.24664043447278605 8.485550150875865
[32m[I 2022-02-25 20:41:33,346][0m Trial 11 finished with value: 8.653931515237831 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 179, 'fe_dropout_l0': 0.2992804318938311, 'fe_n_units_l1': 14, 'fe_dropout_l1': 0.21005336886355114, 'n_units_l(Invariant)': 5, 'n_layers_mlp': 4, 'mlp_n_units_l0': 195, 'mlp_dropout_l0': 0.21725947452196498, 'mlp_n_units_l1': 113, 'mlp_dropout_l1': 0.4869748923269189, 'mlp_n_units_l2': 131, 'mlp_dropout_l2': 0.012346801340741414, 'mlp_n_units_l3': 18, 'mlp_dropout_l3': 0.020323684656655516, 'reduction': 'sum', 'lr': 0.0005874695230281401, 'weight_decay': 0.19483100181423876, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 10 with value: 8.552283414692512.[0m

Trial Id: 12 | Model params: 45411 | Timestamp: 2022-02-25 20:41:33.346957

epoch 0 0.10726201161044668 9.237210889261151
epoch 5 0.22494431629048428 8.60687119794364
epoch 10 0.23048017229158568 8.57607871122358
epoch 15 0.23573297848637476 8.546758076830997
epoch 20 0.24144371561523292 8.514766766486046
epoch 25 0.1571228699876428 8.97554825537405
epoch 30 0.1455449373623352 9.036982988072282
epoch 35 0.22819577970477378 8.588798729562068
epoch 40 0.23596604133704902 8.545454812639196
epoch 45 0.18723849292674977 8.8137436451224
epoch 50 0.2347537142356797 8.552231854404203
epoch 55 0.23431862836186412 8.554662723129397
epoch 60 0.23500747524797272 8.55081374692807
epoch 65 0.23397950209321816 8.556556976924915
epoch 70 0.23956720714539748 8.525292130863686
epoch 75 0.23699208868991184 8.539714893036129
[32m[I 2022-02-25 21:55:47,992][0m Trial 12 pruned. [0m

Trial Id: 13 | Model params: 58541 | Timestamp: 2022-02-25 21:55:47.992252

[32m[I 2022-02-25 21:56:44,106][0m Trial 13 pruned. [0m
epoch 0 0.22597950253287757 8.601121487408971

Trial Id: 14 | Model params: 72943 | Timestamp: 2022-02-25 21:56:44.106574

[32m[I 2022-02-25 21:57:40,935][0m Trial 14 pruned. [0m
epoch 0 0.19000569372158893 8.798726820871327

Trial Id: 15 | Model params: 126689 | Timestamp: 2022-02-25 21:57:40.935851

epoch 0 -0.44855094700573406 11.766457710672814
epoch 5 0.14908698766076878 9.018232622168663
epoch 10 0.1926406118457683 8.784403998047912
epoch 15 0.24140741302693713 8.514970511666547
epoch 20 0.21568945903576542 8.658105571268539
epoch 25 0.2090770292553633 8.694526700907517
epoch 30 0.2414957334251483 8.514474812466428
epoch 35 0.2305872294034217 8.575482130005083
epoch 40 0.23664250675583676 8.541670959376292
epoch 45 0.25010498085387267 8.46601601281553
epoch 50 0.23470964349933565 8.552478113507899
epoch 55 0.25526586770690984 8.436833538365368
epoch 60 0.25212280354489514 8.454618133130358
epoch 65 0.2424840605062586 8.508925846297002
epoch 70 0.25601080650869545 8.4326129065695
epoch 75 0.24386438010812084 8.501169974931727
epoch 80 0.24957286084093722 8.469019191628012
epoch 85 0.251863127274198 8.456085802671861
epoch 90 0.254513772176696 8.44109257747765
epoch 95 0.2506688763076891 8.462832336688399
[32m[I 2022-02-25 22:25:43,515][0m Trial 15 finished with value: 8.452347790830217 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 217, 'fe_dropout_l0': 0.2275781611992994, 'fe_n_units_l1': 223, 'fe_dropout_l1': 0.3950694740832316, 'n_units_l(Invariant)': 125, 'n_layers_mlp': 4, 'mlp_n_units_l0': 164, 'mlp_dropout_l0': 0.35038007773735896, 'mlp_n_units_l1': 128, 'mlp_dropout_l1': 0.05755591466548654, 'mlp_n_units_l2': 172, 'mlp_dropout_l2': 0.14002073324699468, 'mlp_n_units_l3': 9, 'mlp_dropout_l3': 0.19708940781423287, 'reduction': 'sum', 'lr': 0.0012186646059899131, 'weight_decay': 0.16411955614215204, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 15 with value: 8.452347790830217.[0m

Trial Id: 16 | Model params: 135532 | Timestamp: 2022-02-25 22:25:43.516150

[32m[I 2022-02-25 22:26:02,014][0m Trial 16 pruned. [0m
epoch 0 0.20424071405912403 8.721068720921037

Trial Id: 17 | Model params: 110379 | Timestamp: 2022-02-25 22:26:02.014966

epoch 0 -0.7518503838252926 12.939793848871215
epoch 5 0.04598469499245106 9.5489698498141
epoch 10 0.04446537884296087 9.556570426285651
epoch 15 0.1532388683033682 8.996204277109095
epoch 20 0.1825352489676837 8.839208304389318
epoch 25 0.1533388169218486 8.995673321748535
epoch 30 0.2079486333569902 8.700726654554064
epoch 35 0.23021729706321803 8.577543420817177
epoch 40 0.1898159731056709 8.799757199802679
epoch 45 0.22354943977535513 8.614612658326037
epoch 50 0.21463003451448948 8.663951160123938
epoch 55 0.2557121983189229 8.434304997453586
epoch 60 0.22426930230873798 8.6106183441855
epoch 65 0.24638625515774493 8.48698151879569
epoch 70 0.2573938940240301 8.42477108089307
epoch 75 0.2502320610926959 8.465298639787827
epoch 80 0.26060050360240805 8.40656211551326
epoch 85 0.2611010414407998 8.403716215014864
epoch 90 0.26157208739484294 8.401037115547862
epoch 95 0.2594066317773003 8.413346208327331
[32m[I 2022-02-25 22:55:15,363][0m Trial 17 finished with value: 8.391059710249413 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 215, 'fe_dropout_l0': 0.22443944144018627, 'fe_n_units_l1': 228, 'fe_dropout_l1': 0.4108935831596609, 'n_units_l(Invariant)': 143, 'n_layers_mlp': 4, 'mlp_n_units_l0': 93, 'mlp_dropout_l0': 0.3997156071094362, 'mlp_n_units_l1': 60, 'mlp_dropout_l1': 0.08389082626664524, 'mlp_n_units_l2': 180, 'mlp_dropout_l2': 0.26477154627957555, 'mlp_n_units_l3': 45, 'mlp_dropout_l3': 0.20070155593125982, 'reduction': 'sum', 'lr': 9.698438573821183e-05, 'weight_decay': 0.23961834074306818, 'criterion': 'MSELoss', 'batch_size': 256}. Best is trial 17 with value: 8.391059710249413.[0m

Trial Id: 18 | Model params: 112687 | Timestamp: 2022-02-25 22:55:15.363402

[32m[I 2022-02-25 22:55:34,607][0m Trial 18 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 19 | Model params: 75498 | Timestamp: 2022-02-25 22:55:34.607689

[32m[I 2022-02-25 22:55:51,711][0m Trial 19 pruned. [0m
epoch 0 -0.1955072990116955 10.689440323646497

Study statistics: 
  Number of finished trials:  20
  Number of pruned trials:  13
  Number of complete trials:  7

Best trial:
  Value:  8.391059710249413
  Params: 
    n_layers_fe: 2
    fe_n_units_l0: 215
    fe_dropout_l0: 0.22443944144018627
    fe_n_units_l1: 228
    fe_dropout_l1: 0.4108935831596609
    n_units_l(Invariant): 143
    n_layers_mlp: 4
    mlp_n_units_l0: 93
    mlp_dropout_l0: 0.3997156071094362
    mlp_n_units_l1: 60
    mlp_dropout_l1: 0.08389082626664524
    mlp_n_units_l2: 180
    mlp_dropout_l2: 0.26477154627957555
    mlp_n_units_l3: 45
    mlp_dropout_l3: 0.20070155593125982
    reduction: sum
    lr: 9.698438573821183e-05
    weight_decay: 0.23961834074306818
    criterion: MSELoss
    batch_size: 256
Target: 72610, NaN: 0, Max: 105.0, Min: 1.0, Mean: 25.195950970940643
Prediction: 72610, NaN: 0, Max: 53.880828857421875, Min: 11.61656379699707, Mean: 25.0718203932995

 XXXXXX======== TRIAL north - rlbg ended

Test Set - R-squared:  0.2599660874912847
Test Set - RMSE:  8.418212632022076
Test Set - MAE:  6.530209041354315



