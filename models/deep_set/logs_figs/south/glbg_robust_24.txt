[32m[I 2022-02-24 12:52:57,332][0m A new study created in memory with name: DeepSet[0m
Starting Loading south
Finished Loading south
Finished south setup

++++++++ Session Characteristics +++++++

Area: south
Gal Type: glbg
Training Set: 216650
Validation Set: 54162
Test Samples: 132567
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 20

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 124292 | Timestamp: 2022-02-24 12:52:57.340472

epoch 0 -5.049185488981113 20.672951436317586
epoch 5 -4.850043180515328 20.329821686059926
epoch 10 -4.860820628049976 20.3485397330795
epoch 15 -4.8786459673501525 20.379460679910263
epoch 20 -4.86485658664403 20.35554487239616
epoch 25 -4.876497854468614 20.37573691578611
epoch 30 -4.87627389155749 20.375348635814817
epoch 35 -4.873179200333203 20.36998267450421
epoch 40 -4.870341659694942 20.36506135040189
epoch 45 -4.869989438472376 20.36445038814272
epoch 50 -4.862757083863404 20.35190110482727
epoch 55 -4.860870253797441 20.348625882223157
epoch 60 -4.870639199036544 20.365577447293568
epoch 65 -4.865610403125613 20.35685299067365
epoch 70 -4.869089933265037 20.36289002494573
epoch 75 -4.872791479083162 20.369310295437742
epoch 80 -4.884048077853618 20.388822258994058
epoch 85 -4.871909105997635 20.367780017510896
epoch 90 -4.86724220117664 20.35968440639714
epoch 95 -4.864098504282296 20.354229266635972
[32m[I 2022-02-24 13:54:58,722][0m Trial 0 finished with value: 20.35807414313597 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 186, 'fe_dropout_l0': 0.32763576372827274, 'fe_n_units_l1': 230, 'fe_dropout_l1': 0.0857055664698454, 'n_units_l(Invariant)': 260, 'n_layers_mlp': 2, 'mlp_n_units_l0': 193, 'mlp_dropout_l0': 0.49227585843872873, 'mlp_n_units_l1': 79, 'mlp_dropout_l1': 0.0006089000392890398, 'reduction': 'sum', 'lr': 0.0002573578824655423, 'weight_decay': 0.08974981662244753, 'criterion': 'PoissonNLLLoss', 'batch_size': 32}. Best is trial 0 with value: 20.35807414313597.[0m

Trial Id: 1 | Model params: 103847 | Timestamp: 2022-02-24 13:54:58.722436

[32m[I 2022-02-24 13:55:33,906][0m Trial 1 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 2 | Model params: 115994 | Timestamp: 2022-02-24 13:55:33.907283

[32m[I 2022-02-24 13:56:13,870][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 36636 | Timestamp: 2022-02-24 13:56:13.870782

[32m[I 2022-02-24 13:56:26,696][0m Trial 3 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 4 | Model params: 64712 | Timestamp: 2022-02-24 13:56:26.696647

[32m[I 2022-02-24 13:57:01,056][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 84345 | Timestamp: 2022-02-24 13:57:01.056936

epoch 0 -4.889832756203363 20.39884204500175
epoch 5 -4.872574225368521 20.36893352833563
epoch 10 -4.887496695391183 20.39479628822703
epoch 15 -4.84566130434357 20.322206404752745
epoch 20 -4.85092092439228 20.331346777983093
epoch 25 -4.903392387948106 20.422309754723763
epoch 30 -4.883167854445589 20.387297170346628
epoch 35 -4.890643558962761 20.40024606349699
epoch 40 -4.893432982683347 20.40507560331607
epoch 45 -4.877474431902069 20.377429901874347
epoch 50 -4.887262543099779 20.394390722329224
epoch 55 -4.9085608879931275 20.431247803294227
epoch 60 -4.856821747094607 20.34159656948652
epoch 65 -4.891556435444071 20.401826721298907
epoch 70 -4.89104239872188 20.400936674923837
epoch 75 -4.8796775149398695 20.381248630870658
epoch 80 -4.875861216577318 20.374633170166053
epoch 85 -4.880547507590317 20.38275644151188
epoch 90 -4.889539212749648 20.39833370958683
epoch 95 -4.914497841296674 20.441509939132214
[32m[I 2022-02-24 14:51:54,974][0m Trial 5 finished with value: 20.34840458894042 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 56, 'fe_dropout_l0': 0.03170166365616661, 'fe_n_units_l1': 116, 'fe_dropout_l1': 0.18820872970831293, 'fe_n_units_l2': 134, 'fe_dropout_l2': 0.33101795114713156, 'fe_n_units_l3': 128, 'fe_dropout_l3': 0.1250178405126438, 'n_units_l(Invariant)': 10, 'n_layers_mlp': 4, 'mlp_n_units_l0': 222, 'mlp_dropout_l0': 0.007908912448000072, 'mlp_n_units_l1': 74, 'mlp_dropout_l1': 0.339188380129703, 'mlp_n_units_l2': 161, 'mlp_dropout_l2': 0.29471337331214814, 'mlp_n_units_l3': 58, 'mlp_dropout_l3': 0.4070300209952021, 'reduction': 'sum', 'lr': 0.0077784138803686335, 'weight_decay': 0.27843385356579875, 'criterion': 'PoissonNLLLoss', 'batch_size': 32}. Best is trial 5 with value: 20.34840458894042.[0m

Trial Id: 6 | Model params: 114386 | Timestamp: 2022-02-24 14:51:54.974202

epoch 0 -6.613696087148835 23.19272626502641
epoch 5 0.03735347379559384 8.246837888907962
epoch 10 0.03900692327997968 8.239752427252084
epoch 15 0.03639599193459142 8.250938166108217
epoch 20 0.03549985494921426 8.254773897654465
epoch 25 0.03983969706114565 8.236181466558158
epoch 30 0.03367612380395646 8.26257450742276
epoch 35 0.03931754917050345 8.238420634464603
epoch 40 0.03318091046133953 8.264691402777904
epoch 45 0.03984147787020653 8.23617382873282
epoch 50 0.04017035937580504 8.234763146444294
epoch 55 0.03952927155832864 8.237512762044904
epoch 60 0.03971435233594722 8.236719047735523
epoch 65 0.03854818819242023 8.241718837138869
epoch 70 0.039484550312445355 8.237704536523108
epoch 75 0.03949865995051938 8.23764403179283
epoch 80 0.038702461554829704 8.24105758263269
epoch 85 0.040230085928757764 8.2345069334416
epoch 90 0.03667944127184053 8.249724547781812
epoch 95 0.04022803694078314 8.234515723254884
[32m[I 2022-02-24 15:54:22,687][0m Trial 6 finished with value: 8.239367195084247 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 228, 'fe_dropout_l0': 0.4575045484089722, 'fe_n_units_l1': 227, 'fe_dropout_l1': 0.11270007250803787, 'fe_n_units_l2': 94, 'fe_dropout_l2': 0.11137120756792729, 'fe_n_units_l3': 100, 'fe_dropout_l3': 0.4809198783444059, 'n_units_l(Invariant)': 42, 'n_layers_mlp': 4, 'mlp_n_units_l0': 239, 'mlp_dropout_l0': 0.2632418664232502, 'mlp_n_units_l1': 45, 'mlp_dropout_l1': 0.06772299327558479, 'mlp_n_units_l2': 87, 'mlp_dropout_l2': 0.25798780859802356, 'mlp_n_units_l3': 62, 'mlp_dropout_l3': 0.18461843135686046, 'reduction': 'sum', 'lr': 0.0002092339760537746, 'weight_decay': 0.20241836454150378, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 6 with value: 8.239367195084247.[0m

Trial Id: 7 | Model params: 100692 | Timestamp: 2022-02-24 15:54:22.687625

epoch 0 -4.9123622862644964 20.437819185339837
epoch 5 -4.852242210994362 20.333642315728444
epoch 10 -4.874487869941986 20.372251981428498
epoch 15 -4.887892647511908 20.395482082843248
epoch 20 -4.8839298361096795 20.388617398158416
epoch 25 -4.884998566018222 20.390468961352457
epoch 30 -4.885931731536035 20.392085523198933
epoch 35 -4.889047860798789 20.39748279665853
epoch 40 -4.885708275295017 20.39169843223061
epoch 45 -4.873287790522017 20.370170985635625
epoch 50 -4.8751339350428005 20.37337220156206
epoch 55 -4.873080402915671 20.369811343945557
epoch 60 -4.894674106535471 20.40722408730774
epoch 65 -4.871847189027631 20.36767263211663
epoch 70 -4.87394554900562 20.371311597005544
epoch 75 -4.883025318572775 20.387050199762957
epoch 80 -4.881153490377612 20.38380662275415
epoch 85 -4.868178524425905 20.361308890670408
epoch 90 -4.902357446056071 20.420519527263046
epoch 95 -4.874133667076798 20.37163779863025
[32m[I 2022-02-24 16:38:37,549][0m Trial 7 finished with value: 20.388081094226276 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 10, 'fe_dropout_l0': 0.076415300119058, 'fe_n_units_l1': 75, 'fe_dropout_l1': 0.139178698670131, 'fe_n_units_l2': 185, 'fe_dropout_l2': 0.24348338326807295, 'fe_n_units_l3': 128, 'fe_dropout_l3': 0.4747863063421181, 'n_units_l(Invariant)': 65, 'n_layers_mlp': 4, 'mlp_n_units_l0': 48, 'mlp_dropout_l0': 0.12781533459798539, 'mlp_n_units_l1': 73, 'mlp_dropout_l1': 0.18458635300583154, 'mlp_n_units_l2': 244, 'mlp_dropout_l2': 0.07728698382942767, 'mlp_n_units_l3': 125, 'mlp_dropout_l3': 0.46398758741077245, 'reduction': 'sum', 'lr': 0.0005010937761917012, 'weight_decay': 0.23915021792992924, 'criterion': 'PoissonNLLLoss', 'batch_size': 128}. Best is trial 6 with value: 8.239367195084247.[0m

Trial Id: 8 | Model params: 117132 | Timestamp: 2022-02-24 16:38:37.549439

[32m[I 2022-02-24 16:39:16,382][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 115062 | Timestamp: 2022-02-24 16:39:16.382427

epoch 0 0.0696531071222849 8.107304583484385
epoch 5 0.10661242316527686 7.944635710723394
epoch 10 0.09612071810607736 7.991149388071274
epoch 15 0.1091439866592061 7.933371496617841
epoch 20 0.11188938050217956 7.92113773766253
epoch 25 0.10949164862751981 7.931823322358766
epoch 30 0.10937420681240206 7.932346336553905
epoch 35 0.10942898036685189 7.932102412850094
epoch 40 0.11499409560436002 7.907280000564894
epoch 45 0.11281971450691652 7.9169877846281045
epoch 50 0.10414030652556105 7.955620024124108
epoch 55 0.11086779657132384 7.92569222734049
epoch 60 0.1144112087710829 7.9098835372858
epoch 65 0.1122018370642539 7.919744201125607
epoch 70 0.11463281936087455 7.908893786935702
epoch 75 0.08839813521575224 8.02521425720915
epoch 80 0.10493784261400096 7.952078003604337
epoch 85 0.11645559962467877 7.90074823816427
epoch 90 0.11062965267853919 7.926753559292226
epoch 95 0.11595477510049335 7.902987134086104
[32m[I 2022-02-24 17:39:38,382][0m Trial 9 finished with value: 7.906765759248038 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 52, 'fe_dropout_l0': 0.3500051149927193, 'fe_n_units_l1': 236, 'fe_dropout_l1': 0.10503381935281186, 'n_units_l(Invariant)': 397, 'n_layers_mlp': 2, 'mlp_n_units_l0': 102, 'mlp_dropout_l0': 0.4310928675225717, 'mlp_n_units_l1': 52, 'mlp_dropout_l1': 0.31356625457016785, 'reduction': 'sum', 'lr': 0.00030735807502983687, 'weight_decay': 0.2898483420649945, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 9 with value: 7.906765759248038.[0m

Trial Id: 10 | Model params: 122574 | Timestamp: 2022-02-24 17:39:38.383251

[32m[I 2022-02-24 17:40:13,505][0m Trial 10 pruned. [0m
epoch 0 -0.13905357879840463 8.97069539111801

Trial Id: 11 | Model params: 146650 | Timestamp: 2022-02-24 17:40:13.505754

[32m[I 2022-02-24 17:40:53,699][0m Trial 11 pruned. [0m
epoch 0 -0.24170550574215222 9.366198054099021

Trial Id: 12 | Model params: 130596 | Timestamp: 2022-02-24 17:40:53.699680

[32m[I 2022-02-24 17:41:27,244][0m Trial 12 pruned. [0m
epoch 0 -0.3213965406946704 9.662079717563685

Trial Id: 13 | Model params: 114217 | Timestamp: 2022-02-24 17:41:27.244711

[32m[I 2022-02-24 17:42:02,171][0m Trial 13 pruned. [0m
epoch 0 -0.09065230748455955 8.778032709939106

Trial Id: 14 | Model params: 75021 | Timestamp: 2022-02-24 17:42:02.171170

[32m[I 2022-02-24 17:42:25,903][0m Trial 14 pruned. [0m
epoch 0 0.029251937457538957 8.281467460900757

Trial Id: 15 | Model params: 66996 | Timestamp: 2022-02-24 17:42:25.903554

[32m[I 2022-02-24 17:42:48,105][0m Trial 15 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 16 | Model params: 77037 | Timestamp: 2022-02-24 17:42:48.105542

[32m[I 2022-02-24 17:43:17,841][0m Trial 16 pruned. [0m
epoch 0 -0.11682773121841228 8.882743635234752

Trial Id: 17 | Model params: 170190 | Timestamp: 2022-02-24 17:43:17.841911

[32m[I 2022-02-24 17:44:14,858][0m Trial 17 pruned. [0m
epoch 0 -2.432365430177489 15.572229412567294

Trial Id: 18 | Model params: 233214 | Timestamp: 2022-02-24 17:44:14.858499

epoch 0 -6.613696087148835 23.19272626502641
epoch 5 0.016454655318804745 8.33587564420178
epoch 10 0.03618189482864942 8.251854727193889
epoch 15 0.018007356013275633 8.329293216528125
epoch 20 0.02685563424239934 8.291682611521534
epoch 25 0.02101876439454453 8.31651197875812
epoch 30 0.025245600018435232 8.298538930108792
epoch 35 0.01912708411688746 8.324543077132617
epoch 40 0.02277467222532581 8.309050353407075
epoch 45 0.03041828993042106 8.276490879684106
epoch 50 0.021518642054532355 8.314388460342515
epoch 55 0.03317191368616912 8.264729856402903
epoch 60 0.03705930936789992 8.248097822321837
epoch 65 0.02896062829006074 8.282709949309467
epoch 70 0.030547701131397598 8.27593852481028
epoch 75 0.033400785987025006 8.263751564748201
epoch 80 0.022402815006024812 8.31063109757837
epoch 85 0.028630919954159895 8.28411599257675
epoch 90 0.03748977805644882 8.246254019904352
epoch 95 0.028309998552204618 8.285484334757848
[32m[I 2022-02-24 19:02:02,407][0m Trial 18 finished with value: 8.2386277481762 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 216, 'fe_dropout_l0': 0.34309237585306085, 'fe_n_units_l1': 160, 'fe_dropout_l1': 0.35314191783910054, 'fe_n_units_l2': 72, 'fe_dropout_l2': 0.13362313732803688, 'fe_n_units_l3': 250, 'fe_dropout_l3': 0.49665243061825143, 'n_units_l(Invariant)': 314, 'n_layers_mlp': 4, 'mlp_n_units_l0': 250, 'mlp_dropout_l0': 0.11554339661109353, 'mlp_n_units_l1': 204, 'mlp_dropout_l1': 0.2597652801714543, 'mlp_n_units_l2': 144, 'mlp_dropout_l2': 0.19978574592954, 'mlp_n_units_l3': 12, 'mlp_dropout_l3': 0.34918158390095466, 'reduction': 'sum', 'lr': 0.00015679582705366171, 'weight_decay': 0.2067151757105998, 'criterion': 'MSELoss', 'batch_size': 128}. Best is trial 9 with value: 7.906765759248038.[0m

Trial Id: 19 | Model params: 83384 | Timestamp: 2022-02-24 19:02:02.407608

[32m[I 2022-02-24 19:02:29,478][0m Trial 19 pruned. [0m
epoch 0 0.010312803316711805 8.361862262919928

Study statistics: 
  Number of finished trials:  20
  Number of pruned trials:  14
  Number of complete trials:  6

Best trial:
  Value:  7.906765759248038
  Params: 
    n_layers_fe: 2
    fe_n_units_l0: 52
    fe_dropout_l0: 0.3500051149927193
    fe_n_units_l1: 236
    fe_dropout_l1: 0.10503381935281186
    n_units_l(Invariant): 397
    n_layers_mlp: 2
    mlp_n_units_l0: 102
    mlp_dropout_l0: 0.4310928675225717
    mlp_n_units_l1: 52
    mlp_dropout_l1: 0.31356625457016785
    reduction: sum
    lr: 0.00030735807502983687
    weight_decay: 0.2898483420649945
    criterion: MSELoss
    batch_size: 32
Target: 132567, NaN: 0, Max: 159.0, Min: 0.0, Mean: 21.53262878393567
Prediction: 132567, NaN: 0, Max: 45.86587905883789, Min: 8.446237564086914, Mean: 21.470911479986697

 XXXXXX======== TRIAL south - glbg ended

Test Set - R-squared:  0.1205157769410724
Test Set - RMSE:  7.861219950112306
Test Set - MAE:  6.0341651303396215



