[32m[I 2022-02-26 18:33:33,300][0m A new study created in memory with name: DeepSet[0m
Starting Loading south
Finished Loading south
Finished south setup

++++++++ Session Characteristics +++++++

Area: south
Gal Type: glbg
Training Set: 216650
Validation Set: 54162
Test Samples: 132567
Number of features: 5
Device: cuda:0
Number of Workers: 8
Number of Trials: 25

+++++++++++++++++++++++++++++++++++++++

Trial Id: 0 | Model params: 71600 | Timestamp: 2022-02-26 18:33:33.301204

[32m[I 2022-02-26 18:34:44,576][0m Trial 0 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 1 | Model params: 146484 | Timestamp: 2022-02-26 18:34:44.576546

epoch 0 0.033996421203485006 8.261205038795246
epoch 5 0.025755607019768423 8.296367682303446
epoch 10 0.02990375236110765 8.278686672272544
epoch 15 0.03582228061651571 8.253394025672227
epoch 20 0.03145129561769622 8.272080761121437
epoch 25 0.0335349532292154 8.263178026503047
epoch 30 0.02867887214724707 8.283911514978879
epoch 35 0.020745222440956446 8.317673776329865
epoch 40 0.030819359517499367 8.274778908382247
epoch 45 0.03392910854396958 8.261492860707769
epoch 50 0.031163782681995045 8.27330845041473
epoch 55 0.03574150539454868 8.253739737753522
epoch 60 0.03466981369202948 8.258325130601895
epoch 65 0.012459604967683946 8.352788181136289
epoch 70 0.03174380178144309 8.270831563579032
epoch 75 0.03603552866528115 8.252481269930545
epoch 80 0.030425143347705963 8.276461628747699
epoch 85 0.028436007719318646 8.284947084797
epoch 90 0.020712308677766078 8.31781355795304
epoch 95 0.029509335385767166 8.280369455161187
[32m[I 2022-02-26 20:20:07,971][0m Trial 1 finished with value: 8.320917983041726 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 166, 'fe_dropout_l0': 0.035679367310365806, 'fe_n_units_l1': 133, 'fe_dropout_l1': 0.49774805128619404, 'fe_n_units_l2': 216, 'fe_dropout_l2': 0.2630705007581295, 'fe_n_units_l3': 203, 'fe_dropout_l3': 0.4746405827778438, 'n_units_l(Invariant)': 181, 'n_layers_mlp': 2, 'mlp_n_units_l0': 115, 'mlp_dropout_l0': 0.498795280865632, 'mlp_n_units_l1': 90, 'mlp_dropout_l1': 0.2871715605673686, 'reduction': 'sum', 'lr': 0.0038053252146862753, 'weight_decay': 0.27383737586664075, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 1 with value: 8.320917983041726.[0m

Trial Id: 2 | Model params: 168933 | Timestamp: 2022-02-26 20:20:07.971928

[32m[I 2022-02-26 20:20:45,545][0m Trial 2 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 3 | Model params: 155548 | Timestamp: 2022-02-26 20:20:45.545968

epoch 0 -5.883902144084852 22.05318789125515
epoch 5 -5.59907328796698 21.592131145660364
epoch 10 -5.521314663162973 21.46454128137554
epoch 15 -5.458281596298625 21.360554493681036
epoch 20 -5.365722521661076 21.206934039942407
epoch 25 -5.16295191276382 20.866442990290636
epoch 30 -5.139417757789285 20.826564063981028
epoch 35 -5.108161713276097 20.77348194233106
epoch 40 -5.129864337492577 20.81035386382317
epoch 45 -5.145230213000867 20.836420441043902
epoch 50 -5.130506299122921 20.81144353711803
epoch 55 -5.062449894495016 20.695604424441267
epoch 60 -5.005770599384965 20.598633160679
epoch 65 -4.9736075480175685 20.543402589542765
epoch 70 -4.956769631384062 20.51442912619573
epoch 75 -4.951769631163729 20.505817606041298
epoch 80 -4.940010447567219 20.48555044933818
epoch 85 -4.930844224445237 20.469738387703394
epoch 90 -4.923339739574379 20.45678378457915
epoch 95 -4.9207379565930776 20.45229054595862
[32m[I 2022-02-26 21:38:27,639][0m Trial 3 finished with value: 20.449444120479853 and parameters: {'n_layers_fe': 4, 'fe_n_units_l0': 222, 'fe_dropout_l0': 0.17970109967057785, 'fe_n_units_l1': 218, 'fe_dropout_l1': 0.14866611865672513, 'fe_n_units_l2': 227, 'fe_dropout_l2': 0.36965908120237634, 'fe_n_units_l3': 61, 'fe_dropout_l3': 0.3556919818208406, 'n_units_l(Invariant)': 430, 'n_layers_mlp': 4, 'mlp_n_units_l0': 253, 'mlp_dropout_l0': 0.4693801043592851, 'mlp_n_units_l1': 30, 'mlp_dropout_l1': 0.18394226730212943, 'mlp_n_units_l2': 26, 'mlp_dropout_l2': 0.3243440848324036, 'mlp_n_units_l3': 23, 'mlp_dropout_l3': 0.38829155721855035, 'reduction': 'sum', 'lr': 3.078108574160827e-05, 'weight_decay': 0.08721161070588788, 'criterion': 'PoissonNLLLoss', 'batch_size': 256}. Best is trial 1 with value: 8.320917983041726.[0m

Trial Id: 4 | Model params: 111985 | Timestamp: 2022-02-26 21:38:27.639448

[32m[I 2022-02-26 21:39:05,749][0m Trial 4 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 5 | Model params: 90755 | Timestamp: 2022-02-26 21:39:05.749973

[32m[I 2022-02-26 21:39:39,320][0m Trial 5 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 6 | Model params: 170322 | Timestamp: 2022-02-26 21:39:39.320466

[32m[I 2022-02-26 21:40:13,785][0m Trial 6 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 7 | Model params: 43458 | Timestamp: 2022-02-26 21:40:13.785725

[32m[I 2022-02-26 21:40:33,075][0m Trial 7 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 8 | Model params: 83006 | Timestamp: 2022-02-26 21:40:33.075960

[32m[I 2022-02-26 21:40:52,047][0m Trial 8 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 9 | Model params: 171898 | Timestamp: 2022-02-26 21:40:52.047202

[32m[I 2022-02-26 21:41:37,724][0m Trial 9 pruned. [0m
++++++++++++++++++++
        NaN         
++++++++++++++++++++

Trial Id: 10 | Model params: 48258 | Timestamp: 2022-02-26 21:41:37.725080

epoch 0 -0.42684622106628267 10.04020587792019
epoch 5 0.03154898581722443 8.271663579417405
epoch 10 0.022709501121097264 8.309327413847086
epoch 15 0.030487157194256098 8.276196943960807
epoch 20 0.026802742501041643 8.291907940665183
epoch 25 0.031654227036939764 8.271214127869273
epoch 30 0.03249006938284604 8.267643645240222
epoch 35 0.03148677982092574 8.271929229824126
epoch 40 0.02939354541419803 8.280863408983803
epoch 45 0.030652305985418127 8.275492021822924
epoch 50 0.031749628411020914 8.270806678045426
epoch 55 0.03175887618192663 8.27076718066425
epoch 60 0.034522744659950866 8.25895418874441
epoch 65 0.027648062718764077 8.288305978109115
epoch 70 0.025921734286792453 8.29566030761449
epoch 75 0.026589705283804332 8.29281545880571
epoch 80 0.025363377856566838 8.29803756612391
epoch 85 0.03503795273947674 8.256750279892843
epoch 90 0.029215153592425214 8.281624361289285
epoch 95 0.022917661564089142 8.30844243369469
[32m[I 2022-02-26 23:12:00,444][0m Trial 10 finished with value: 8.298595358600402 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 162, 'fe_dropout_l0': 0.3022709018286499, 'fe_n_units_l1': 256, 'fe_dropout_l1': 0.4955571566264563, 'n_units_l(Invariant)': 5, 'n_layers_mlp': 2, 'mlp_n_units_l0': 47, 'mlp_dropout_l0': 0.3552008983804501, 'mlp_n_units_l1': 65, 'mlp_dropout_l1': 0.0010653150267574407, 'reduction': 'sum', 'lr': 0.008139838134968836, 'weight_decay': 0.18892352005975394, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 10 with value: 8.298595358600402.[0m

Trial Id: 11 | Model params: 47041 | Timestamp: 2022-02-26 23:12:00.444573

epoch 0 0.026010705030008907 8.29528144282336
epoch 5 0.03540108090098526 8.255196570769257
epoch 10 0.03244728130694985 8.267826461272104
epoch 15 0.03460523621732492 8.25860135363472
epoch 20 0.0326760464342728 8.266848994024908
epoch 25 0.027014676029136653 8.291005025570035
epoch 30 0.0308315346177086 8.27472693325263
epoch 35 0.02905038275998917 8.282327149475535
epoch 40 0.02532145685517473 8.29821602150717
epoch 45 0.03107171815005716 8.273701530360812
epoch 50 0.03201820933996502 8.269659487673335
epoch 55 0.024902946394030345 8.299997387024145
epoch 60 0.03328967181967857 8.264226525556303
epoch 65 0.03352216718228862 8.263232686023805
epoch 70 0.026977772250338483 8.291162256366205
epoch 75 0.013052711404937578 8.350279505778975
epoch 80 -0.002659254022805868 8.416484284134013
epoch 85 0.020683882552464894 8.317934279114308
epoch 90 0.03258456633200557 8.267239883917437
epoch 95 0.029947356047853146 8.27850061582834
[32m[I 2022-02-27 00:41:33,034][0m Trial 11 finished with value: 8.25255345760049 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 163, 'fe_dropout_l0': 0.2599312607844433, 'fe_n_units_l1': 243, 'fe_dropout_l1': 0.4733861766890805, 'n_units_l(Invariant)': 11, 'n_layers_mlp': 2, 'mlp_n_units_l0': 38, 'mlp_dropout_l0': 0.3554375978289901, 'mlp_n_units_l1': 66, 'mlp_dropout_l1': 0.035620940906514006, 'reduction': 'sum', 'lr': 0.008048775988941888, 'weight_decay': 0.1863155294512483, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 11 with value: 8.25255345760049.[0m

Trial Id: 12 | Model params: 42042 | Timestamp: 2022-02-27 00:41:33.035128

epoch 0 -0.3691541044309612 9.835132154724835
epoch 5 -0.3567917670707037 9.790629888308217
epoch 10 -0.32214613220086363 9.664819843568047
epoch 15 -0.3790769757878254 9.870707611185313
epoch 20 -0.39994945768129964 9.945124216073458
epoch 25 -0.29660660858267507 9.57101835204728
epoch 30 -0.5324779345901607 10.405217162285236
epoch 35 -0.200606334776257 9.20988799962036
epoch 40 -0.1405529953974447 8.976597828972261
epoch 45 -0.11428979491305347 8.872645094991263
epoch 50 -0.13075940619336057 8.937975052347507
epoch 55 -0.12498122347336782 8.915109269112603
epoch 60 -0.11270404903333486 8.866329516359908
epoch 65 -0.0161994319637353 8.473122933591943
epoch 70 -0.09789209088207196 8.80711894584003
epoch 75 -0.07345454071691337 8.70855025262035
epoch 80 -0.09464358485497182 8.794079789353935
epoch 85 0.0008707119687340059 8.401655667879922
epoch 90 0.02883863008281784 8.283230239247313
epoch 95 0.03743187298827899 8.246502065436154
[32m[I 2022-02-27 02:11:52,668][0m Trial 12 finished with value: 8.255278077198355 and parameters: {'n_layers_fe': 2, 'fe_n_units_l0': 161, 'fe_dropout_l0': 0.3092590635197888, 'fe_n_units_l1': 245, 'fe_dropout_l1': 0.42664999355394695, 'n_units_l(Invariant)': 2, 'n_layers_mlp': 2, 'mlp_n_units_l0': 16, 'mlp_dropout_l0': 0.3411913583842802, 'mlp_n_units_l1': 29, 'mlp_dropout_l1': 0.012541960747310179, 'reduction': 'sum', 'lr': 0.0017597441234546143, 'weight_decay': 0.18989427988332874, 'criterion': 'MSELoss', 'batch_size': 32}. Best is trial 11 with value: 8.25255345760049.[0m

Trial Id: 13 | Model params: 35754 | Timestamp: 2022-02-27 02:11:52.668951

[32m[I 2022-02-27 02:12:47,239][0m Trial 13 pruned. [0m
epoch 0 -0.16561723538763418 9.074694508638848

Trial Id: 14 | Model params: 42639 | Timestamp: 2022-02-27 02:12:47.239613

[32m[I 2022-02-27 02:13:41,282][0m Trial 14 pruned. [0m
epoch 0 0.03337434333559053 8.263864597122206

Trial Id: 15 | Model params: 43533 | Timestamp: 2022-02-27 02:13:41.282872

[32m[I 2022-02-27 02:14:35,825][0m Trial 15 pruned. [0m
epoch 0 0.030687294515684194 8.275342668852002

Trial Id: 16 | Model params: 59686 | Timestamp: 2022-02-27 02:14:35.825212

[32m[I 2022-02-27 02:15:29,711][0m Trial 16 pruned. [0m
epoch 0 0.058380239532960676 8.156274160890938

Trial Id: 17 | Model params: 48962 | Timestamp: 2022-02-27 02:15:29.711614

[32m[I 2022-02-27 02:16:24,168][0m Trial 17 pruned. [0m
epoch 0 0.08559783576633495 8.037530912097518

Trial Id: 18 | Model params: 126209 | Timestamp: 2022-02-27 02:16:24.169096

[32m[I 2022-02-27 02:17:19,621][0m Trial 18 pruned. [0m
epoch 0 0.07495123768063672 8.084186923762358

Trial Id: 19 | Model params: 61012 | Timestamp: 2022-02-27 02:17:19.622091

[32m[I 2022-02-27 02:18:13,804][0m Trial 19 pruned. [0m
epoch 0 0.09773400187162462 7.98401472444805

Trial Id: 20 | Model params: 65114 | Timestamp: 2022-02-27 02:18:13.804898

[32m[I 2022-02-27 02:19:08,418][0m Trial 20 pruned. [0m
epoch 0 -0.024144845744128673 8.50618307075497

Trial Id: 21 | Model params: 44806 | Timestamp: 2022-02-27 02:19:08.418410

[32m[I 2022-02-27 02:20:02,502][0m Trial 21 pruned. [0m
epoch 0 0.009511110918634436 8.365248324908551

Trial Id: 22 | Model params: 64839 | Timestamp: 2022-02-27 02:20:02.502929

[32m[I 2022-02-27 02:20:56,575][0m Trial 22 pruned. [0m
epoch 0 -0.32604470643356276 9.67905854298474

Trial Id: 23 | Model params: 33290 | Timestamp: 2022-02-27 02:20:56.575514

[32m[I 2022-02-27 02:21:50,858][0m Trial 23 pruned. [0m
epoch 0 0.03431579599497758 8.25983928880956

Trial Id: 24 | Model params: 43260 | Timestamp: 2022-02-27 02:21:50.858199

[32m[I 2022-02-27 02:22:45,451][0m Trial 24 pruned. [0m
epoch 0 0.02499099436307406 8.29962264770554

Study statistics: 
  Number of finished trials:  25
  Number of pruned trials:  20
  Number of complete trials:  5

Best trial:
  Value:  8.25255345760049
  Params: 
    n_layers_fe: 2
    fe_n_units_l0: 163
    fe_dropout_l0: 0.2599312607844433
    fe_n_units_l1: 243
    fe_dropout_l1: 0.4733861766890805
    n_units_l(Invariant): 11
    n_layers_mlp: 2
    mlp_n_units_l0: 38
    mlp_dropout_l0: 0.3554375978289901
    mlp_n_units_l1: 66
    mlp_dropout_l1: 0.035620940906514006
    reduction: sum
    lr: 0.008048775988941888
    weight_decay: 0.1863155294512483
    criterion: MSELoss
    batch_size: 32
Target: 132567, NaN: 0, Max: 159.0, Min: 0.0, Mean: 21.53262878393567
Prediction: 132567, NaN: 0, Max: 29.85724449157715, Min: 20.640125274658203, Mean: 21.442732893409072

 XXXXXX======== TRIAL south - glbg ended

Test Set - R-squared:  0.04029462129601269
Test Set - RMSE:  8.211923321016775
Test Set - MAE:  6.31881036115072



